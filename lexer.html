

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lexer DDSL &mdash; Fan 0.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Fan 0.2 documentation" href="index.html"/>
        <link rel="next" title="Toplevel support" href="toplevel.html"/>
        <link rel="prev" title="DDSLs" href="ddsl.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Fan
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="start.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="start.html#installation">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="start.html#what-it-installed">What it installed?</a></li>
<li class="toctree-l3"><a class="reference internal" href="start.html#what-language-does-fan-speak">What language does Fan speak?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Overview of Fan&#8217;s architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="compilation.html">Command Line compilation Using Fan</a></li>
<li class="toctree-l1"><a class="reference internal" href="ddsl.html">DDSLs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Lexer DDSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="toplevel.html">Toplevel support</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Fan&#8217;s plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="parser.html">Parser DDSL</a></li>
<li class="toctree-l1"><a class="reference internal" href="quotation_system.html">Fan&#8217;s quosi-quotation</a></li>
<li class="toctree-l1"><a class="reference internal" href="browser.html">Fan in browser</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Fan&#8217;s history</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Fan</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Lexer DDSL</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/lexer.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="lexer-ddsl">
<h1>Lexer DDSL<a class="headerlink" href="#lexer-ddsl" title="Permalink to this headline">Â¶</a></h1>
<p><code class="docutils literal"><span class="pre">lexer</span> <span class="pre">DDSL</span></code> is just another backend for ocamllex, the nice
<a class="reference external" href="http://pllab.kaist.ac.kr/~shoh/ocaml/ocamllex-ocamlyacc/ocamllex-tutorial/index.html">ocamllex tutorial</a>
would also help understand lexer DDSL.</p>
<ul>
<li><p class="first">Syntax</p>
<p>lexer DDSL&#8217;s syntax is similar to ocamllex.</p>
<div class="highlight-ocaml"><div class="highlight"><pre> <span class="o">#</span><span class="n">regexp</span><span class="o">{</span>
 <span class="k">let</span> <span class="n">name1</span> <span class="o">=</span> <span class="n">r1</span> <span class="k">let</span> <span class="n">name2</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">...</span>
 <span class="k">let</span> <span class="n">name</span> <span class="n">n</span> <span class="o">=</span> <span class="n">rn</span>
 <span class="o">};;</span>

 <span class="o">%</span><span class="n">lexer</span><span class="o">{</span>
 <span class="o">|</span> <span class="n">r1</span> <span class="o">-&gt;</span> <span class="n">e1</span>
 <span class="o">|</span> <span class="n">r2</span> <span class="o">-&gt;</span> <span class="n">e2</span>
 <span class="o">|</span> <span class="n">r3</span> <span class="o">-&gt;</span> <span class="n">e3</span>
 <span class="o">}</span> <span class="c">(* shortest = false *)</span>


<span class="o">%</span><span class="n">lexer</span><span class="o">{</span>
 <span class="o">&lt;</span> <span class="n">r1</span> <span class="o">-&gt;</span> <span class="n">e1</span>
 <span class="o">|</span> <span class="n">r2</span> <span class="o">-&gt;</span><span class="n">e2</span>
 <span class="o">|</span> <span class="n">r3</span> <span class="o">-&gt;</span> <span class="n">e3</span>
 <span class="o">|}</span> <span class="c">(* shortest = true *)</span>
</pre></div>
</div>
</li>
</ul>
<p>Here r<sub>n</sub> stands for regex expression, e:sub`n` means Fan&#8217;s
expression, different lexer DDSLs are guaranteed to be independent.</p>
<p>Similar to ocamllex, /lexbuf/ is available and captured in <code class="docutils literal"><span class="pre">actions</span></code></p>
<p>Keep in mind, <code class="docutils literal"><span class="pre">lexer</span> <span class="pre">DDSL</span></code> is simply an expression, it works with any
feature provided by OCaml. That said, in the action, you can start
another lexer as you want or you may put the lexer DDSL as a body of a
method definition.</p>
<p>The syntax for regex is the same as ocamllex, it supports all features
provided by ocamllex except two aspects:</p>
<blockquote>
<div><ol class="arabic simple">
<li><code class="docutils literal"><span class="pre">!</span></code> stands end of file instead of <code class="docutils literal"><span class="pre">eof</span></code> in ocamllex</li>
<li>lexer DDSL&#8217;s lexing convention is more restrict.</li>
</ol>
</div></blockquote>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>There is a minor bug currently for example:</p>
<div class="last highlight-ocaml"><div class="highlight"><pre><span class="o">#</span><span class="n">regexp</span><span class="o">{</span>
<span class="k">let</span> <span class="n">ident</span> <span class="o">=</span> <span class="o">[</span><span class="n">a</span><span class="o">-</span><span class="n">z</span><span class="o">]+</span>
<span class="k">let</span> <span class="n">v</span> <span class="o">=</span> <span class="n">ident</span><span class="o">*|</span><span class="sc">&#39;A&#39;</span>
<span class="o">};;</span>
<span class="c">(* ERROR *| will be parsed as single token *)</span>


<span class="o">#</span><span class="n">regexp</span><span class="o">{</span>
<span class="k">let</span> <span class="n">ident</span> <span class="o">=</span> <span class="o">[</span><span class="n">a</span><span class="o">-</span><span class="n">z</span><span class="o">]+</span>
<span class="k">let</span> <span class="n">v</span> <span class="o">=</span> <span class="n">ident</span><span class="o">*</span> <span class="o">|</span><span class="sc">&#39;A&#39;</span>
<span class="o">};;</span>
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="toplevel.html" class="btn btn-neutral float-right" title="Toplevel support" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="ddsl.html" class="btn btn-neutral" title="DDSLs" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Hongbo Zhang.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>