<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="CtypN.html">
<link rel="next" href="DynLoader.html">
<link rel="Up" href="index.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class attributes" rel=Appendix href="index_attributes.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Index of module types" rel=Appendix href="index_module_types.html">
<link title="Ant" rel="Chapter" href="Ant.html">
<link title="AntN" rel="Chapter" href="AntN.html">
<link title="Ast2pt" rel="Chapter" href="Ast2pt.html">
<link title="AstFilters" rel="Chapter" href="AstFilters.html">
<link title="AstLibN" rel="Chapter" href="AstLibN.html">
<link title="AstMacros" rel="Chapter" href="AstMacros.html">
<link title="AstParsers" rel="Chapter" href="AstParsers.html">
<link title="AstPrint" rel="Chapter" href="AstPrint.html">
<link title="AstQuotation" rel="Chapter" href="AstQuotation.html">
<link title="BasicN" rel="Chapter" href="BasicN.html">
<link title="CodeTemplate" rel="Chapter" href="CodeTemplate.html">
<link title="CommentFilter" rel="Chapter" href="CommentFilter.html">
<link title="CtypN" rel="Chapter" href="CtypN.html">
<link title="DeriveN" rel="Chapter" href="DeriveN.html">
<link title="DynLoader" rel="Chapter" href="DynLoader.html">
<link title="EpN" rel="Chapter" href="EpN.html">
<link title="Exp" rel="Chapter" href="Exp.html">
<link title="ExpN" rel="Chapter" href="ExpN.html">
<link title="FanUtil" rel="Chapter" href="FanUtil.html">
<link title="FArg" rel="Chapter" href="FArg.html">
<link title="FAst" rel="Chapter" href="FAst.html">
<link title="FCMacroGen" rel="Chapter" href="FCMacroGen.html">
<link title="FConfig" rel="Chapter" href="FConfig.html">
<link title="FGramGen" rel="Chapter" href="FGramGen.html">
<link title="Fgram" rel="Chapter" href="Fgram.html">
<link title="Filters" rel="Chapter" href="Filters.html">
<link title="FLexer" rel="Chapter" href="FLexer.html">
<link title="FLexGen" rel="Chapter" href="FLexGen.html">
<link title="FLexLib" rel="Chapter" href="FLexLib.html">
<link title="FLoc" rel="Chapter" href="FLoc.html">
<link title="FSigUtil" rel="Chapter" href="FSigUtil.html">
<link title="FState" rel="Chapter" href="FState.html">
<link title="FStreamGen" rel="Chapter" href="FStreamGen.html">
<link title="Fsyntax" rel="Chapter" href="Fsyntax.html">
<link title="FToken" rel="Chapter" href="FToken.html">
<link title="Gcomb" rel="Chapter" href="Gcomb.html">
<link title="Gdelete" rel="Chapter" href="Gdelete.html">
<link title="Gentry" rel="Chapter" href="Gentry.html">
<link title="Gfailed" rel="Chapter" href="Gfailed.html">
<link title="Ginsert" rel="Chapter" href="Ginsert.html">
<link title="Gparser" rel="Chapter" href="Gparser.html">
<link title="Gprint" rel="Chapter" href="Gprint.html">
<link title="Gramlib" rel="Chapter" href="Gramlib.html">
<link title="Gstru" rel="Chapter" href="Gstru.html">
<link title="Gtools" rel="Chapter" href="Gtools.html">
<link title="IdN" rel="Chapter" href="IdN.html">
<link title="LangFans" rel="Chapter" href="LangFans.html">
<link title="LangInclude" rel="Chapter" href="LangInclude.html">
<link title="LangOcaml" rel="Chapter" href="LangOcaml.html">
<link title="LangSave" rel="Chapter" href="LangSave.html">
<link title="LexBackend" rel="Chapter" href="LexBackend.html">
<link title="LibUtil" rel="Chapter" href="LibUtil.html">
<link title="ParsetreeHelper" rel="Chapter" href="ParsetreeHelper.html">
<link title="PGrammar" rel="Chapter" href="PGrammar.html">
<link title="PreCast" rel="Chapter" href="PreCast.html">
<link title="PStream" rel="Chapter" href="PStream.html">
<link title="StdFan" rel="Chapter" href="StdFan.html">
<link title="TokenEval" rel="Chapter" href="TokenEval.html">
<link title="Typehook" rel="Chapter" href="Typehook.html">
<link title="XStream" rel="Chapter" href="XStream.html"><title>DeriveN</title>
</head>
<body>
<div class="navbar"><a class="pre" href="CtypN.html" title="CtypN">Previous</a>
&nbsp;<a class="up" href="index.html" title="Index">Up</a>
&nbsp;<a class="post" href="DynLoader.html" title="DynLoader">Next</a>
</div>
<h1>Module <a href="type_DeriveN.html">DeriveN</a></h1>
<pre><span class="keyword">module</span> DeriveN: <code class="code">sig</code> <a href="DeriveN.html">..</a> <code class="code">end</code></pre><div class="info">
Fan's deriving<br>
</div>
<hr width="100%">
<br>
Some common arguments
   <code class="code">mk_tuple: ty_info list -&gt; exp</code>
   <code class="code">mk_variant: string -&gt; ty_info list -&gt; exp</code>
   <code class="code">mk_record: record_col list -&gt; exp </code>
<p>

   <code class="code">names:string list</code>
     A prefix argument list, for example if you want to write
     Format library, you may need to pass <code class="code">"fmt"</code>
   <code class="code">arity:int</code>
<p>

   <code class="code">f:ctyp-&gt;exp</code>
<p>

   <code class="code">left_type_id:basic_id_transform</code>
     for objects, the default case for <code class="code">left_type_id</code>
     is id, for example, which could be
     <code class="code">`Pre "eq_"; `Pre "strip_loc";
      `Pre "fill_"; `Pre "meta_"; `Pre "pp_print_"</code>
<p>

     which means the the type is self type which
     appears in the context
<p>

   <code class="code">right_type_id:full_id_transform</code>
     For the <code class="code">right_type_id</code>, we have to consider the qualified
     types, the default case is
      <pre class="codepre"><code class="code">        let right_type_id =
         match module_name with
         |None -&gt;   (id:&gt;full_id_transform)
         |Some m -&gt;
           `Last (fun s -&gt; {:ident'| $uid:m.$(lid:basic_transform id s) |} )
      </code></pre>
<p>

   <code class="code">left_type_variable:basic_id_transform</code>
     The default is <code class="code">`Pre "mf_"</code>
   <code class="code">right_type_variable:rhs_basic_id_transform</code>
     The default is <code class="code">`Pre "mf_"</code>
<p>

   <code class="code">destination</code>
     It's used only in <code class="code">exp_of_variant</code>
     by a ad-hoc function
     Case.gen_tuple_abbrev<br>
<pre><span id="VALcheck"><span class="keyword">val</span> check</span> : <code class="type">string list -> unit</code></pre><pre><span id="VALmapi_exp"><span class="keyword">val</span> mapi_exp</span> : <code class="type">?arity:int -><br>       ?names:string list -><br>       f:(FAstN.ctyp -> FAstN.exp) -> int -> FAstN.ctyp -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a></code></pre><div class="info">
collect the <code class="code">partial evaluated FAst node</code> and meta data
   The input <code class="code">y</code> is handled by <code class="code">simple_exp_of_ctyp</code>, generally it will
   be  exlcuding adt or variant type
<p>

    <pre class="codepre"><code class="code">    Frame.mapi_exp ~arity:2 ~names:["fmt";"test"]
    ~f:(fun {:ctyp|$lid:x|} -&gt; {:exp|$(lid:("meta_"^x))|})   3  {:ctyp|int |};;
    </code></pre>
<p>

    <br>
</div>
<pre><span id="VALtuple_exp_of_ctyp"><span class="keyword">val</span> tuple_exp_of_ctyp</span> : <code class="type">?arity:int -><br>       ?names:string list -><br>       mk_tuple:(<a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       f:(FAstN.ctyp -> FAstN.exp) -> FAstN.ctyp -> FAstN.exp</code></pre><div class="info">
<b>Raises</b> <code>Invalid_argument</code> when type can not be handled
    <code class="code">mk_tuple</code>
    spits out an expression node when the input is a tuple type<br>
</div>
<pre><span id="VALnormal_simple_exp_of_ctyp"><span class="keyword">val</span> normal_simple_exp_of_ctyp</span> : <code class="type">?arity:int -><br>       ?names:string list -><br>       mk_tuple:(<a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       right_type_id:<a href="CtypN.html#TYPEfull_id_transform">CtypN.full_id_transform</a> -><br>       left_type_id:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       right_type_variable:<a href="CtypN.html#TYPErhs_basic_id_transform">CtypN.rhs_basic_id_transform</a> -><br>       (string, 'a) Hashtbl.t -> FAstN.ctyp -> FAstN.exp</code></pre><div class="info">
</div>
<pre><span id="VALobj_simple_exp_of_ctyp"><span class="keyword">val</span> obj_simple_exp_of_ctyp</span> : <code class="type">right_type_id:<a href="CtypN.html#TYPEfull_id_transform">CtypN.full_id_transform</a> -><br>       left_type_variable:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       right_type_variable:<a href="CtypN.html#TYPErhs_basic_id_transform">CtypN.rhs_basic_id_transform</a> -><br>       ?names:string list -><br>       ?arity:int -><br>       mk_tuple:(<a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -> FAstN.ctyp -> FAstN.exp</code></pre><div class="info">
list int ==&gt;  self#list (fun self -&gt; self#int)
  'a list  ==&gt;  self#list mf_a 
  'a  ==&gt; (mf_a self)
  list ('a list) ==&gt;  self#list (fun self -&gt; (self#list mf_a))
  m_list (tree 'a) ==&gt;  self#m_list (fun self -&gt; self#tree mf_a)<br>
</div>
<pre><span id="VALexp_of_ctyp"><span class="keyword">val</span> exp_of_ctyp</span> : <code class="type">?cons_transform:(string -> string) -><br>       ?arity:int -><br>       ?names:string list -><br>       default:(<a href="CtypN.html#TYPEvrn">CtypN.vrn</a> * int -> FAstN.case option) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       (FAstN.ctyp -> FAstN.exp) -> FAstN.or_ctyp -> FAstN.exp</code></pre><div class="info">
accept <code class="code">simple_exp_of_ctyp</code>
  call <code class="code">reduce_data_ctors</code>  for <code class="code">sum types</code>
  assume input is  <code class="code">sum type</code>
  accept input type to generate  a function expession<br>
</div>
<pre><span id="VALexp_of_variant"><span class="keyword">val</span> exp_of_variant</span> : <code class="type">?cons_transform:(string -> string) -><br>       ?arity:int -><br>       ?names:string list -><br>       default:(<a href="CtypN.html#TYPEvrn">CtypN.vrn</a> * int -> FAstN.case option) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       destination:<a href="CtypN.html#TYPEdestination">CtypN.destination</a> -><br>       (FAstN.ctyp -> FAstN.exp) -><br>       result:FAstN.ctyp -> FAstN.row_field -> FAstN.exp</code></pre><div class="info">
return a <code class="code">exp</code> node accept <code class="code">variant types</code><br>
</div>
<pre><span id="VALmk_prefix"><span class="keyword">val</span> mk_prefix</span> : <code class="type">FAstN.opt_decl_params -><br>       FAstN.exp -><br>       ?names:string list -><br>       left_type_variable:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -> FAstN.exp</code></pre><pre><span id="VALfun_of_tydcl"><span class="keyword">val</span> fun_of_tydcl</span> : <code class="type">?names:string list -><br>       ?arity:int -><br>       left_type_variable:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       mk_record:(<a href="CtypN.html#TYPErecord_col">CtypN.record_col</a> list -> FAstN.exp) -><br>       result:FAstN.ctyp -><br>       (FAstN.ctyp -> FAstN.exp) -><br>       (FAstN.or_ctyp -> FAstN.exp) -><br>       (result:FAstN.ctyp -> FAstN.row_field -> FAstN.exp) -><br>       FAstN.typedecl -> FAstN.exp</code></pre><pre><span id="VALbind_of_tydcl"><span class="keyword">val</span> bind_of_tydcl</span> : <code class="type">?cons_transform:(string -> string) -><br>       (FAstN.ctyp -> FAstN.exp) -><br>       ?arity:int -><br>       ?names:string list -><br>       ?destination:<a href="CtypN.html#TYPEdestination">CtypN.destination</a> -><br>       ?annot:(string -> FAstN.ctyp * FAstN.ctyp) -><br>       default:(<a href="CtypN.html#TYPEvrn">CtypN.vrn</a> * int -> FAstN.case option) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       left_type_id:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       left_type_variable:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       mk_record:(<a href="CtypN.html#TYPErecord_col">CtypN.record_col</a> list -> FAstN.exp) -><br>       FAstN.typedecl -> FAstN.bind</code></pre><div class="info">
destination is <code class="code">Str_item</code> generate <code class="code">stru</code>, type annotations may not be
    needed here outputs  a binding
    called by <code class="code">stru_of_mtyps</code><br>
</div>
<pre><span id="VALstru_of_mtyps"><span class="keyword">val</span> stru_of_mtyps</span> : <code class="type">?module_name:string -><br>       ?cons_transform:(string -> string) -><br>       ?annot:(string -> FAstN.ctyp * FAstN.ctyp) -><br>       ?arity:int -><br>       ?names:string list -><br>       default:(<a href="CtypN.html#TYPEvrn">CtypN.vrn</a> * int -> FAstN.case option) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       left_type_id:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       left_type_variable:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       mk_record:(<a href="CtypN.html#TYPErecord_col">CtypN.record_col</a> list -> FAstN.exp) -><br>       ((string, unit) Hashtbl.t -> FAstN.ctyp -> FAstN.exp) -><br>       <a href="FSigUtil.html#TYPEmtyps">FSigUtil.mtyps</a> -> FAstN.stru</code></pre><pre><span id="VALobj_of_mtyps"><span class="keyword">val</span> obj_of_mtyps</span> : <code class="type">?cons_transform:(string -> string) -><br>       ?module_name:string -><br>       ?arity:int -><br>       ?names:string list -><br>       default:(<a href="CtypN.html#TYPEvrn">CtypN.vrn</a> * int -> FAstN.case option) -><br>       left_type_variable:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       mk_record:(<a href="CtypN.html#TYPErecord_col">CtypN.record_col</a> list -> FAstN.exp) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       string -><br>       string -><br>       (FAstN.ctyp -> FAstN.exp) -> kind:<a href="CtypN.html#TYPEkind">CtypN.kind</a> -> <a href="FSigUtil.html#TYPEmtyps">FSigUtil.mtyps</a> -> FAstN.stru</code></pre><pre><span id="VALgen_stru"><span class="keyword">val</span> gen_stru</span> : <code class="type">?module_name:string -><br>       ?arity:int -><br>       ?default:FAstN.exp -><br>       ?cons_transform:(string -> string) -><br>       ?annot:(string -> FAstN.ctyp * FAstN.ctyp) -><br>       id:<a href="CtypN.html#TYPEbasic_id_transform">CtypN.basic_id_transform</a> -><br>       ?names:string list -><br>       mk_tuple:(<a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       mk_record:(<a href="CtypN.html#TYPErecord_col">CtypN.record_col</a> list -> FAstN.exp) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       unit -> <a href="FSigUtil.html#TYPEmtyps">FSigUtil.mtyps</a> -> FAstN.stru</code></pre><pre><span id="VALgen_object"><span class="keyword">val</span> gen_object</span> : <code class="type">?module_name:string -><br>       ?arity:int -><br>       ?default:FAstN.exp -><br>       ?cons_transform:(string -> string) -><br>       kind:<a href="CtypN.html#TYPEkind">CtypN.kind</a> -><br>       base:string -><br>       class_name:string -><br>       ?names:string list -><br>       mk_tuple:(<a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       mk_record:(<a href="CtypN.html#TYPErecord_col">CtypN.record_col</a> list -> FAstN.exp) -><br>       mk_variant:(string -> <a href="CtypN.html#TYPEty_info">CtypN.ty_info</a> list -> FAstN.exp) -><br>       unit -> <a href="FSigUtil.html#TYPEmtyps">FSigUtil.mtyps</a> -> FAstN.stru</code></pre></body></html>