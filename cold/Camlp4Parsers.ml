open LibUtil

open FanUtil

open Lib

module IdDebugParser =
                                       struct
                                        let name = "Camlp4DebugParser"

                                        let version = Sys.ocaml_version

                                       end

module MakeDebugParser =
                                             functor (Syntax : Sig.Camlp4Syntax) ->
                                              struct
                                               include Syntax

                                               open FanSig

                                               module Ast = Camlp4Ast

                                               let debug_mode =
                                                (try
                                                  let str =
                                                   (Sys.getenv
                                                     "STATIC_CAMLP4_DEBUG") in
                                                  let rec loop =
                                                   fun acc ->
                                                    fun i ->
                                                     (try
                                                       let pos =
                                                        (String.index_from
                                                          str i ':') in
                                                       (loop (
                                                         (SSet.add (
                                                           (String.sub str i
                                                             ( (pos - i) )) )
                                                           acc) ) ( (pos + 1)
                                                         ))
                                                      with
                                                      Not_found ->
                                                       (SSet.add (
                                                         (String.sub str i (
                                                           ((
                                                             (String.length
                                                               str) ) - i) ))
                                                         ) acc)) in
                                                  let sections =
                                                   (loop SSet.empty 0) in
                                                  if (SSet.mem "*" sections) then
                                                   (
                                                   fun _ -> (true)
                                                   )
                                                  else
                                                   fun x ->
                                                    (SSet.mem x sections)
                                                 with
                                                 Not_found ->
                                                  fun _ -> (false))

                                               let mk_debug_mode =
                                                fun _loc ->
                                                 function
                                                 | None ->
                                                    (Ast.ExId
                                                      (_loc, (
                                                       (Ast.IdAcc
                                                         (_loc, (
                                                          (Ast.IdUid
                                                            (_loc, "Debug"))
                                                          ), (
                                                          (Ast.IdLid
                                                            (_loc, "mode"))
                                                          ))) )))
                                                 | Some (m) ->
                                                    (Ast.ExId
                                                      (_loc, (
                                                       (Ast.IdAcc
                                                         (_loc, (
                                                          (Ast.IdUid
                                                            (_loc, m)) ), (
                                                          (Ast.IdAcc
                                                            (_loc, (
                                                             (Ast.IdUid
                                                               (_loc,
                                                                "Debug")) ),
                                                             (
                                                             (Ast.IdLid
                                                               (_loc, "mode"))
                                                             ))) ))) )))

                                               let mk_debug =
                                                fun _loc ->
                                                 fun m ->
                                                  fun fmt ->
                                                   fun section ->
                                                    fun args ->
                                                     let call =
                                                      (Expr.apply (
                                                        (Ast.ExApp
                                                          (_loc, (
                                                           (Ast.ExApp
                                                             (_loc, (
                                                              (Ast.ExId
                                                                (_loc, (
                                                                 (Ast.IdAcc
                                                                   (_loc, (
                                                                    (
                                                                    Ast.IdUid
                                                                    (_loc,
                                                                    "Debug"))
                                                                    ), (
                                                                    (
                                                                    Ast.IdLid
                                                                    (_loc,
                                                                    "printf"))
                                                                    ))) )))
                                                              ), (
                                                              (Ast.ExStr
                                                                (_loc,
                                                                 section)) )))
                                                           ), (
                                                           (Ast.ExStr
                                                             (_loc, fmt)) )))
                                                        ) args) in
                                                     (Ast.ExIfe
                                                       (_loc, (
                                                        (Ast.ExApp
                                                          (_loc, (
                                                           (mk_debug_mode
                                                             _loc m) ), (
                                                           (Ast.ExStr
                                                             (_loc, section))
                                                           ))) ), call, (
                                                        (Ast.ExId
                                                          (_loc, (
                                                           (Ast.IdUid
                                                             (_loc, "()")) )))
                                                        )))

                                               let _ = let _ =
                                                        (expr : 'expr Gram.t) in
                                                       let grammar_entry_create =
                                                        Gram.mk in
                                                       let end_or_in =
                                                        ((grammar_entry_create
                                                           "end_or_in") :
                                                          'end_or_in Gram.t)
                                                       and start_debug =
                                                        ((grammar_entry_create
                                                           "start_debug") :
                                                          'start_debug Gram.t) in
                                                       (
                                                       (Gram.extend (
                                                         (expr :
                                                           'expr Gram.t) ) (
                                                         ((fun ()
                                                             ->
                                                            (None , (
                                                             [(None , None ,
                                                               (
                                                               [((
                                                                 [(
                                                                  (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (start_debug :
                                                                    'start_debug Gram.t)
                                                                    ))) ); (
                                                                  (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (_)"))
                                                                  ); (
                                                                  (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | STRING
                                                                    (_, _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "STRING (_, _)"))
                                                                  ); (
                                                                  (Gram.Slist0
                                                                    ((
                                                                    Gram.Snterml
                                                                    ((
                                                                    (Gram.obj
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    )) ),
                                                                    "."))))
                                                                  ); (
                                                                  (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (end_or_in :
                                                                    'end_or_in Gram.t)
                                                                    ))) )] ),
                                                                 (
                                                                 (Gram.mk_action
                                                                   (
                                                                   fun (x :
                                                                    'end_or_in) ->
                                                                    fun (args :
                                                                    'expr list) ->
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (m :
                                                                    'start_debug) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (STRING
                                                                    (_, fmt),
                                                                    LIDENT
                                                                    (section)) ->
                                                                    ((match
                                                                    (x, (
                                                                    (debug_mode
                                                                    section)
                                                                    )) with
                                                                    | (None,
                                                                    false) ->
                                                                    (
                                                                    Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "()")) )))
                                                                    | (Some
                                                                    (e),
                                                                    false) ->
                                                                    e
                                                                    | (None,
                                                                    _) ->
                                                                    (mk_debug
                                                                    _loc m
                                                                    fmt
                                                                    section
                                                                    args)
                                                                    | (Some
                                                                    (e), _) ->
                                                                    (
                                                                    Ast.ExLet
                                                                    (_loc,
                                                                    Ast.ReNil
                                                                    , (
                                                                    (Ast.BiEq
                                                                    (_loc, (
                                                                    (Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "()")) )))
                                                                    ), (
                                                                    (mk_debug
                                                                    _loc m
                                                                    fmt
                                                                    section
                                                                    args) )))
                                                                    ), e))) :
                                                                    'expr)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                   )) ))] ))]
                                                             ))) () ) ))
                                                       );
                                                       (
                                                       (Gram.extend (
                                                         (end_or_in :
                                                           'end_or_in Gram.t)
                                                         ) (
                                                         ((fun ()
                                                             ->
                                                            (None , (
                                                             [(None , None ,
                                                               (
                                                               [((
                                                                 [(
                                                                  (Gram.Skeyword
                                                                    ("in"))
                                                                  ); (
                                                                  (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    ))) )] ),
                                                                 (
                                                                 (Gram.mk_action
                                                                   (
                                                                   fun (e :
                                                                    'expr) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Some
                                                                    (e)) :
                                                                    'end_or_in)
                                                                   )) ));
                                                                ((
                                                                 [(
                                                                  (Gram.Skeyword
                                                                    ("end"))
                                                                  )] ), (
                                                                 (Gram.mk_action
                                                                   (
                                                                   fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((None) :
                                                                    'end_or_in)
                                                                   )) ))] ))]
                                                             ))) () ) ))
                                                       );
                                                       (Gram.extend (
                                                         (start_debug :
                                                           'start_debug Gram.t)
                                                         ) (
                                                         ((fun ()
                                                             ->
                                                            (None , (
                                                             [(None , None ,
                                                               (
                                                               [((
                                                                 [(
                                                                  (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    ("camlp4_debug") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (\"camlp4_debug\")"))
                                                                  )] ), (
                                                                 (Gram.mk_action
                                                                   (
                                                                   fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | LIDENT
                                                                    ("camlp4_debug") ->
                                                                    ((Some
                                                                    ("Camlp4")) :
                                                                    'start_debug)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                   )) ));
                                                                ((
                                                                 [(
                                                                  (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    ("debug") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (\"debug\")"))
                                                                  )] ), (
                                                                 (Gram.mk_action
                                                                   (
                                                                   fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | LIDENT
                                                                    ("debug") ->
                                                                    ((None) :
                                                                    'start_debug)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                   )) ))] ))]
                                                             ))) () ) ))

                                              end

module IdGrammarParser =
                                                    struct
                                                     let name =
                                                      "Camlp4GrammarParser"

                                                     let version =
                                                      Sys.ocaml_version

                                                    end

module MakeGrammarParser =
                                                          functor (Syntax : Sig.Camlp4Syntax) ->
                                                           struct
                                                            include Syntax

                                                            module Ast =
                                                             Camlp4Ast

                                                            open FanSig

                                                            open FanGrammar

                                                            open FanGrammarTools

                                                            let _ = (FanConfig.antiquotations
                                                                    := true )

                                                            let _ = let _ =
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    and _ =
                                                                    (level_list :
                                                                    'level_list Gram.t)
                                                                    and _ =
                                                                    (level :
                                                                    'level Gram.t)
                                                                    and _ =
                                                                    (psymbol :
                                                                    'psymbol Gram.t)
                                                                    and _ =
                                                                    (rule_list :
                                                                    'rule_list Gram.t)
                                                                    and _ =
                                                                    (rule :
                                                                    'rule Gram.t)
                                                                    and _ =
                                                                    (symbol :
                                                                    'symbol Gram.t) in
                                                                    let grammar_entry_create =
                                                                    Gram.mk in
                                                                    let extend_header =
                                                                    ((grammar_entry_create
                                                                    "extend_header") :
                                                                    'extend_header Gram.t)
                                                                    and semi_sep =
                                                                    ((grammar_entry_create
                                                                    "semi_sep") :
                                                                    'semi_sep Gram.t)
                                                                    and string =
                                                                    ((grammar_entry_create
                                                                    "string") :
                                                                    'string Gram.t)
                                                                    and name =
                                                                    ((grammar_entry_create
                                                                    "name") :
                                                                    'name Gram.t)
                                                                    and comma_patt =
                                                                    ((grammar_entry_create
                                                                    "comma_patt") :
                                                                    'comma_patt Gram.t)
                                                                    and pattern =
                                                                    ((grammar_entry_create
                                                                    "pattern") :
                                                                    'pattern Gram.t)
                                                                    and assoc =
                                                                    ((grammar_entry_create
                                                                    "assoc") :
                                                                    'assoc Gram.t)
                                                                    and position =
                                                                    ((grammar_entry_create
                                                                    "position") :
                                                                    'position Gram.t)
                                                                    and entry =
                                                                    ((grammar_entry_create
                                                                    "entry") :
                                                                    'entry Gram.t)
                                                                    and global =
                                                                    ((grammar_entry_create
                                                                    "global") :
                                                                    'global Gram.t)
                                                                    and t_qualid =
                                                                    ((grammar_entry_create
                                                                    "t_qualid") :
                                                                    't_qualid Gram.t)
                                                                    and qualid =
                                                                    ((grammar_entry_create
                                                                    "qualid") :
                                                                    'qualid Gram.t)
                                                                    and qualuid =
                                                                    ((grammar_entry_create
                                                                    "qualuid") :
                                                                    'qualuid Gram.t)
                                                                    and delete_rule_header =
                                                                    ((grammar_entry_create
                                                                    "delete_rule_header") :
                                                                    'delete_rule_header Gram.t)
                                                                    and delete_rule_body =
                                                                    ((grammar_entry_create
                                                                    "delete_rule_body") :
                                                                    'delete_rule_body Gram.t)
                                                                    and extend_body =
                                                                    ((grammar_entry_create
                                                                    "extend_body") :
                                                                    'extend_body Gram.t) in
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    ((
                                                                    (Some
                                                                    (`After
                                                                    "top"))
                                                                    ), (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("DELETE_RULE"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (delete_rule_body :
                                                                    'delete_rule_body Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    ("END"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (e :
                                                                    'delete_rule_body) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'expr) ))
                                                                    ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("EXTEND"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (extend_body :
                                                                    'extend_body Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    ("END"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (e :
                                                                    'extend_body) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'expr) ))
                                                                    ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (extend_header :
                                                                    'extend_header Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [([] , (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((None ,
                                                                    (
                                                                    (gm () )
                                                                    )) :
                                                                    'extend_header)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (qualuid :
                                                                    'qualuid Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (t :
                                                                    'qualuid) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (let old =
                                                                    (gm () ) in
                                                                    let 
                                                                    () =
                                                                    (grammar_module_name
                                                                    := t) in
                                                                    (None ,
                                                                    old) :
                                                                    'extend_header)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("(")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (qualid :
                                                                    'qualid Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    (":")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (t_qualid :
                                                                    't_qualid Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    (")")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (t :
                                                                    't_qualid) ->
                                                                    fun _ ->
                                                                    fun (i :
                                                                    'qualid) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (let old =
                                                                    (gm () ) in
                                                                    let 
                                                                    () =
                                                                    (grammar_module_name
                                                                    := t) in
                                                                    ((
                                                                    (Some (i))
                                                                    ), old) :
                                                                    'extend_header)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (extend_body :
                                                                    'extend_body Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (extend_header :
                                                                    'extend_header Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Sopt
                                                                    ((Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (global :
                                                                    'global Gram.t)
                                                                    ))))) );
                                                                    (
                                                                    (Gram.Slist1
                                                                    (Gram.srules
                                                                    extend_body
                                                                    (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (entry :
                                                                    'entry Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'entry) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'e__1) ))
                                                                    ))] )))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (el :
                                                                    'e__1 list) ->
                                                                    fun (global_list :
                                                                    'global option) ->
                                                                    fun (
                                                                    (gram,
                                                                    old) :
                                                                    'extend_header) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (let res =
                                                                    (text_of_functorial_extend
                                                                    _loc gram
                                                                    global_list
                                                                    el) in
                                                                    let 
                                                                    () =
                                                                    (grammar_module_name
                                                                    := old) in
                                                                    res :
                                                                    'extend_body)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (delete_rule_body :
                                                                    'delete_rule_body Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (delete_rule_header :
                                                                    'delete_rule_header Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (name :
                                                                    'name Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    (":")) );
                                                                    (
                                                                    (Gram.Slist0sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ))) ), (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (semi_sep :
                                                                    'semi_sep Gram.t)
                                                                    ))) )))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (sl :
                                                                    'symbol list) ->
                                                                    fun _ ->
                                                                    fun (n :
                                                                    'name) ->
                                                                    fun (old :
                                                                    'delete_rule_header) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (let 
                                                                    (e, b) =
                                                                    (expr_of_delete_rule
                                                                    _loc n
                                                                    sl) in
                                                                    let res =
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdAcc
                                                                    (_loc, (
                                                                    (gm () )
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "delete_rule"))
                                                                    ))) )))
                                                                    ), e)) ),
                                                                    b)) in
                                                                    let 
                                                                    () =
                                                                    (grammar_module_name
                                                                    := old) in
                                                                    res :
                                                                    'delete_rule_body)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (delete_rule_header :
                                                                    'delete_rule_header Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (qualuid :
                                                                    'qualuid Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (g :
                                                                    'qualuid) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (let old =
                                                                    (gm () ) in
                                                                    let 
                                                                    () =
                                                                    (grammar_module_name
                                                                    := g) in
                                                                    old :
                                                                    'delete_rule_header)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (qualuid :
                                                                    'qualuid Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (x) ->
                                                                    ((Ast.IdUid
                                                                    (_loc, x)) :
                                                                    'qualuid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    (".")) );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (xs :
                                                                    'qualuid) ->
                                                                    fun _ ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (x) ->
                                                                    ((Ast.IdAcc
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc, x))
                                                                    ), xs)) :
                                                                    'qualuid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (qualid :
                                                                    'qualid Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (_)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | LIDENT
                                                                    (i) ->
                                                                    ((Ast.IdLid
                                                                    (_loc, i)) :
                                                                    'qualid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (i) ->
                                                                    ((Ast.IdUid
                                                                    (_loc, i)) :
                                                                    'qualid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    (".")) );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (xs :
                                                                    'qualid) ->
                                                                    fun _ ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (x) ->
                                                                    ((Ast.IdAcc
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc, x))
                                                                    ), xs)) :
                                                                    'qualid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (t_qualid :
                                                                    't_qualid Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    (".")) );
                                                                    (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    ("t") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (\"t\")"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun _ ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (LIDENT
                                                                    ("t"),
                                                                    UIDENT
                                                                    (x)) ->
                                                                    ((Ast.IdUid
                                                                    (_loc, x)) :
                                                                    't_qualid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    (".")) );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (xs :
                                                                    't_qualid) ->
                                                                    fun _ ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (x) ->
                                                                    ((Ast.IdAcc
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc, x))
                                                                    ), xs)) :
                                                                    't_qualid)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (global :
                                                                    'global Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("GLOBAL") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"GLOBAL\")"))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    (":")) );
                                                                    (
                                                                    (Gram.Slist1
                                                                    ((Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (name :
                                                                    'name Gram.t)
                                                                    ))))) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (semi_sep :
                                                                    'semi_sep Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (sl :
                                                                    'name list) ->
                                                                    fun _ ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("GLOBAL") ->
                                                                    (sl :
                                                                    'global)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (entry :
                                                                    'entry Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (name :
                                                                    'name Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    (":")) );
                                                                    (
                                                                    (Gram.Sopt
                                                                    ((Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (position :
                                                                    'position Gram.t)
                                                                    ))))) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (level_list :
                                                                    'level_list Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (ll :
                                                                    'level_list) ->
                                                                    fun (pos :
                                                                    'position option) ->
                                                                    fun _ ->
                                                                    fun (n :
                                                                    'name) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_entry
                                                                    ~name:n
                                                                    ~pos:pos
                                                                    ~levels:ll) :
                                                                    'entry)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (position :
                                                                    'position Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (("Before"
                                                                    | "After")
                                                                    | "Level") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT ((\"Before\" | \"After\") | \"Level\")"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (string :
                                                                    'string Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (n :
                                                                    'string) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ((("Before"
                                                                    | "After")
                                                                    | "Level") as
                                                                    x) ->
                                                                    ((Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExVrn
                                                                    (_loc, x))
                                                                    ), n)) :
                                                                    'position)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("First"
                                                                    | "Last") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"First\" | \"Last\")"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (("First"
                                                                    | "Last") as
                                                                    x) ->
                                                                    ((Ast.ExVrn
                                                                    (_loc, x)) :
                                                                    'position)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (level_list :
                                                                    'level_list Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("[")) );
                                                                    (
                                                                    (Gram.Slist0sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (level :
                                                                    'level Gram.t)
                                                                    ))) ), (
                                                                    (Gram.Skeyword
                                                                    ("|")) )))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    ("]")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (ll :
                                                                    'level list) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (ll :
                                                                    'level_list)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (level :
                                                                    'level Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Sopt
                                                                    (Gram.srules
                                                                    level (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | STRING
                                                                    (_, _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "STRING (_, _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | STRING
                                                                    (_, x) ->
                                                                    (x :
                                                                    'e__2)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] )))
                                                                    ); (
                                                                    (Gram.Sopt
                                                                    ((Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (assoc :
                                                                    'assoc Gram.t)
                                                                    ))))) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (rule_list :
                                                                    'rule_list Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (rules :
                                                                    'rule_list) ->
                                                                    fun (ass :
                                                                    'assoc option) ->
                                                                    fun (lab :
                                                                    'e__2 option) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_level
                                                                    ~label:lab
                                                                    ~assoc:ass
                                                                    ~rules:rules) :
                                                                    'level)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (assoc :
                                                                    'assoc Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (x) ->
                                                                    ((failwithf
                                                                    "%s is not a correct associativity:(LA|RA|NA)"
                                                                    x) :
                                                                    'assoc)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (("LA"
                                                                    | "RA")
                                                                    | "NA") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT ((\"LA\" | \"RA\") | \"NA\")"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ((("LA"
                                                                    | "RA")
                                                                    | "NA") as
                                                                    x) ->
                                                                    ((Ast.ExVrn
                                                                    (_loc, x)) :
                                                                    'assoc)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (rule_list :
                                                                    'rule_list Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("[")) );
                                                                    (
                                                                    (Gram.Slist1sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (rule :
                                                                    'rule Gram.t)
                                                                    ))) ), (
                                                                    (Gram.Skeyword
                                                                    ("|")) )))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    ("]")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (rules :
                                                                    'rule list) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((retype_rule_list_without_patterns
                                                                    _loc
                                                                    rules) :
                                                                    'rule_list)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("[")) );
                                                                    (
                                                                    (Gram.Skeyword
                                                                    ("]")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (([]) :
                                                                    'rule_list)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (rule :
                                                                    'rule Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Slist0sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (psymbol :
                                                                    'psymbol Gram.t)
                                                                    ))) ), (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (semi_sep :
                                                                    'semi_sep Gram.t)
                                                                    ))) )))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (psl :
                                                                    'psymbol list) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_rule
                                                                    ~prod:psl
                                                                    ~action:None
                                                                    ) :
                                                                    'rule) ))
                                                                    ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Slist0sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (psymbol :
                                                                    'psymbol Gram.t)
                                                                    ))) ), (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (semi_sep :
                                                                    'semi_sep Gram.t)
                                                                    ))) )))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    ("->"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (act :
                                                                    'expr) ->
                                                                    fun _ ->
                                                                    fun (psl :
                                                                    'psymbol list) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_rule
                                                                    ~prod:psl
                                                                    ~action:(
                                                                    (Some
                                                                    (act)) )) :
                                                                    'rule) ))
                                                                    ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (psymbol :
                                                                    'psymbol Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (s :
                                                                    'psymbol)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (pattern :
                                                                    'pattern Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    ("=")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun _ ->
                                                                    fun (p :
                                                                    'pattern) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((match
                                                                    s.pattern with
                                                                    | Some
                                                                    (Ast.PaApp
                                                                    (_,
                                                                    Ast.PaId
                                                                    (_,
                                                                    Ast.IdUid
                                                                    (_, u)),
                                                                    Ast.PaTup
                                                                    (_,
                                                                    Ast.PaAny
                                                                    (_)))) ->
                                                                    (mk_tok
                                                                    _loc (
                                                                    (Ast.PaApp
                                                                    (_loc, (
                                                                    (Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc, u))
                                                                    ))) ), p))
                                                                    ) (
                                                                    s.styp ))
                                                                    | _ ->
                                                                    {s with
                                                                    pattern =
                                                                    (
                                                                    (Some (p))
                                                                    )}) :
                                                                    'psymbol)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Sopt
                                                                    (Gram.srules
                                                                    psymbol (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("Level") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"Level\")"))
                                                                    ); (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | STRING
                                                                    (_, _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "STRING (_, _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (STRING
                                                                    (_, s),
                                                                    UIDENT
                                                                    ("Level")) ->
                                                                    (s :
                                                                    'e__3)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] )))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (lev :
                                                                    'e__3 option) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | LIDENT
                                                                    (i) ->
                                                                    (let name =
                                                                    (mk_name
                                                                    _loc (
                                                                    (Ast.IdLid
                                                                    (_loc, i))
                                                                    )) in
                                                                    let text =
                                                                    (TXnterm
                                                                    (_loc,
                                                                    name,
                                                                    lev)) in
                                                                    let styp =
                                                                    (STquo
                                                                    (_loc, i)) in
                                                                    {used = (
                                                                    [i] );
                                                                    text =
                                                                    text;
                                                                    styp =
                                                                    styp;
                                                                    pattern =
                                                                    None } :
                                                                    'psymbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    ("=")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun _ ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | LIDENT
                                                                    (p) ->
                                                                    ((match
                                                                    s.pattern with
                                                                    | Some
                                                                    (Ast.PaApp
                                                                    (_,
                                                                    Ast.PaId
                                                                    (_,
                                                                    Ast.IdUid
                                                                    (_, u)),
                                                                    Ast.PaTup
                                                                    (_,
                                                                    Ast.PaAny
                                                                    (_))) as
                                                                    p') ->
                                                                    let match_fun =
                                                                    (Ast.ExFun
                                                                    (_loc, (
                                                                    (Ast.McOr
                                                                    (_loc, (
                                                                    (Ast.McArr
                                                                    (_loc,
                                                                    p', (
                                                                    (Ast.ExNil
                                                                    (_loc))
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "True"))
                                                                    ))) )))
                                                                    ), (
                                                                    (Ast.McArr
                                                                    (_loc, (
                                                                    (Ast.PaAny
                                                                    (_loc))
                                                                    ), (
                                                                    (Ast.ExNil
                                                                    (_loc))
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "False"))
                                                                    ))) )))
                                                                    ))) ))) in
                                                                    let p' =
                                                                    (Ast.PaAli
                                                                    (_loc,
                                                                    p', (
                                                                    (Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc, p))
                                                                    ))) ))) in
                                                                    let descr =
                                                                    (u ^
                                                                    " _") in
                                                                    let text =
                                                                    (TXtok
                                                                    (_loc,
                                                                    match_fun,
                                                                    descr)) in
                                                                    {s with
                                                                    text =
                                                                    text;
                                                                    pattern =
                                                                    (
                                                                    (Some
                                                                    (p')) )}
                                                                    | _ ->
                                                                    {s with
                                                                    pattern =
                                                                    (
                                                                    (Some
                                                                    ((Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc, p))
                                                                    ))))) )}) :
                                                                    'psymbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [((
                                                                    (Some
                                                                    ("top"))
                                                                    ), (
                                                                    (Some
                                                                    (`NA)) ),
                                                                    (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("TRY") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"TRY\")"))
                                                                    );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("TRY") ->
                                                                    (let text =
                                                                    (TXtry
                                                                    (_loc, (
                                                                    s.text ))) in
                                                                    (mk_symbol
                                                                    ~used:(
                                                                    s.used )
                                                                    ~text:text
                                                                    ~styp:(
                                                                    s.styp )
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("OPT") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"OPT\")"))
                                                                    );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("OPT") ->
                                                                    (let 
                                                                    () =
                                                                    (check_not_tok
                                                                    s) in
                                                                    let styp =
                                                                    (STapp
                                                                    (_loc, (
                                                                    (STlid
                                                                    (_loc,
                                                                    "option"))
                                                                    ), (
                                                                    s.styp ))) in
                                                                    let text =
                                                                    (TXopt
                                                                    (_loc, (
                                                                    s.text ))) in
                                                                    (mk_symbol
                                                                    ~used:(
                                                                    s.used )
                                                                    ~text:text
                                                                    ~styp:styp
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("LIST0"
                                                                    | "LIST1") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"LIST0\" | \"LIST1\")"))
                                                                    );
                                                                    Gram.Sself
                                                                    ; (
                                                                    (Gram.Sopt
                                                                    (Gram.srules
                                                                    symbol (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("SEP") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"SEP\")"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (t :
                                                                    'symbol) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("SEP") ->
                                                                    (t :
                                                                    'e__4)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] )))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (sep :
                                                                    'e__4 option) ->
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    (("LIST0"
                                                                    | "LIST1") as
                                                                    x) ->
                                                                    (let 
                                                                    () =
                                                                    (check_not_tok
                                                                    s) in
                                                                    let used =
                                                                    (match
                                                                    sep with
                                                                    | Some
                                                                    (symb) ->
                                                                    ((
                                                                    symb.used
                                                                    ) @ (
                                                                    s.used ))
                                                                    | 
                                                                    None ->
                                                                    s.used) in
                                                                    let styp =
                                                                    (STapp
                                                                    (_loc, (
                                                                    (STlid
                                                                    (_loc,
                                                                    "list"))
                                                                    ), (
                                                                    s.styp ))) in
                                                                    let text =
                                                                    (slist
                                                                    _loc (
                                                                    (match
                                                                    x with
                                                                    | "LIST0" ->
                                                                    (false)
                                                                    | "LIST1" ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (failwithf
                                                                    "only (LIST0|LIST1) allowed here"))
                                                                    ) sep s) in
                                                                    (mk_symbol
                                                                    ~used:used
                                                                    ~text:text
                                                                    ~styp:styp
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ));
                                                                    (None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("(")) );
                                                                    Gram.Sself
                                                                    ; (
                                                                    (Gram.Skeyword
                                                                    (")")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (s_t :
                                                                    'symbol) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (s_t :
                                                                    'symbol)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (name :
                                                                    'name Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Sopt
                                                                    (Gram.srules
                                                                    symbol (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("Level") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"Level\")"))
                                                                    ); (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | STRING
                                                                    (_, _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "STRING (_, _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (STRING
                                                                    (_, s),
                                                                    UIDENT
                                                                    ("Level")) ->
                                                                    (s :
                                                                    'e__5)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] )))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (lev :
                                                                    'e__5 option) ->
                                                                    fun (n :
                                                                    'name) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_symbol
                                                                    ~used:(
                                                                    [( 
                                                                    n.tvar )]
                                                                    ) ~text:(
                                                                    (TXnterm
                                                                    (_loc, n,
                                                                    lev)) )
                                                                    ~styp:(
                                                                    (STquo
                                                                    (_loc, (
                                                                    n.tvar )))
                                                                    )
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | STRING
                                                                    (_, _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "STRING (_, _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | STRING
                                                                    (_, s) ->
                                                                    ((mk_symbol
                                                                    ~used:[] 
                                                                    ~text:(
                                                                    (TXkwd
                                                                    (_loc, s))
                                                                    ) ~styp:(
                                                                    (STtok
                                                                    (_loc)) )
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (_)"))
                                                                    ); (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | ANTIQUOT
                                                                    ("", _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "ANTIQUOT (\"\", _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (ANTIQUOT
                                                                    ("", s),
                                                                    UIDENT
                                                                    (x)) ->
                                                                    (let e =
                                                                    (AntiquotSyntax.parse_expr
                                                                    _loc s) in
                                                                    let match_fun =
                                                                    (Ast.ExFun
                                                                    (_loc, (
                                                                    (Ast.McOr
                                                                    (_loc, (
                                                                    (Ast.McArr
                                                                    (_loc, (
                                                                    (Ast.PaApp
                                                                    (_loc, (
                                                                    (Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc, x))
                                                                    ))) ), (
                                                                    (Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "camlp4_x"))
                                                                    ))) )))
                                                                    ), (
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "=")) )))
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "camlp4_x"))
                                                                    ))) )))
                                                                    ), e)) ),
                                                                    (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "True"))
                                                                    ))) )))
                                                                    ), (
                                                                    (Ast.McArr
                                                                    (_loc, (
                                                                    (Ast.PaAny
                                                                    (_loc))
                                                                    ), (
                                                                    (Ast.ExNil
                                                                    (_loc))
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "False"))
                                                                    ))) )))
                                                                    ))) ))) in
                                                                    let descr =
                                                                    ("$" ^ (
                                                                    (x ^ (
                                                                    (" " ^ s)
                                                                    )) )) in
                                                                    let text =
                                                                    (TXtok
                                                                    (_loc,
                                                                    match_fun,
                                                                    descr)) in
                                                                    let p =
                                                                    (Ast.PaApp
                                                                    (_loc, (
                                                                    (Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdUid
                                                                    (_loc, x))
                                                                    ))) ), (
                                                                    (Ast.PaTup
                                                                    (_loc, (
                                                                    (Ast.PaAny
                                                                    (_loc))
                                                                    ))) ))) in
                                                                    (mk_symbol
                                                                    ~used:[] 
                                                                    ~text:text
                                                                    ~styp:(
                                                                    (STtok
                                                                    (_loc)) )
                                                                    ~pattern:(
                                                                    (Some (p))
                                                                    )) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("`")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (patt :
                                                                    'patt Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (p :
                                                                    'patt) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_tok
                                                                    _loc p (
                                                                    (STtok
                                                                    (_loc))
                                                                    )) :
                                                                    'symbol)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("[")) );
                                                                    (
                                                                    (Gram.Slist0sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (rule :
                                                                    'rule Gram.t)
                                                                    ))) ), (
                                                                    (Gram.Skeyword
                                                                    ("|")) )))
                                                                    ); (
                                                                    (Gram.Skeyword
                                                                    ("]")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (rl :
                                                                    'rule list) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (let rl =
                                                                    (retype_rule_list_without_patterns
                                                                    _loc rl) in
                                                                    let t =
                                                                    (new_type_var
                                                                    () ) in
                                                                    let used =
                                                                    (used_of_rule_list
                                                                    rl) in
                                                                    (mk_symbol
                                                                    ~used:used
                                                                    ~text:(
                                                                    (TXrules
                                                                    (_loc, (
                                                                    (srules
                                                                    _loc t rl
                                                                    "") ))) )
                                                                    ~styp:(
                                                                    (STquo
                                                                    (_loc, t))
                                                                    )
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("NEXT") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"NEXT\")"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("NEXT") ->
                                                                    ((mk_symbol
                                                                    ~used:[] 
                                                                    ~text:(
                                                                    (TXnext
                                                                    (_loc)) )
                                                                    ~styp:(
                                                                    (STself
                                                                    (_loc,
                                                                    "NEXT"))
                                                                    )
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("SELF") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"SELF\")"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("SELF") ->
                                                                    ((mk_symbol
                                                                    ~used:[] 
                                                                    ~text:(
                                                                    (TXself
                                                                    (_loc)) )
                                                                    ~styp:(
                                                                    (STself
                                                                    (_loc,
                                                                    "SELF"))
                                                                    )
                                                                    ~pattern:None
                                                                    ) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (pattern :
                                                                    'pattern Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("(")) );
                                                                    Gram.Sself
                                                                    ; (
                                                                    (Gram.Skeyword
                                                                    (",")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (comma_patt :
                                                                    'comma_patt Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    (")")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (p2 :
                                                                    'comma_patt) ->
                                                                    fun _ ->
                                                                    fun (p1 :
                                                                    'pattern) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.PaTup
                                                                    (_loc, (
                                                                    (Ast.PaCom
                                                                    (_loc,
                                                                    p1, p2))
                                                                    ))) :
                                                                    'pattern)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("(")) );
                                                                    Gram.Sself
                                                                    ; (
                                                                    (Gram.Skeyword
                                                                    (")")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (p :
                                                                    'pattern) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (p :
                                                                    'pattern)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("_")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.PaAny
                                                                    (_loc)) :
                                                                    'pattern)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | LIDENT
                                                                    (_) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "LIDENT (_)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | LIDENT
                                                                    (i) ->
                                                                    ((Ast.PaId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc, i))
                                                                    ))) :
                                                                    'pattern)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (comma_patt :
                                                                    'comma_patt Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (pattern :
                                                                    'pattern Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (p :
                                                                    'pattern) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (p :
                                                                    'comma_patt)
                                                                    )) ));
                                                                    ((
                                                                    [Gram.Sself
                                                                    ; (
                                                                    (Gram.Skeyword
                                                                    (",")) );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (p2 :
                                                                    'comma_patt) ->
                                                                    fun _ ->
                                                                    fun (p1 :
                                                                    'comma_patt) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.PaCom
                                                                    (_loc,
                                                                    p1, p2)) :
                                                                    'comma_patt)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (name :
                                                                    'name Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (qualid :
                                                                    'qualid Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (il :
                                                                    'qualid) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((mk_name
                                                                    _loc il) :
                                                                    'name) ))
                                                                    ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (string :
                                                                    'string Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | ANTIQUOT
                                                                    ("", _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "ANTIQUOT (\"\", _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | ANTIQUOT
                                                                    ("", s) ->
                                                                    ((AntiquotSyntax.parse_expr
                                                                    _loc s) :
                                                                    'string)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | STRING
                                                                    (_, _) ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "STRING (_, _)"))
                                                                    )] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | STRING
                                                                    (_, s) ->
                                                                    ((Ast.ExStr
                                                                    (_loc, s)) :
                                                                    'string)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (Gram.extend
                                                                    (
                                                                    (semi_sep :
                                                                    'semi_sep Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    (";")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (() :
                                                                    'semi_sep)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))

                                                            let sfold =
                                                             fun _loc ->
                                                              fun n ->
                                                               fun foldfun ->
                                                                fun f ->
                                                                 fun e ->
                                                                  fun s ->
                                                                   let styp =
                                                                    (
                                                                    STquo
                                                                    (_loc, (
                                                                    (new_type_var
                                                                    () ) ))) in
                                                                   let e =
                                                                    (
                                                                    Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdAcc
                                                                    (_loc, (
                                                                    (gm () )
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    foldfun))
                                                                    ))) )))
                                                                    ), f)) ),
                                                                    e)) in
                                                                   let t =
                                                                    (
                                                                    STapp
                                                                    (_loc, (
                                                                    (STapp
                                                                    (_loc, (
                                                                    (STtyp
                                                                    ((Ast.TyApp
                                                                    (_loc, (
                                                                    (Ast.TyId
                                                                    (_loc, (
                                                                    (Ast.IdAcc
                                                                    (_loc, (
                                                                    (gm () )
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "fold"))
                                                                    ))) )))
                                                                    ), (
                                                                    (Ast.TyAny
                                                                    (_loc))
                                                                    ))))) ),
                                                                    ( 
                                                                    s.styp )))
                                                                    ), styp)) in
                                                                   {used = (
                                                                    s.used );
                                                                    text = (
                                                                    (TXmeta
                                                                    (_loc, n,
                                                                    (
                                                                    [( 
                                                                    s.text )]
                                                                    ), e, t))
                                                                    );
                                                                    styp =
                                                                    styp;
                                                                    pattern =
                                                                    None }

                                                            let sfoldsep =
                                                             fun _loc ->
                                                              fun n ->
                                                               fun foldfun ->
                                                                fun f ->
                                                                 fun e ->
                                                                  fun s ->
                                                                   fun sep ->
                                                                    let styp =
                                                                    (STquo
                                                                    (_loc, (
                                                                    (new_type_var
                                                                    () ) ))) in
                                                                    let e =
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExApp
                                                                    (_loc, (
                                                                    (Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdAcc
                                                                    (_loc, (
                                                                    (gm () )
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    foldfun))
                                                                    ))) )))
                                                                    ), f)) ),
                                                                    e)) in
                                                                    let t =
                                                                    (STapp
                                                                    (_loc, (
                                                                    (STapp
                                                                    (_loc, (
                                                                    (STtyp
                                                                    ((Ast.TyApp
                                                                    (_loc, (
                                                                    (Ast.TyId
                                                                    (_loc, (
                                                                    (Ast.IdAcc
                                                                    (_loc, (
                                                                    (gm () )
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "foldsep"))
                                                                    ))) )))
                                                                    ), (
                                                                    (Ast.TyAny
                                                                    (_loc))
                                                                    ))))) ),
                                                                    ( 
                                                                    s.styp )))
                                                                    ), styp)) in
                                                                    {used = (
                                                                    (( 
                                                                    s.used )
                                                                    @ (
                                                                    sep.used
                                                                    )) );
                                                                    text = (
                                                                    (TXmeta
                                                                    (_loc, n,
                                                                    (
                                                                    [( 
                                                                    s.text );
                                                                    (
                                                                    sep.text
                                                                    )] ), e,
                                                                    t)) );
                                                                    styp =
                                                                    styp;
                                                                    pattern =
                                                                    None }

                                                            let _ = let _ =
                                                                    (symbol :
                                                                    'symbol Gram.t) in
                                                                    let grammar_entry_create =
                                                                    Gram.mk in
                                                                    let simple_expr =
                                                                    ((grammar_entry_create
                                                                    "simple_expr") :
                                                                    'simple_expr Gram.t) in
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (symbol :
                                                                    'symbol Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    ((
                                                                    (Some
                                                                    (`Level
                                                                    "top"))
                                                                    ), (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("FOLD1") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"FOLD1\")"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) );
                                                                    Gram.Sself
                                                                    ; (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("SEP") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"SEP\")"))
                                                                    );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (sep :
                                                                    'symbol) ->
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (e :
                                                                    'simple_expr) ->
                                                                    fun (f :
                                                                    'simple_expr) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (UIDENT
                                                                    ("SEP"),
                                                                    UIDENT
                                                                    ("FOLD1")) ->
                                                                    ((sfoldsep
                                                                    _loc
                                                                    "FOLD1 SEP"
                                                                    "sfold1sep"
                                                                    f e s
                                                                    sep) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("FOLD0") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"FOLD0\")"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) );
                                                                    Gram.Sself
                                                                    ; (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("SEP") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"SEP\")"))
                                                                    );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (sep :
                                                                    'symbol) ->
                                                                    fun (__camlp4_1 :
                                                                    Gram.token) ->
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (e :
                                                                    'simple_expr) ->
                                                                    fun (f :
                                                                    'simple_expr) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    (__camlp4_1,
                                                                    __camlp4_0) with
                                                                    | (UIDENT
                                                                    ("SEP"),
                                                                    UIDENT
                                                                    ("FOLD0")) ->
                                                                    ((sfoldsep
                                                                    _loc
                                                                    "FOLD0 SEP"
                                                                    "sfold0sep"
                                                                    f e s
                                                                    sep) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("FOLD1") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"FOLD1\")"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (e :
                                                                    'simple_expr) ->
                                                                    fun (f :
                                                                    'simple_expr) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("FOLD1") ->
                                                                    ((sfold
                                                                    _loc
                                                                    "FOLD1"
                                                                    "sfold1"
                                                                    f e s) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | UIDENT
                                                                    ("FOLD0") ->
                                                                    (true)
                                                                    | 
                                                                    _ ->
                                                                    (false)
                                                                    ),
                                                                    "UIDENT (\"FOLD0\")"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ))) );
                                                                    Gram.Sself
                                                                    ] ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (s :
                                                                    'symbol) ->
                                                                    fun (e :
                                                                    'simple_expr) ->
                                                                    fun (f :
                                                                    'simple_expr) ->
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | UIDENT
                                                                    ("FOLD0") ->
                                                                    ((sfold
                                                                    _loc
                                                                    "FOLD0"
                                                                    "sfold0"
                                                                    f e s) :
                                                                    'symbol)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))
                                                                    );
                                                                    (Gram.extend
                                                                    (
                                                                    (simple_expr :
                                                                    'simple_expr Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None , (
                                                                    [(None ,
                                                                    None , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("(")) );
                                                                    (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    ))) ); (
                                                                    (Gram.Skeyword
                                                                    (")")) )]
                                                                    ), (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (e :
                                                                    'expr) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'simple_expr)
                                                                    )) ));
                                                                    ((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (a_LIDENT :
                                                                    'a_LIDENT Gram.t)
                                                                    ))) )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (i :
                                                                    'a_LIDENT) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.ExId
                                                                    (_loc, (
                                                                    (Ast.IdLid
                                                                    (_loc, i))
                                                                    ))) :
                                                                    'simple_expr)
                                                                    )) ))] ))]
                                                                    ))) () )
                                                                    ))

                                                            let _ = (Options.add
                                                                    "-split_ext"
                                                                    (
                                                                    (Arg.Set
                                                                    (split_ext))
                                                                    )
                                                                    "Split EXTEND by functions to turn around a PowerPC problem.")

                                                            let _ = (Options.add
                                                                    "-split_gext"
                                                                    (
                                                                    (Arg.Set
                                                                    (split_ext))
                                                                    )
                                                                    "Old name for the option -split_ext.")

                                                            let _ = (Options.add
                                                                    "-meta_action"
                                                                    (
                                                                    (Arg.Set
                                                                    (meta_action))
                                                                    )
                                                                    "Undocumented")

                                                           end

module IdListComprehension =
                                                                 struct
                                                                  let name =
                                                                   "Camlp4ListComprehension"

                                                                  let version =
                                                                   Sys.ocaml_version

                                                                 end


module MakeListComprehension =
 functor (Syntax : Sig.Camlp4Syntax) ->
  struct
   open FanSig

   include Syntax

   module Ast = Camlp4Ast

   let test_patt_lessminus =
    (Gram.of_parser "test_patt_lessminus" (
      fun strm ->
       let rec skip_patt =
        fun n ->
         (match (stream_peek_nth n strm) with
          | Some (KEYWORD ("<-")) -> n
          | Some (KEYWORD ("[" | "[<")) ->
             (skip_patt ( (( (ignore_upto "]" ( (n + 1) )) ) + 1) ))
          | Some (KEYWORD ("(")) ->
             (skip_patt ( (( (ignore_upto ")" ( (n + 1) )) ) + 1) ))
          | Some (KEYWORD ("{")) ->
             (skip_patt ( (( (ignore_upto "}" ( (n + 1) )) ) + 1) ))
          | (Some (KEYWORD ((("as" | "::") | ",") | "_"))
             | Some (LIDENT (_) | UIDENT (_))) ->
             (skip_patt ( (n + 1) ))
          | (Some (_) | None) -> (raise Stream.Failure ))
       and ignore_upto =
        fun end_kwd ->
         fun n ->
          (match (stream_peek_nth n strm) with
           | Some (KEYWORD (prm)) when (prm = end_kwd) -> n
           | Some (KEYWORD ("[" | "[<")) ->
              (ignore_upto end_kwd ( (( (ignore_upto "]" ( (n + 1) )) ) + 1)
                ))
           | Some (KEYWORD ("(")) ->
              (ignore_upto end_kwd ( (( (ignore_upto ")" ( (n + 1) )) ) + 1)
                ))
           | Some (KEYWORD ("{")) ->
              (ignore_upto end_kwd ( (( (ignore_upto "}" ( (n + 1) )) ) + 1)
                ))
           | Some (_) -> (ignore_upto end_kwd ( (n + 1) ))
           | None -> (raise Stream.Failure )) in
       (skip_patt 1) ))

   let _ = (Gram.delete_rule expr (
             [( (Gram.Skeyword ("[")) ); (
              (Gram.Snterm
                (Gram.obj ( (sem_expr_for_list : 'sem_expr_for_list Gram.t)
                  ))) ); ( (Gram.Skeyword ("]")) )] ))

   let is_revised =
    (try
      (
     (Gram.delete_rule expr (
       [( (Gram.Skeyword ("[")) ); (
        (Gram.Snterm
          (Gram.obj ( (sem_expr_for_list : 'sem_expr_for_list Gram.t) ))) );
        ( (Gram.Skeyword ("::")) ); (
        (Gram.Snterm (Gram.obj ( (expr : 'expr Gram.t) ))) ); (
        (Gram.Skeyword ("]")) )] ))
     );
      (true)
     with
     Not_found -> (false))

   let comprehension_or_sem_expr_for_list =
    (Gram.mk "comprehension_or_sem_expr_for_list")

   let _ = let _ = (expr : 'expr Gram.t)
           and _ =
            (comprehension_or_sem_expr_for_list :
              'comprehension_or_sem_expr_for_list Gram.t) in
           let grammar_entry_create = Gram.mk in
           let item = ((grammar_entry_create "item") : 'item Gram.t) in
           (
           (Gram.extend ( (expr : 'expr Gram.t) ) (
             ((fun ()
                 ->
                (( (Some (`Level "simple")) ), (
                 [(None , None , (
                   [((
                     [( (Gram.Skeyword ("[")) ); (
                      (Gram.Snterm
                        (Gram.obj (
                          (comprehension_or_sem_expr_for_list :
                            'comprehension_or_sem_expr_for_list Gram.t) )))
                      ); ( (Gram.Skeyword ("]")) )] ), (
                     (Gram.mk_action (
                       fun _ ->
                        fun (e :
                          'comprehension_or_sem_expr_for_list) ->
                         fun _ -> fun (_loc : FanLoc.t) -> (e : 'expr) )) ))]
                   ))] ))) () ) ))
           );
           (
           (Gram.extend (
             (comprehension_or_sem_expr_for_list :
               'comprehension_or_sem_expr_for_list Gram.t) ) (
             ((fun ()
                 ->
                (None , (
                 [(None , None , (
                   [((
                     [(
                      (Gram.Snterml
                        (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top")) )]
                     ), (
                     (Gram.mk_action (
                       fun (e :
                         'expr) ->
                        fun (_loc :
                          FanLoc.t) ->
                         ((Ast.ExApp
                            (_loc, (
                             (Ast.ExApp
                               (_loc, (
                                (Ast.ExId
                                  (_loc, ( (Ast.IdUid (_loc, "::")) ))) ), e))
                             ), (
                             (Ast.ExId (_loc, ( (Ast.IdUid (_loc, "[]")) )))
                             ))) : 'comprehension_or_sem_expr_for_list) )) ));
                    ((
                     [(
                      (Gram.Snterml
                        (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top")) );
                      ( (Gram.Skeyword ("|")) ); (
                      (Gram.Slist1sep
                        (( (Gram.Snterm (Gram.obj ( (item : 'item Gram.t) )))
                         ), ( (Gram.Skeyword (";")) ))) )] ), (
                     (Gram.mk_action (
                       fun (l :
                         'item list) ->
                        fun _ ->
                         fun (e :
                           'expr) ->
                          fun (_loc :
                            FanLoc.t) ->
                           ((Expr.compr _loc e l) :
                             'comprehension_or_sem_expr_for_list) )) ));
                    ((
                     [(
                      (Gram.Snterml
                        (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top")) );
                      ( (Gram.Skeyword (";")) )] ), (
                     (Gram.mk_action (
                       fun _ ->
                        fun (e :
                          'expr) ->
                         fun (_loc :
                           FanLoc.t) ->
                          ((Ast.ExApp
                             (_loc, (
                              (Ast.ExApp
                                (_loc, (
                                 (Ast.ExId
                                   (_loc, ( (Ast.IdUid (_loc, "::")) ))) ),
                                 e)) ), (
                              (Ast.ExId (_loc, ( (Ast.IdUid (_loc, "[]")) )))
                              ))) : 'comprehension_or_sem_expr_for_list) ))
                     ));
                    ((
                     [(
                      (Gram.Snterml
                        (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top")) );
                      ( (Gram.Skeyword (";")) ); (
                      (Gram.Snterm
                        (Gram.obj (
                          (sem_expr_for_list : 'sem_expr_for_list Gram.t) )))
                      )] ), (
                     (Gram.mk_action (
                       fun (mk :
                         'sem_expr_for_list) ->
                        fun _ ->
                         fun (e :
                           'expr) ->
                          fun (_loc :
                            FanLoc.t) ->
                           ((Ast.ExApp
                              (_loc, (
                               (Ast.ExApp
                                 (_loc, (
                                  (Ast.ExId
                                    (_loc, ( (Ast.IdUid (_loc, "::")) ))) ),
                                  e)) ), (
                               (mk (
                                 (Ast.ExId
                                   (_loc, ( (Ast.IdUid (_loc, "[]")) ))) ))
                               ))) : 'comprehension_or_sem_expr_for_list) ))
                     ))] ))] ))) () ) ))
           );
           (Gram.extend ( (item : 'item Gram.t) ) (
             ((fun ()
                 ->
                (None , (
                 [(None , None , (
                   [((
                     [(
                      (Gram.Snterml
                        (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top")) )]
                     ), (
                     (Gram.mk_action (
                       fun (e :
                         'expr) ->
                        fun (_loc : FanLoc.t) -> (`cond e : 'item) )) ));
                    ((
                     [(
                      (Gram.Stry
                        (Gram.srules item (
                          [((
                            [(
                             (Gram.Snterm
                               (Gram.obj ( (patt : 'patt Gram.t) ))) ); (
                             (Gram.Skeyword ("<-")) )] ), (
                            (Gram.mk_action (
                              fun _ ->
                               fun (p :
                                 'patt) ->
                                fun (_loc : FanLoc.t) -> (p : 'e__6) )) ))]
                          ))) ); (
                      (Gram.Snterml
                        (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top")) )]
                     ), (
                     (Gram.mk_action (
                       fun (e :
                         'expr) ->
                        fun (p :
                          'e__6) ->
                         fun (_loc : FanLoc.t) -> (`gen (p, e) : 'item) )) ))]
                   ))] ))) () ) ))

   let _ = if is_revised then
            (
            let _ = (expr : 'expr Gram.t)
            and _ =
             (comprehension_or_sem_expr_for_list :
               'comprehension_or_sem_expr_for_list Gram.t) in
            (Gram.extend (
              (comprehension_or_sem_expr_for_list :
                'comprehension_or_sem_expr_for_list Gram.t) ) (
              ((fun ()
                  ->
                 (None , (
                  [(None , None , (
                    [((
                      [(
                       (Gram.Snterml
                         (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top"))
                       ); ( (Gram.Skeyword ("::")) ); (
                       (Gram.Snterm (Gram.obj ( (expr : 'expr Gram.t) ))) )]
                      ), (
                      (Gram.mk_action (
                        fun (last :
                          'expr) ->
                         fun _ ->
                          fun (e :
                            'expr) ->
                           fun (_loc :
                             FanLoc.t) ->
                            ((Ast.ExApp
                               (_loc, (
                                (Ast.ExApp
                                  (_loc, (
                                   (Ast.ExId
                                     (_loc, ( (Ast.IdUid (_loc, "::")) ))) ),
                                   e)) ), last)) :
                              'comprehension_or_sem_expr_for_list) )) ));
                     ((
                      [(
                       (Gram.Snterml
                         (( (Gram.obj ( (expr : 'expr Gram.t) )) ), "top"))
                       ); ( (Gram.Skeyword (";")) ); (
                       (Gram.Snterm
                         (Gram.obj (
                           (sem_expr_for_list : 'sem_expr_for_list Gram.t) )))
                       ); ( (Gram.Skeyword ("::")) ); (
                       (Gram.Snterm (Gram.obj ( (expr : 'expr Gram.t) ))) )]
                      ), (
                      (Gram.mk_action (
                        fun (last :
                          'expr) ->
                         fun _ ->
                          fun (mk :
                            'sem_expr_for_list) ->
                           fun _ ->
                            fun (e :
                              'expr) ->
                             fun (_loc :
                               FanLoc.t) ->
                              ((Ast.ExApp
                                 (_loc, (
                                  (Ast.ExApp
                                    (_loc, (
                                     (Ast.ExId
                                       (_loc, ( (Ast.IdUid (_loc, "::")) )))
                                     ), e)) ), ( (mk last) ))) :
                                'comprehension_or_sem_expr_for_list) )) ))]
                    ))] ))) () ) ))
            )
           else ()

  end

module IdMacroParser =
        struct
         let name = "Camlp4MacroParser"

         let version = Sys.ocaml_version

        end

module MakeMacroParser =
              functor (Syntax : Sig.Camlp4Syntax) ->
               struct
                open FanSig

                include Syntax

                module Ast = Camlp4Ast

                type 'a item_or_def =
                   SdStr of 'a
                 | SdDef of string * (string list * Ast.expr) option
                 | SdUnd of string
                 | SdITE of bool * 'a item_or_def list * 'a item_or_def list
                 | SdLazy of 'a Lazy.t

                let defined = (ref [] )

                let is_defined =
                 fun i -> (List.mem_assoc i ( defined.contents ))

                let incorrect_number =
                 fun loc ->
                  fun l1 ->
                   fun l2 ->
                    (FanLoc.raise loc (
                      (Failure
                        (Printf.sprintf "expected %d parameters; found %d" (
                          (List.length l2) ) ( (List.length l1) ))) ))

                let define =
                 fun eo ->
                  fun x ->
                   (
                   (match eo with
                    | Some ([], e) ->
                       (
                       (Gram.extend ( (expr : 'expr Gram.t) ) (
                         ((fun ()
                             ->
                            (( (Some (`Level "simple")) ), (
                             [(None , None , (
                               [((
                                 [(
                                  (Gram.Stoken
                                    ((
                                     function
                                     | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                        (true)
                                     | _ -> (false) ), "$UIDENT x")) )] ), (
                                 (Gram.mk_action (
                                   fun (__camlp4_0 :
                                     Gram.token) ->
                                    fun (_loc :
                                      FanLoc.t) ->
                                     (match __camlp4_0 with
                                      | UIDENT (_) ->
                                         (((((new Ast.reloc) _loc)#expr) e) :
                                           'expr)
                                      | _ -> assert false) )) ))] ))] ))) ()
                           ) ))
                       );
                       (Gram.extend ( (patt : 'patt Gram.t) ) (
                         ((fun ()
                             ->
                            (( (Some (`Level "simple")) ), (
                             [(None , None , (
                               [((
                                 [(
                                  (Gram.Stoken
                                    ((
                                     function
                                     | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                        (true)
                                     | _ -> (false) ), "$UIDENT x")) )] ), (
                                 (Gram.mk_action (
                                   fun (__camlp4_0 :
                                     Gram.token) ->
                                    fun (_loc :
                                      FanLoc.t) ->
                                     (match __camlp4_0 with
                                      | UIDENT (_) ->
                                         (let p = (Expr.substp _loc []  e) in
                                          ((((new Ast.reloc) _loc)#patt) p) :
                                           'patt)
                                      | _ -> assert false) )) ))] ))] ))) ()
                           ) ))
                    | Some (sl, e) ->
                       (
                       (Gram.extend ( (expr : 'expr Gram.t) ) (
                         ((fun ()
                             ->
                            (( (Some (`Level "apply")) ), (
                             [(None , None , (
                               [((
                                 [(
                                  (Gram.Stoken
                                    ((
                                     function
                                     | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                        (true)
                                     | _ -> (false) ), "$UIDENT x")) );
                                  Gram.Sself ] ), (
                                 (Gram.mk_action (
                                   fun (param :
                                     'expr) ->
                                    fun (__camlp4_0 :
                                      Gram.token) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (match __camlp4_0 with
                                       | UIDENT (_) ->
                                          (let el =
                                            (match param with
                                             | Ast.ExTup (_, e) ->
                                                (Ast.list_of_expr e [] )
                                             | e -> [e]) in
                                           if (( (List.length el) ) = (
                                                (List.length sl) )) then
                                            (
                                            let env = (List.combine sl el) in
                                            ((((new Expr.subst) _loc env)
                                              #expr) e)
                                            )
                                           else (incorrect_number _loc el sl) :
                                            'expr)
                                       | _ -> assert false) )) ))] ))] ))) ()
                           ) ))
                       );
                       (Gram.extend ( (patt : 'patt Gram.t) ) (
                         ((fun ()
                             ->
                            (( (Some (`Level "simple")) ), (
                             [(None , None , (
                               [((
                                 [(
                                  (Gram.Stoken
                                    ((
                                     function
                                     | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                        (true)
                                     | _ -> (false) ), "$UIDENT x")) );
                                  Gram.Sself ] ), (
                                 (Gram.mk_action (
                                   fun (param :
                                     'patt) ->
                                    fun (__camlp4_0 :
                                      Gram.token) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (match __camlp4_0 with
                                       | UIDENT (_) ->
                                          (let pl =
                                            (match param with
                                             | Ast.PaTup (_, p) ->
                                                (Ast.list_of_patt p [] )
                                             | p -> [p]) in
                                           if (( (List.length pl) ) = (
                                                (List.length sl) )) then
                                            (
                                            let env = (List.combine sl pl) in
                                            let p = (Expr.substp _loc env e) in
                                            ((((new Ast.reloc) _loc)#patt) p)
                                            )
                                           else (incorrect_number _loc pl sl) :
                                            'patt)
                                       | _ -> assert false) )) ))] ))] ))) ()
                           ) ))
                    | None -> ())
                   );
                   (defined := ( ( (x, eo) ) :: defined.contents  ))

                let undef =
                 fun x ->
                  (try
                    (
                   let eo = (List.assoc x ( defined.contents )) in
                   (match eo with
                    | Some ([], _) ->
                       (
                       (Gram.delete_rule expr (
                         [(
                          (Gram.Stoken
                            ((
                             function
                             | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                (true)
                             | _ -> (false) ), "$UIDENT x")) )] ))
                       );
                       (Gram.delete_rule patt (
                         [(
                          (Gram.Stoken
                            ((
                             function
                             | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                (true)
                             | _ -> (false) ), "$UIDENT x")) )] ))
                    | Some (_, _) ->
                       (
                       (Gram.delete_rule expr (
                         [(
                          (Gram.Stoken
                            ((
                             function
                             | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                (true)
                             | _ -> (false) ), "$UIDENT x")) ); Gram.Sself ]
                         ))
                       );
                       (Gram.delete_rule patt (
                         [(
                          (Gram.Stoken
                            ((
                             function
                             | UIDENT (camlp4_x) when (camlp4_x = x) ->
                                (true)
                             | _ -> (false) ), "$UIDENT x")) ); Gram.Sself ]
                         ))
                    | None -> ())
                   );
                    (defined := ( (list_remove x ( defined.contents )) ))
                   with
                   Not_found -> ())

                let parse_def =
                 fun s ->
                  (match
                     (Gram.parse_string expr ( (FanLoc.mk "<command line>") )
                       s) with
                   | Ast.ExId (_, Ast.IdUid (_, n)) -> (define None  n)
                   | Ast.ExApp
                      (_,
                       Ast.ExApp
                        (_, Ast.ExId (_, Ast.IdLid (_, "=")),
                         Ast.ExId (_, Ast.IdUid (_, n))), e) ->
                      (define ( (Some ([] , e)) ) n)
                   | _ -> (invalid_arg s))

                let include_dirs = (ref [] )

                let add_include_dir =
                 fun str ->
                  if (str <> "") then
                   (
                   let str =
                    if (( (String.get str ( (( (String.length str) ) - 1) ))
                         ) = '/') then
                     str
                    else (str ^ "/") in
                   (include_dirs := ( (( include_dirs.contents ) @ ( [str] ))
                     ))
                   )
                  else ()

                let parse_include_file =
                 fun rule ->
                  let dir_ok =
                   fun file -> fun dir -> (Sys.file_exists ( (dir ^ file) )) in
                  fun file ->
                   let file =
                    (try
                      ((
                        (List.find ( (dir_ok file) ) (
                          (( include_dirs.contents ) @ ( ["./"] )) )) ) ^
                        file)
                     with
                     Not_found -> file) in
                   let ch = (open_in file) in
                   let st = (Stream.of_channel ch) in
                   (Gram.parse rule ( (FanLoc.mk file) ) st)

                let rec execute_macro =
                 fun nil ->
                  fun cons ->
                   function
                   | SdStr (i) -> i
                   | SdDef (x, eo) -> ( (define eo x) ); nil
                   | SdUnd (x) -> ( (undef x) ); nil
                   | SdITE (b, l1, l2) ->
                      (execute_macro_list nil cons ( if b then l1 else l2 ))
                   | SdLazy (l) -> (Lazy.force l)
                and execute_macro_list =
                 fun nil ->
                  fun cons ->
                   function
                   | [] -> nil
                   | (hd :: tl) ->
                      let il1 = (execute_macro nil cons hd) in
                      let il2 = (execute_macro_list nil cons tl) in
                      (cons il1 il2)

                let stack = (Stack.create () )

                let make_SdITE_result =
                 fun st1 ->
                  fun st2 ->
                   let test = (Stack.pop stack) in (SdITE (test, st1, st2))

                type branch = Then | Else

                let execute_macro_if_active_branch =
                 fun _loc ->
                  fun nil ->
                   fun cons ->
                    fun branch ->
                     fun macro_def ->
                      let test = (Stack.top stack) in
                      let item =
                       if (( (test && ( (branch = Then ) )) ) || (
                            (( (not test) ) && ( (branch = Else ) )) )) then
                        (
                        (execute_macro nil cons macro_def)
                        )
                       else nil in
                      (SdStr (item))

                let _ = let _ = (expr : 'expr Gram.t)
                        and _ = (sig_item : 'sig_item Gram.t)
                        and _ = (str_item : 'str_item Gram.t)
                        and _ = (patt : 'patt Gram.t) in
                        let grammar_entry_create = Gram.mk in
                        let macro_def =
                         ((grammar_entry_create "macro_def") :
                           'macro_def Gram.t)
                        and uident =
                         ((grammar_entry_create "uident") :
                           'uident Gram.t)
                        and opt_macro_value =
                         ((grammar_entry_create "opt_macro_value") :
                           'opt_macro_value Gram.t)
                        and endif =
                         ((grammar_entry_create "endif") : 'endif Gram.t)
                        and sglist_else =
                         ((grammar_entry_create "sglist_else") :
                           'sglist_else Gram.t)
                        and sglist_then =
                         ((grammar_entry_create "sglist_then") :
                           'sglist_then Gram.t)
                        and smlist_else =
                         ((grammar_entry_create "smlist_else") :
                           'smlist_else Gram.t)
                        and smlist_then =
                         ((grammar_entry_create "smlist_then") :
                           'smlist_then Gram.t)
                        and else_expr =
                         ((grammar_entry_create "else_expr") :
                           'else_expr Gram.t)
                        and else_macro_def_sig =
                         ((grammar_entry_create "else_macro_def_sig") :
                           'else_macro_def_sig Gram.t)
                        and else_macro_def =
                         ((grammar_entry_create "else_macro_def") :
                           'else_macro_def Gram.t)
                        and uident_eval_ifndef =
                         ((grammar_entry_create "uident_eval_ifndef") :
                           'uident_eval_ifndef Gram.t)
                        and uident_eval_ifdef =
                         ((grammar_entry_create "uident_eval_ifdef") :
                           'uident_eval_ifdef Gram.t)
                        and macro_def_sig =
                         ((grammar_entry_create "macro_def_sig") :
                           'macro_def_sig Gram.t) in
                        (
                        (Gram.extend ( (str_item : 'str_item Gram.t) ) (
                          ((fun ()
                              ->
                             (( (Some (`First)) ), (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (macro_def : 'macro_def Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (x :
                                      'macro_def) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      ((execute_macro (
                                         (Ast.StNil (_loc)) ) (
                                         fun a ->
                                          fun b ->
                                           (Ast.StSem (_loc, a, b)) ) x) :
                                        'str_item) )) ))] ))] ))) () ) ))
                        );
                        (
                        (Gram.extend ( (sig_item : 'sig_item Gram.t) ) (
                          ((fun ()
                              ->
                             (( (Some (`First)) ), (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (macro_def_sig :
                                         'macro_def_sig Gram.t) ))) )] ),
                                  (
                                  (Gram.mk_action (
                                    fun (x :
                                      'macro_def_sig) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      ((execute_macro (
                                         (Ast.SgNil (_loc)) ) (
                                         fun a ->
                                          fun b ->
                                           (Ast.SgSem (_loc, a, b)) ) x) :
                                        'sig_item) )) ))] ))] ))) () ) ))
                        );
                        (
                        (Gram.extend ( (macro_def : 'macro_def Gram.t) )
                          (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [( (Gram.Skeyword ("INCLUDE")) ); (
                                   (Gram.Stoken
                                     ((
                                      function
                                      | STRING (_, _) -> (true)
                                      | _ -> (false) ), "STRING (_, _)"))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (__camlp4_0 :
                                      Gram.token) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       (match __camlp4_0 with
                                        | STRING (_, fname) ->
                                           ((SdLazy
                                              (lazy (
                                                (parse_include_file
                                                  str_items fname) ))) :
                                             'macro_def)
                                        | _ -> assert false) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFNDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident_eval_ifndef :
                                         'uident_eval_ifndef Gram.t) )))
                                   ); ( (Gram.Skeyword ("THEN")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (smlist_then :
                                         'smlist_then Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (else_macro_def :
                                         'else_macro_def Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (st2 :
                                      'else_macro_def) ->
                                     fun (st1 :
                                       'smlist_then) ->
                                      fun _ ->
                                       fun _ ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          ((make_SdITE_result st1 st2) :
                                            'macro_def) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident_eval_ifdef :
                                         'uident_eval_ifdef Gram.t) )))
                                   ); ( (Gram.Skeyword ("THEN")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (smlist_then :
                                         'smlist_then Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (else_macro_def :
                                         'else_macro_def Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (st2 :
                                      'else_macro_def) ->
                                     fun (st1 :
                                       'smlist_then) ->
                                      fun _ ->
                                       fun _ ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          ((make_SdITE_result st1 st2) :
                                            'macro_def) )) ));
                                 ((
                                  [( (Gram.Skeyword ("UNDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (i :
                                      'uident) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((SdUnd (i)) : 'macro_def) )) ));
                                 ((
                                  [( (Gram.Skeyword ("DEFINE")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (opt_macro_value :
                                         'opt_macro_value Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (def :
                                      'opt_macro_value) ->
                                     fun (i :
                                       'uident) ->
                                      fun _ ->
                                       fun (_loc :
                                         FanLoc.t) ->
                                        ((SdDef (i, def)) : 'macro_def)
                                    )) ))] ))] ))) () ) ))
                        );
                        (
                        (Gram.extend (
                          (macro_def_sig : 'macro_def_sig Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [( (Gram.Skeyword ("INCLUDE")) ); (
                                   (Gram.Stoken
                                     ((
                                      function
                                      | STRING (_, _) -> (true)
                                      | _ -> (false) ), "STRING (_, _)"))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (__camlp4_0 :
                                      Gram.token) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       (match __camlp4_0 with
                                        | STRING (_, fname) ->
                                           ((SdLazy
                                              (lazy (
                                                (parse_include_file
                                                  sig_items fname) ))) :
                                             'macro_def_sig)
                                        | _ -> assert false) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFNDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident_eval_ifndef :
                                         'uident_eval_ifndef Gram.t) )))
                                   ); ( (Gram.Skeyword ("THEN")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (sglist_then :
                                         'sglist_then Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (else_macro_def_sig :
                                         'else_macro_def_sig Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (sg2 :
                                      'else_macro_def_sig) ->
                                     fun (sg1 :
                                       'sglist_then) ->
                                      fun _ ->
                                       fun _ ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          ((make_SdITE_result sg1 sg2) :
                                            'macro_def_sig) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident_eval_ifdef :
                                         'uident_eval_ifdef Gram.t) )))
                                   ); ( (Gram.Skeyword ("THEN")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (sglist_then :
                                         'sglist_then Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (else_macro_def_sig :
                                         'else_macro_def_sig Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (sg2 :
                                      'else_macro_def_sig) ->
                                     fun (sg1 :
                                       'sglist_then) ->
                                      fun _ ->
                                       fun _ ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          ((make_SdITE_result sg1 sg2) :
                                            'macro_def_sig) )) ));
                                 ((
                                  [( (Gram.Skeyword ("UNDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (i :
                                      'uident) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((SdUnd (i)) : 'macro_def_sig) ))
                                  ));
                                 ((
                                  [( (Gram.Skeyword ("DEFINE")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (i :
                                      'uident) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((SdDef (i, None )) :
                                         'macro_def_sig) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend (
                          (uident_eval_ifdef : 'uident_eval_ifdef Gram.t)
                          ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (i :
                                      'uident) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      ((Stack.push ( (is_defined i) )
                                         stack) : 'uident_eval_ifdef) ))
                                  ))] ))] ))) () ) ))
                        );
                        (
                        (Gram.extend (
                          (uident_eval_ifndef :
                            'uident_eval_ifndef Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (i :
                                      'uident) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      ((Stack.push (
                                         (not ( (is_defined i) )) )
                                         stack) : 'uident_eval_ifndef) ))
                                  ))] ))] ))) () ) ))
                        );
                        (
                        (Gram.extend (
                          (else_macro_def : 'else_macro_def Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (([]) : 'else_macro_def) )) ));
                                 ((
                                  [( (Gram.Skeyword ("ELSE")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (smlist_else :
                                         'smlist_else Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (st :
                                       'smlist_else) ->
                                      fun _ ->
                                       fun (_loc :
                                         FanLoc.t) ->
                                        (st : 'else_macro_def) )) ))] ))]
                              ))) () ) ))
                        );
                        (
                        (Gram.extend (
                          (else_macro_def_sig :
                            'else_macro_def_sig Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (([]) : 'else_macro_def_sig) )) ));
                                 ((
                                  [( (Gram.Skeyword ("ELSE")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (sglist_else :
                                         'sglist_else Gram.t) ))) ); (
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (st :
                                       'sglist_else) ->
                                      fun _ ->
                                       fun (_loc :
                                         FanLoc.t) ->
                                        (st : 'else_macro_def_sig) )) ))]
                                ))] ))) () ) ))
                        );
                        (
                        (Gram.extend ( (else_expr : 'else_expr Gram.t) )
                          (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      ((Ast.ExId
                                         (_loc, (
                                          (Ast.IdUid (_loc, "()")) ))) :
                                        'else_expr) )) ));
                                 ((
                                  [( (Gram.Skeyword ("ELSE")) ); (
                                   (Gram.Snterm
                                     (Gram.obj ( (expr : 'expr Gram.t) )))
                                   ); (
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (e :
                                       'expr) ->
                                      fun _ ->
                                       fun (_loc :
                                         FanLoc.t) ->
                                        (e : 'else_expr) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend (
                          (smlist_then : 'smlist_then Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Slist1
                                     (Gram.srules smlist_then (
                                       [((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (str_item :
                                                'str_item Gram.t) ))) );
                                          (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (si :
                                              'str_item) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((SdStr (si)) : 'e__7) ))
                                         ));
                                        ((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (macro_def :
                                                'macro_def Gram.t) ))) );
                                          (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (d :
                                              'macro_def) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((execute_macro_if_active_branch
                                                 _loc (
                                                 (Ast.StNil (_loc)) ) (
                                                 fun a ->
                                                  fun b ->
                                                   (Ast.StSem
                                                     (_loc, a, b)) ) Then 
                                                 d) : 'e__7) )) ))] )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (sml :
                                      'e__7 list) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (sml : 'smlist_then) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend (
                          (smlist_else : 'smlist_else Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Slist1
                                     (Gram.srules smlist_else (
                                       [((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (str_item :
                                                'str_item Gram.t) ))) );
                                          (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (si :
                                              'str_item) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((SdStr (si)) : 'e__8) ))
                                         ));
                                        ((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (macro_def :
                                                'macro_def Gram.t) ))) );
                                          (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (d :
                                              'macro_def) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((execute_macro_if_active_branch
                                                 _loc (
                                                 (Ast.StNil (_loc)) ) (
                                                 fun a ->
                                                  fun b ->
                                                   (Ast.StSem
                                                     (_loc, a, b)) ) Else 
                                                 d) : 'e__8) )) ))] )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (sml :
                                      'e__8 list) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (sml : 'smlist_else) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend (
                          (sglist_then : 'sglist_then Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Slist1
                                     (Gram.srules sglist_then (
                                       [((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (sig_item :
                                                'sig_item Gram.t) ))) );
                                          (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (si :
                                              'sig_item) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((SdStr (si)) : 'e__9) ))
                                         ));
                                        ((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (macro_def_sig :
                                                'macro_def_sig Gram.t) )))
                                          ); (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (d :
                                              'macro_def_sig) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((execute_macro_if_active_branch
                                                 _loc (
                                                 (Ast.SgNil (_loc)) ) (
                                                 fun a ->
                                                  fun b ->
                                                   (Ast.SgSem
                                                     (_loc, a, b)) ) Then 
                                                 d) : 'e__9) )) ))] )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (sgl :
                                      'e__9 list) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (sgl : 'sglist_then) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend (
                          (sglist_else : 'sglist_else Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Slist1
                                     (Gram.srules sglist_else (
                                       [((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (sig_item :
                                                'sig_item Gram.t) ))) );
                                          (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (si :
                                              'sig_item) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((SdStr (si)) : 'e__10) ))
                                         ));
                                        ((
                                         [(
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (macro_def_sig :
                                                'macro_def_sig Gram.t) )))
                                          ); (
                                          (Gram.Snterm
                                            (Gram.obj (
                                              (semi : 'semi Gram.t) )))
                                          )] ), (
                                         (Gram.mk_action (
                                           fun _ ->
                                            fun (d :
                                              'macro_def_sig) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              ((execute_macro_if_active_branch
                                                 _loc (
                                                 (Ast.SgNil (_loc)) ) (
                                                 fun a ->
                                                  fun b ->
                                                   (Ast.SgSem
                                                     (_loc, a, b)) ) Else 
                                                 d) : 'e__10) )) ))] )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (sgl :
                                      'e__10 list) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (sgl : 'sglist_else) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend ( (endif : 'endif Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [(( [( (Gram.Skeyword ("ENDIF")) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (() : 'endif) )) ));
                                 (( [( (Gram.Skeyword ("END")) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (() : 'endif) )) ))] ))] ))) () )
                          ))
                        );
                        (
                        (Gram.extend (
                          (opt_macro_value : 'opt_macro_value Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [([] , (
                                  (Gram.mk_action (
                                    fun (_loc :
                                      FanLoc.t) ->
                                     ((None) : 'opt_macro_value) )) ));
                                 ((
                                  [( (Gram.Skeyword ("=")) ); (
                                   (Gram.Snterm
                                     (Gram.obj ( (expr : 'expr Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (e :
                                      'expr) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((Some ([] , e)) :
                                         'opt_macro_value) )) ));
                                 ((
                                  [( (Gram.Skeyword ("(")) ); (
                                   (Gram.Slist1sep
                                     ((
                                      (Gram.srules opt_macro_value (
                                        [((
                                          [(
                                           (Gram.Stoken
                                             ((
                                              function
                                              | LIDENT (_) -> (true)
                                              | _ -> (false) ),
                                              "LIDENT (_)")) )] ), (
                                          (Gram.mk_action (
                                            fun (__camlp4_0 :
                                              Gram.token) ->
                                             fun (_loc :
                                               FanLoc.t) ->
                                              (match __camlp4_0 with
                                               | LIDENT (x) ->
                                                  (x : 'e__11)
                                               | _ -> assert false) )) ))]
                                        )) ), ( (Gram.Skeyword (",")) )))
                                   ); ( (Gram.Skeyword (")")) ); (
                                   (Gram.Skeyword ("=")) ); (
                                   (Gram.Snterm
                                     (Gram.obj ( (expr : 'expr Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (e :
                                      'expr) ->
                                     fun _ ->
                                      fun _ ->
                                       fun (pl :
                                         'e__11 list) ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          ((Some (pl, e)) :
                                            'opt_macro_value) )) ))] ))]
                              ))) () ) ))
                        );
                        (
                        (Gram.extend ( (expr : 'expr Gram.t) ) (
                          ((fun ()
                              ->
                             (( (Some (`Level "top")) ), (
                              [(None , None , (
                                [((
                                  [( (Gram.Skeyword ("DEFINE")) ); (
                                   (Gram.Stoken
                                     ((
                                      function
                                      | LIDENT (_) -> (true)
                                      | _ -> (false) ), "LIDENT (_)")) );
                                   ( (Gram.Skeyword ("=")) ); Gram.Sself
                                   ; ( (Gram.Skeyword ("IN")) );
                                   Gram.Sself ] ), (
                                  (Gram.mk_action (
                                    fun (body :
                                      'expr) ->
                                     fun _ ->
                                      fun (def :
                                        'expr) ->
                                       fun _ ->
                                        fun (__camlp4_0 :
                                          Gram.token) ->
                                         fun _ ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           (match __camlp4_0 with
                                            | LIDENT (i) ->
                                               (((((new Expr.subst) _loc
                                                    ( [(i, def)] ))#expr)
                                                  body) : 'expr)
                                            | _ -> assert false) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFNDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) ); (
                                   (Gram.Skeyword ("THEN")) ); Gram.Sself
                                   ; (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (else_expr : 'else_expr Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (e2 :
                                      'else_expr) ->
                                     fun (e1 :
                                       'expr) ->
                                      fun _ ->
                                       fun (i :
                                         'uident) ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          (if (is_defined i) then e2
                                           else e1 : 'expr) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) ); (
                                   (Gram.Skeyword ("THEN")) ); Gram.Sself
                                   ; (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (else_expr : 'else_expr Gram.t) )))
                                   )] ), (
                                  (Gram.mk_action (
                                    fun (e2 :
                                      'else_expr) ->
                                     fun (e1 :
                                       'expr) ->
                                      fun _ ->
                                       fun (i :
                                         'uident) ->
                                        fun _ ->
                                         fun (_loc :
                                           FanLoc.t) ->
                                          (if (is_defined i) then e1
                                           else e2 : 'expr) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend ( (patt : 'patt Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [( (Gram.Skeyword ("IFNDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) ); (
                                   (Gram.Skeyword ("THEN")) ); Gram.Sself
                                   ; ( (Gram.Skeyword ("ELSE")) );
                                   Gram.Sself ; (
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (p2 :
                                       'patt) ->
                                      fun _ ->
                                       fun (p1 :
                                         'patt) ->
                                        fun _ ->
                                         fun (i :
                                           'uident) ->
                                          fun _ ->
                                           fun (_loc :
                                             FanLoc.t) ->
                                            (if (is_defined i) then p2
                                             else p1 : 'patt) )) ));
                                 ((
                                  [( (Gram.Skeyword ("IFDEF")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (uident : 'uident Gram.t) ))) ); (
                                   (Gram.Skeyword ("THEN")) ); Gram.Sself
                                   ; ( (Gram.Skeyword ("ELSE")) );
                                   Gram.Sself ; (
                                   (Gram.Snterm
                                     (Gram.obj ( (endif : 'endif Gram.t)
                                       ))) )] ), (
                                  (Gram.mk_action (
                                    fun _ ->
                                     fun (p2 :
                                       'patt) ->
                                      fun _ ->
                                       fun (p1 :
                                         'patt) ->
                                        fun _ ->
                                         fun (i :
                                           'uident) ->
                                          fun _ ->
                                           fun (_loc :
                                             FanLoc.t) ->
                                            (if (is_defined i) then p1
                                             else p2 : 'patt) )) ))] ))]
                              ))) () ) ))
                        );
                        (
                        (Gram.extend ( (uident : 'uident Gram.t) ) (
                          ((fun ()
                              ->
                             (None , (
                              [(None , None , (
                                [((
                                  [(
                                   (Gram.Stoken
                                     ((
                                      function
                                      | UIDENT (_) -> (true)
                                      | _ -> (false) ), "UIDENT (_)")) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (__camlp4_0 :
                                      Gram.token) ->
                                     fun (_loc :
                                       FanLoc.t) ->
                                      (match __camlp4_0 with
                                       | UIDENT (i) -> (i : 'uident)
                                       | _ -> assert false) )) ))] ))] )))
                            () ) ))
                        );
                        (
                        (Gram.extend ( (expr : 'expr Gram.t) ) (
                          ((fun ()
                              ->
                             (( (Some (`Before "simple")) ), (
                              [(None , None , (
                                [((
                                  [( (Gram.Skeyword ("`")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (a_ident : 'a_ident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (s :
                                      'a_ident) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((Ast.ExVrn (_loc, s)) : 'expr) ))
                                  ));
                                 ((
                                  [( (Gram.Skeyword ("`")) ); (
                                   (Gram.srules expr (
                                     [(( [( (Gram.Skeyword ("IN")) )] ),
                                       (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("DEFINE")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("ENDIF")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("END")) )] ),
                                       (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("ELSE")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("THEN")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("IFNDEF")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ));
                                      (( [( (Gram.Skeyword ("IFDEF")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__12) )) ))] )) )] ), (
                                  (Gram.mk_action (
                                    fun (kwd :
                                      'e__12) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((Ast.ExVrn (_loc, kwd)) : 'expr)
                                    )) ))] ))] ))) () ) ))
                        );
                        (Gram.extend ( (patt : 'patt Gram.t) ) (
                          ((fun ()
                              ->
                             (( (Some (`Before "simple")) ), (
                              [(None , None , (
                                [((
                                  [( (Gram.Skeyword ("`")) ); (
                                   (Gram.Snterm
                                     (Gram.obj (
                                       (a_ident : 'a_ident Gram.t) ))) )]
                                  ), (
                                  (Gram.mk_action (
                                    fun (s :
                                      'a_ident) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((Ast.PaVrn (_loc, s)) : 'patt) ))
                                  ));
                                 ((
                                  [( (Gram.Skeyword ("`")) ); (
                                   (Gram.srules patt (
                                     [(( [( (Gram.Skeyword ("ENDIF")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__13) )) ));
                                      (( [( (Gram.Skeyword ("END")) )] ),
                                       (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__13) )) ));
                                      (( [( (Gram.Skeyword ("ELSE")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__13) )) ));
                                      (( [( (Gram.Skeyword ("THEN")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__13) )) ));
                                      (( [( (Gram.Skeyword ("IFNDEF")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__13) )) ));
                                      (( [( (Gram.Skeyword ("IFDEF")) )]
                                       ), (
                                       (Gram.mk_action (
                                         fun (x :
                                           Gram.token) ->
                                          fun (_loc :
                                            FanLoc.t) ->
                                           ((Gram.string_of_token x) :
                                             'e__13) )) ))] )) )] ), (
                                  (Gram.mk_action (
                                    fun (kwd :
                                      'e__13) ->
                                     fun _ ->
                                      fun (_loc :
                                        FanLoc.t) ->
                                       ((Ast.PaVrn (_loc, kwd)) : 'patt)
                                    )) ))] ))] ))) () ) ))

                let _ = (Options.add "-D" ( (Arg.String (parse_def)) )
                          "<string> Define for IFDEF instruction.")

                let _ = (Options.add "-U" ( (Arg.String (undef)) )
                          "<string> Undefine for IFDEF instruction.")

                let _ = (Options.add "-I" (
                          (Arg.String (add_include_dir)) )
                          "<string> Add a directory to INCLUDE search path.")

               end

module MakeNothing =
                     functor (Syn : Sig.Camlp4Syntax) ->
                      struct
                       module Ast = Camlp4Ast

                       let _ = (Syn.AstFilters.register_str_item_filter (
                                 ((Ast.map_expr Expr.map_expr)#str_item)
                                 ))

                      end

module IdRevisedParser =
                            struct
                             let name = "Camlp4OCamlRevisedParser"

                             let version = Sys.ocaml_version

                            end

module MakeRevisedParser =
                                  functor (Syntax : Sig.Camlp4Syntax) ->
                                   struct
                                    open FanSig

                                    include Syntax

                                    module Ast = Camlp4Ast

                                    let _ = (FanConfig.constructors_arity
                                              := false )

                                    let help_sequences =
                                     fun ()
                                       ->
                                      (
                                      (Printf.eprintf
                                        "New syntax:\n    (e1; e2; ... ; en) OR begin e1; e2; ... ; en end\n    while e do e1; e2; ... ; en done\n    for v = v1 to/downto v2 do e1; e2; ... ; en done\nOld syntax (still supported):\n    do {e1; e2; ... ; en}\n    while e do {e1; e2; ... ; en}\n    for v = v1 to/downto v2 do {e1; e2; ... ; en}\nVery old (no more supported) syntax:\n    do e1; e2; ... ; en-1; return en\n    while e do e1; e2; ... ; en; done\n    for v = v1 to/downto v2 do e1; e2; ... ; en; done\n")
                                      );
                                      (
                                      (flush stderr)
                                      );
                                      (exit 1)

                                    let _ = (Options.add "-help_seq" (
                                              (Arg.Unit (help_sequences))
                                              )
                                              "Print explanations about new sequences and exit.")

                                    let _ = (Gram.clear a_CHAR)

                                    let _ = (Gram.clear a_FLOAT)

                                    let _ = (Gram.clear a_INT)

                                    let _ = (Gram.clear a_INT32)

                                    let _ = (Gram.clear a_INT64)

                                    let _ = (Gram.clear a_LABEL)

                                    let _ = (Gram.clear a_LIDENT)

                                    let _ = (Gram.clear a_NATIVEINT)

                                    let _ = (Gram.clear a_OPTLABEL)

                                    let _ = (Gram.clear a_STRING)

                                    let _ = (Gram.clear a_UIDENT)

                                    let _ = (Gram.clear a_ident)

                                    let _ = (Gram.clear amp_ctyp)

                                    let _ = (Gram.clear and_ctyp)

                                    let _ = (Gram.clear match_case)

                                    let _ = (Gram.clear match_case0)

                                    let _ = (Gram.clear match_case_quot)

                                    let _ = (Gram.clear binding)

                                    let _ = (Gram.clear binding_quot)

                                    let _ = (Gram.clear rec_binding_quot)

                                    let _ = (Gram.clear
                                              class_declaration)

                                    let _ = (Gram.clear
                                              class_description)

                                    let _ = (Gram.clear class_expr)

                                    let _ = (Gram.clear class_expr_quot)

                                    let _ = (Gram.clear
                                              class_fun_binding)

                                    let _ = (Gram.clear class_fun_def)

                                    let _ = (Gram.clear
                                              class_info_for_class_expr)

                                    let _ = (Gram.clear
                                              class_info_for_class_type)

                                    let _ = (Gram.clear class_longident)

                                    let _ = (Gram.clear
                                              class_longident_and_param)

                                    let _ = (Gram.clear
                                              class_name_and_param)

                                    let _ = (Gram.clear class_sig_item)

                                    let _ = (Gram.clear
                                              class_sig_item_quot)

                                    let _ = (Gram.clear class_signature)

                                    let _ = (Gram.clear class_str_item)

                                    let _ = (Gram.clear
                                              class_str_item_quot)

                                    let _ = (Gram.clear class_structure)

                                    let _ = (Gram.clear class_type)

                                    let _ = (Gram.clear
                                              class_type_declaration)

                                    let _ = (Gram.clear
                                              class_type_longident)

                                    let _ = (Gram.clear
                                              class_type_longident_and_param)

                                    let _ = (Gram.clear class_type_plus)

                                    let _ = (Gram.clear class_type_quot)

                                    let _ = (Gram.clear comma_ctyp)

                                    let _ = (Gram.clear comma_expr)

                                    let _ = (Gram.clear comma_ipatt)

                                    let _ = (Gram.clear comma_patt)

                                    let _ = (Gram.clear
                                              comma_type_parameter)

                                    let _ = (Gram.clear constrain)

                                    let _ = (Gram.clear
                                              constructor_arg_list)

                                    let _ = (Gram.clear
                                              constructor_declaration)

                                    let _ = (Gram.clear
                                              constructor_declarations)

                                    let _ = (Gram.clear ctyp)

                                    let _ = (Gram.clear ctyp_quot)

                                    let _ = (Gram.clear cvalue_binding)

                                    let _ = (Gram.clear direction_flag)

                                    let _ = (Gram.clear dummy)

                                    let _ = (Gram.clear eq_expr)

                                    let _ = (Gram.clear expr)

                                    let _ = (Gram.clear expr_eoi)

                                    let _ = (Gram.clear expr_quot)

                                    let _ = (Gram.clear field_expr)

                                    let _ = (Gram.clear field_expr_list)

                                    let _ = (Gram.clear fun_binding)

                                    let _ = (Gram.clear fun_def)

                                    let _ = (Gram.clear ident)

                                    let _ = (Gram.clear ident_quot)

                                    let _ = (Gram.clear implem)

                                    let _ = (Gram.clear interf)

                                    let _ = (Gram.clear ipatt)

                                    let _ = (Gram.clear ipatt_tcon)

                                    let _ = (Gram.clear label)

                                    let _ = (Gram.clear
                                              label_declaration)

                                    let _ = (Gram.clear
                                              label_declaration_list)

                                    let _ = (Gram.clear label_expr_list)

                                    let _ = (Gram.clear label_expr)

                                    let _ = (Gram.clear label_ipatt)

                                    let _ = (Gram.clear label_ipatt_list)

                                    let _ = (Gram.clear label_longident)

                                    let _ = (Gram.clear label_patt)

                                    let _ = (Gram.clear label_patt_list)

                                    let _ = (Gram.clear labeled_ipatt)

                                    let _ = (Gram.clear let_binding)

                                    let _ = (Gram.clear meth_list)

                                    let _ = (Gram.clear meth_decl)

                                    let _ = (Gram.clear module_binding)

                                    let _ = (Gram.clear module_binding0)

                                    let _ = (Gram.clear
                                              module_binding_quot)

                                    let _ = (Gram.clear
                                              module_declaration)

                                    let _ = (Gram.clear module_expr)

                                    let _ = (Gram.clear module_expr_quot)

                                    let _ = (Gram.clear module_longident)

                                    let _ = (Gram.clear
                                              module_longident_with_app)

                                    let _ = (Gram.clear
                                              module_rec_declaration)

                                    let _ = (Gram.clear module_type)

                                    let _ = (Gram.clear module_type_quot)

                                    let _ = (Gram.clear more_ctyp)

                                    let _ = (Gram.clear name_tags)

                                    let _ = (Gram.clear opt_as_lident)

                                    let _ = (Gram.clear
                                              opt_class_self_patt)

                                    let _ = (Gram.clear
                                              opt_class_self_type)

                                    let _ = (Gram.clear opt_comma_ctyp)

                                    let _ = (Gram.clear opt_dot_dot)

                                    let _ = (Gram.clear opt_eq_ctyp)

                                    let _ = (Gram.clear opt_expr)

                                    let _ = (Gram.clear opt_meth_list)

                                    let _ = (Gram.clear opt_mutable)

                                    let _ = (Gram.clear opt_polyt)

                                    let _ = (Gram.clear opt_private)

                                    let _ = (Gram.clear opt_rec)

                                    let _ = (Gram.clear opt_virtual)

                                    let _ = (Gram.clear opt_when_expr)

                                    let _ = (Gram.clear patt)

                                    let _ = (Gram.clear patt_as_patt_opt)

                                    let _ = (Gram.clear patt_eoi)

                                    let _ = (Gram.clear patt_quot)

                                    let _ = (Gram.clear patt_tcon)

                                    let _ = (Gram.clear phrase)

                                    let _ = (Gram.clear poly_type)

                                    let _ = (Gram.clear row_field)

                                    let _ = (Gram.clear sem_expr)

                                    let _ = (Gram.clear
                                              sem_expr_for_list)

                                    let _ = (Gram.clear sem_patt)

                                    let _ = (Gram.clear
                                              sem_patt_for_list)

                                    let _ = (Gram.clear semi)

                                    let _ = (Gram.clear sequence)

                                    let _ = (Gram.clear sig_item)

                                    let _ = (Gram.clear sig_item_quot)

                                    let _ = (Gram.clear sig_items)

                                    let _ = (Gram.clear star_ctyp)

                                    let _ = (Gram.clear str_item)

                                    let _ = (Gram.clear str_item_quot)

                                    let _ = (Gram.clear str_items)

                                    let _ = (Gram.clear top_phrase)

                                    let _ = (Gram.clear type_constraint)

                                    let _ = (Gram.clear type_declaration)

                                    let _ = (Gram.clear
                                              type_ident_and_parameters)

                                    let _ = (Gram.clear type_kind)

                                    let _ = (Gram.clear type_longident)

                                    let _ = (Gram.clear
                                              type_longident_and_parameters)

                                    let _ = (Gram.clear type_parameter)

                                    let _ = (Gram.clear type_parameters)

                                    let _ = (Gram.clear typevars)

                                    let _ = (Gram.clear use_file)

                                    let _ = (Gram.clear val_longident)

                                    let _ = (Gram.clear with_constr)

                                    let _ = (Gram.clear with_constr_quot)

                                    let setup_op_parser =
                                     fun entry ->
                                      fun p ->
                                       (Gram.setup_parser entry (
                                         fun (__strm :
                                           _ Stream.t) ->
                                          (match
                                             (Stream.peek __strm) with
                                           | Some
                                              ((KEYWORD (x) | SYMBOL (x)),
                                               ti) when (p x) ->
                                              (
                                              (Stream.junk __strm)
                                              );
                                              let _loc =
                                               (Gram.token_location ti) in
                                              (Ast.ExId
                                                (_loc, (
                                                 (Ast.IdLid (_loc, x)) )))
                                           | _ -> (raise Stream.Failure ))
                                         ))

                                    let _ = let list = ['!'; '?'; '~'] in
                                            let excl = ["!="; "??"] in
                                            (setup_op_parser prefixop (
                                              fun x ->
                                               ((
                                                 (not ( (List.mem x excl)
                                                   )) ) && (
                                                 ((
                                                   (( (String.length x) )
                                                     >= 2) ) && (
                                                   ((
                                                     (List.mem (
                                                       (String.get x 0) )
                                                       list) ) && (
                                                     (symbolchar x 1) ))
                                                   )) )) ))

                                    let _ = let list_ok =
                                             ["<"; ">"; "<="; ">="; "=";
                                              "<>"; "=="; "!="; "$"] in
                                            let list_first_char_ok =
                                             ['='; '<'; '>'; '|'; '&';
                                              '$'; '!'] in
                                            let excl = ["<-"; "||"; "&&"] in
                                            (setup_op_parser infixop0 (
                                              fun x ->
                                               (( (List.mem x list_ok) )
                                                 || (
                                                 ((
                                                   (not (
                                                     (List.mem x excl) ))
                                                   ) && (
                                                   ((
                                                     (( (String.length x)
                                                       ) >= 2) ) && (
                                                     ((
                                                       (List.mem (
                                                         (String.get x 0)
                                                         )
                                                         list_first_char_ok)
                                                       ) && (
                                                       (symbolchar x 1)
                                                       )) )) )) )) ))

                                    let _ = let list = ['@'; '^'] in
                                            (setup_op_parser infixop1 (
                                              fun x ->
                                               ((
                                                 (( (String.length x) )
                                                   >= 1) ) && (
                                                 ((
                                                   (List.mem (
                                                     (String.get x 0) )
                                                     list) ) && (
                                                   (symbolchar x 1) )) ))
                                              ))

                                    let _ = let list = ['+'; '-'] in
                                            (setup_op_parser infixop2 (
                                              fun x ->
                                               (( (x <> "->") ) && (
                                                 ((
                                                   (( (String.length x) )
                                                     >= 1) ) && (
                                                   ((
                                                     (List.mem (
                                                       (String.get x 0) )
                                                       list) ) && (
                                                     (symbolchar x 1) ))
                                                   )) )) ))

                                    let _ = let list =
                                             ['*'; '/'; '%'; '\\'] in
                                            (setup_op_parser infixop3 (
                                              fun x ->
                                               ((
                                                 (( (String.length x) )
                                                   >= 1) ) && (
                                                 ((
                                                   (List.mem (
                                                     (String.get x 0) )
                                                     list) ) && (
                                                   ((
                                                     ((
                                                       ((
                                                         (String.get x 0)
                                                         ) <> '*') ) || (
                                                       ((
                                                         ((
                                                           (String.length
                                                             x) ) < 2) )
                                                         || (
                                                         ((
                                                           (String.get x
                                                             1) ) <> '*')
                                                         )) )) ) && (
                                                     (symbolchar x 1) ))
                                                   )) )) ))

                                    let _ = (setup_op_parser infixop4 (
                                              fun x ->
                                               ((
                                                 (( (String.length x) )
                                                   >= 2) ) && (
                                                 ((
                                                   (( (String.get x 0) )
                                                     == '*') ) && (
                                                   ((
                                                     (( (String.get x 1)
                                                       ) == '*') ) && (
                                                     (symbolchar x 2) ))
                                                   )) )) ))

                                    let rec infix_kwds_filter =
                                     fun (__strm :
                                       _ Stream.t) ->
                                      (match (Stream.peek __strm) with
                                       | Some ((KEYWORD ("("), _) as tok) ->
                                          (
                                          (Stream.junk __strm)
                                          );
                                          let xs = __strm in
                                          let (__strm : _ Stream.t) = xs in
                                          (match
                                             (Stream.peek __strm) with
                                           | Some
                                              (KEYWORD
                                                (((((((("or" | "mod")
                                                       | "land") | "lor")
                                                     | "lxor") | "lsl")
                                                   | "lsr") | "asr") as
                                                 i), _loc) ->
                                              (
                                              (Stream.junk __strm)
                                              );
                                              (match
                                                 (Stream.peek __strm) with
                                               | Some (KEYWORD (")"), _) ->
                                                  (
                                                  (Stream.junk __strm)
                                                  );
                                                  let xs = __strm in
                                                  (Stream.lcons (
                                                    fun _ ->
                                                     (( (LIDENT (i)) ),
                                                      _loc) ) (
                                                    (Stream.slazy (
                                                      fun _ ->
                                                       (infix_kwds_filter
                                                         xs) )) ))
                                               | _ ->
                                                  (raise (
                                                    (Stream.Error (""))
                                                    )))
                                           | _ ->
                                              let xs = __strm in
                                              (Stream.icons tok (
                                                (Stream.slazy (
                                                  fun _ ->
                                                   (infix_kwds_filter xs)
                                                  )) )))
                                       | Some (x) ->
                                          (
                                          (Stream.junk __strm)
                                          );
                                          let xs = __strm in
                                          (Stream.icons x (
                                            (Stream.slazy (
                                              fun _ ->
                                               (infix_kwds_filter xs) ))
                                            ))
                                       | _ -> (raise Stream.Failure ))

                                    let _ = (Token.Filter.define_filter (
                                              (Gram.get_filter () ) ) (
                                              fun f ->
                                               fun strm ->
                                                (infix_kwds_filter (
                                                  (f strm) )) ))

                                    let _ = (Gram.setup_parser sem_expr (
                                              let symb1 =
                                               (Gram.parse_origin_tokens
                                                 expr) in
                                              let symb =
                                               fun (__strm :
                                                 _ Stream.t) ->
                                                (match
                                                   (Stream.peek __strm) with
                                                 | Some
                                                    (ANTIQUOT
                                                      (("list" as n), s),
                                                     ti) ->
                                                    (
                                                    (Stream.junk __strm)
                                                    );
                                                    let _loc =
                                                     (Gram.token_location
                                                       ti) in
                                                    (Ast.ExAnt
                                                      (_loc, (
                                                       (mk_anti
                                                         ~c:"expr;" n s)
                                                       )))
                                                 | _ -> (symb1 __strm)) in
                                              let rec kont =
                                               fun al ->
                                                fun (__strm :
                                                  _ Stream.t) ->
                                                 (match
                                                    (Stream.peek __strm) with
                                                  | Some
                                                     (KEYWORD (";"), _) ->
                                                     (
                                                     (Stream.junk __strm)
                                                     );
                                                     let a =
                                                      (try
                                                        (symb __strm)
                                                       with
                                                       Stream.Failure ->
                                                        (raise (
                                                          (Stream.Error
                                                            ("")) ))) in
                                                     let s = __strm in
                                                     let _loc =
                                                      (FanLoc.merge (
                                                        (Ast.loc_of_expr
                                                          al) ) (
                                                        (Ast.loc_of_expr
                                                          a) )) in
                                                     (kont (
                                                       (Ast.ExSem
                                                         (_loc, al, a)) )
                                                       s)
                                                  | _ -> al) in
                                              fun (__strm :
                                                _ Stream.t) ->
                                               let a = (symb __strm) in
                                               (kont a __strm) ))

                                    let _ = let _ =
                                             (a_CHAR : 'a_CHAR Gram.t)
                                            and _ =
                                             (override_flag_quot :
                                               'override_flag_quot Gram.t)
                                            and _ =
                                             (row_var_flag_quot :
                                               'row_var_flag_quot Gram.t)
                                            and _ =
                                             (virtual_flag_quot :
                                               'virtual_flag_quot Gram.t)
                                            and _ =
                                             (private_flag_quot :
                                               'private_flag_quot Gram.t)
                                            and _ =
                                             (mutable_flag_quot :
                                               'mutable_flag_quot Gram.t)
                                            and _ =
                                             (direction_flag_quot :
                                               'direction_flag_quot Gram.t)
                                            and _ =
                                             (rec_flag_quot :
                                               'rec_flag_quot Gram.t)
                                            and _ =
                                             (package_type :
                                               'package_type Gram.t)
                                            and _ =
                                             (do_sequence :
                                               'do_sequence Gram.t)
                                            and _ =
                                             (infixop4 :
                                               'infixop4 Gram.t)
                                            and _ =
                                             (infixop3 :
                                               'infixop3 Gram.t)
                                            and _ =
                                             (infixop2 :
                                               'infixop2 Gram.t)
                                            and _ =
                                             (infixop1 :
                                               'infixop1 Gram.t)
                                            and _ =
                                             (infixop0 :
                                               'infixop0 Gram.t)
                                            and _ =
                                             (with_constr_quot :
                                               'with_constr_quot Gram.t)
                                            and _ =
                                             (with_constr :
                                               'with_constr Gram.t)
                                            and _ =
                                             (val_longident :
                                               'val_longident Gram.t)
                                            and _ =
                                             (use_file :
                                               'use_file Gram.t)
                                            and _ =
                                             (typevars :
                                               'typevars Gram.t)
                                            and _ =
                                             (type_parameters :
                                               'type_parameters Gram.t)
                                            and _ =
                                             (type_parameter :
                                               'type_parameter Gram.t)
                                            and _ =
                                             (type_longident_and_parameters :
                                               'type_longident_and_parameters Gram.t)
                                            and _ =
                                             (type_longident :
                                               'type_longident Gram.t)
                                            and _ =
                                             (type_kind :
                                               'type_kind Gram.t)
                                            and _ =
                                             (type_ident_and_parameters :
                                               'type_ident_and_parameters Gram.t)
                                            and _ =
                                             (type_declaration :
                                               'type_declaration Gram.t)
                                            and _ =
                                             (type_constraint :
                                               'type_constraint Gram.t)
                                            and _ =
                                             (top_phrase :
                                               'top_phrase Gram.t)
                                            and _ =
                                             (str_items :
                                               'str_items Gram.t)
                                            and _ =
                                             (str_item_quot :
                                               'str_item_quot Gram.t)
                                            and _ =
                                             (str_item :
                                               'str_item Gram.t)
                                            and _ =
                                             (star_ctyp :
                                               'star_ctyp Gram.t)
                                            and _ =
                                             (sig_items :
                                               'sig_items Gram.t)
                                            and _ =
                                             (sig_item_quot :
                                               'sig_item_quot Gram.t)
                                            and _ =
                                             (sig_item :
                                               'sig_item Gram.t)
                                            and _ =
                                             (sequence :
                                               'sequence Gram.t)
                                            and _ = (semi : 'semi Gram.t)
                                            and _ =
                                             (sem_patt_for_list :
                                               'sem_patt_for_list Gram.t)
                                            and _ =
                                             (sem_patt :
                                               'sem_patt Gram.t)
                                            and _ =
                                             (sem_expr_for_list :
                                               'sem_expr_for_list Gram.t)
                                            and _ =
                                             (sem_expr :
                                               'sem_expr Gram.t)
                                            and _ =
                                             (row_field :
                                               'row_field Gram.t)
                                            and _ =
                                             (poly_type :
                                               'poly_type Gram.t)
                                            and _ =
                                             (phrase : 'phrase Gram.t)
                                            and _ =
                                             (patt_tcon :
                                               'patt_tcon Gram.t)
                                            and _ =
                                             (patt_quot :
                                               'patt_quot Gram.t)
                                            and _ =
                                             (patt_eoi :
                                               'patt_eoi Gram.t)
                                            and _ =
                                             (patt_as_patt_opt :
                                               'patt_as_patt_opt Gram.t)
                                            and _ = (patt : 'patt Gram.t)
                                            and _ =
                                             (opt_when_expr :
                                               'opt_when_expr Gram.t)
                                            and _ =
                                             (opt_virtual :
                                               'opt_virtual Gram.t)
                                            and _ =
                                             (opt_rec : 'opt_rec Gram.t)
                                            and _ =
                                             (opt_private :
                                               'opt_private Gram.t)
                                            and _ =
                                             (opt_polyt :
                                               'opt_polyt Gram.t)
                                            and _ =
                                             (opt_mutable :
                                               'opt_mutable Gram.t)
                                            and _ =
                                             (opt_meth_list :
                                               'opt_meth_list Gram.t)
                                            and _ =
                                             (opt_expr :
                                               'opt_expr Gram.t)
                                            and _ =
                                             (opt_eq_ctyp :
                                               'opt_eq_ctyp Gram.t)
                                            and _ =
                                             (opt_dot_dot :
                                               'opt_dot_dot Gram.t)
                                            and _ =
                                             (opt_comma_ctyp :
                                               'opt_comma_ctyp Gram.t)
                                            and _ =
                                             (opt_class_self_type :
                                               'opt_class_self_type Gram.t)
                                            and _ =
                                             (opt_class_self_patt :
                                               'opt_class_self_patt Gram.t)
                                            and _ =
                                             (opt_as_lident :
                                               'opt_as_lident Gram.t)
                                            and _ =
                                             (name_tags :
                                               'name_tags Gram.t)
                                            and _ =
                                             (more_ctyp :
                                               'more_ctyp Gram.t)
                                            and _ =
                                             (module_type_quot :
                                               'module_type_quot Gram.t)
                                            and _ =
                                             (module_type :
                                               'module_type Gram.t)
                                            and _ =
                                             (module_rec_declaration :
                                               'module_rec_declaration Gram.t)
                                            and _ =
                                             (module_longident_with_app :
                                               'module_longident_with_app Gram.t)
                                            and _ =
                                             (module_longident :
                                               'module_longident Gram.t)
                                            and _ =
                                             (module_expr_quot :
                                               'module_expr_quot Gram.t)
                                            and _ =
                                             (module_expr :
                                               'module_expr Gram.t)
                                            and _ =
                                             (module_declaration :
                                               'module_declaration Gram.t)
                                            and _ =
                                             (module_binding_quot :
                                               'module_binding_quot Gram.t)
                                            and _ =
                                             (module_binding0 :
                                               'module_binding0 Gram.t)
                                            and _ =
                                             (module_binding :
                                               'module_binding Gram.t)
                                            and _ =
                                             (meth_decl :
                                               'meth_decl Gram.t)
                                            and _ =
                                             (meth_list :
                                               'meth_list Gram.t)
                                            and _ =
                                             (let_binding :
                                               'let_binding Gram.t)
                                            and _ =
                                             (labeled_ipatt :
                                               'labeled_ipatt Gram.t)
                                            and _ =
                                             (label_patt_list :
                                               'label_patt_list Gram.t)
                                            and _ =
                                             (label_patt :
                                               'label_patt Gram.t)
                                            and _ =
                                             (label_longident :
                                               'label_longident Gram.t)
                                            and _ =
                                             (label_ipatt_list :
                                               'label_ipatt_list Gram.t)
                                            and _ =
                                             (label_ipatt :
                                               'label_ipatt Gram.t)
                                            and _ =
                                             (label_expr_list :
                                               'label_expr_list Gram.t)
                                            and _ =
                                             (label_expr :
                                               'label_expr Gram.t)
                                            and _ =
                                             (label_declaration_list :
                                               'label_declaration_list Gram.t)
                                            and _ =
                                             (label_declaration :
                                               'label_declaration Gram.t)
                                            and _ =
                                             (label : 'label Gram.t)
                                            and _ =
                                             (ipatt_tcon :
                                               'ipatt_tcon Gram.t)
                                            and _ =
                                             (ipatt : 'ipatt Gram.t)
                                            and _ =
                                             (interf : 'interf Gram.t)
                                            and _ =
                                             (implem : 'implem Gram.t)
                                            and _ =
                                             (ident_quot :
                                               'ident_quot Gram.t)
                                            and _ =
                                             (ident : 'ident Gram.t)
                                            and _ =
                                             (fun_def : 'fun_def Gram.t)
                                            and _ =
                                             (fun_binding :
                                               'fun_binding Gram.t)
                                            and _ =
                                             (field_expr_list :
                                               'field_expr_list Gram.t)
                                            and _ =
                                             (field_expr :
                                               'field_expr Gram.t)
                                            and _ =
                                             (expr_quot :
                                               'expr_quot Gram.t)
                                            and _ =
                                             (expr_eoi :
                                               'expr_eoi Gram.t)
                                            and _ = (expr : 'expr Gram.t)
                                            and _ =
                                             (eq_expr : 'eq_expr Gram.t)
                                            and _ =
                                             (dummy : 'dummy Gram.t)
                                            and _ =
                                             (direction_flag :
                                               'direction_flag Gram.t)
                                            and _ =
                                             (cvalue_binding :
                                               'cvalue_binding Gram.t)
                                            and _ =
                                             (ctyp_quot :
                                               'ctyp_quot Gram.t)
                                            and _ = (ctyp : 'ctyp Gram.t)
                                            and _ =
                                             (constructor_declarations :
                                               'constructor_declarations Gram.t)
                                            and _ =
                                             (constructor_declaration :
                                               'constructor_declaration Gram.t)
                                            and _ =
                                             (constructor_arg_list :
                                               'constructor_arg_list Gram.t)
                                            and _ =
                                             (constrain :
                                               'constrain Gram.t)
                                            and _ =
                                             (comma_type_parameter :
                                               'comma_type_parameter Gram.t)
                                            and _ =
                                             (comma_patt :
                                               'comma_patt Gram.t)
                                            and _ =
                                             (comma_ipatt :
                                               'comma_ipatt Gram.t)
                                            and _ =
                                             (comma_expr :
                                               'comma_expr Gram.t)
                                            and _ =
                                             (comma_ctyp :
                                               'comma_ctyp Gram.t)
                                            and _ =
                                             (class_type_quot :
                                               'class_type_quot Gram.t)
                                            and _ =
                                             (class_type_plus :
                                               'class_type_plus Gram.t)
                                            and _ =
                                             (class_type_longident_and_param :
                                               'class_type_longident_and_param Gram.t)
                                            and _ =
                                             (class_type_longident :
                                               'class_type_longident Gram.t)
                                            and _ =
                                             (class_type_declaration :
                                               'class_type_declaration Gram.t)
                                            and _ =
                                             (class_type :
                                               'class_type Gram.t)
                                            and _ =
                                             (class_structure :
                                               'class_structure Gram.t)
                                            and _ =
                                             (class_str_item_quot :
                                               'class_str_item_quot Gram.t)
                                            and _ =
                                             (class_str_item :
                                               'class_str_item Gram.t)
                                            and _ =
                                             (class_signature :
                                               'class_signature Gram.t)
                                            and _ =
                                             (class_sig_item_quot :
                                               'class_sig_item_quot Gram.t)
                                            and _ =
                                             (class_sig_item :
                                               'class_sig_item Gram.t)
                                            and _ =
                                             (class_name_and_param :
                                               'class_name_and_param Gram.t)
                                            and _ =
                                             (class_longident_and_param :
                                               'class_longident_and_param Gram.t)
                                            and _ =
                                             (class_longident :
                                               'class_longident Gram.t)
                                            and _ =
                                             (class_info_for_class_type :
                                               'class_info_for_class_type Gram.t)
                                            and _ =
                                             (class_info_for_class_expr :
                                               'class_info_for_class_expr Gram.t)
                                            and _ =
                                             (class_fun_def :
                                               'class_fun_def Gram.t)
                                            and _ =
                                             (class_fun_binding :
                                               'class_fun_binding Gram.t)
                                            and _ =
                                             (class_expr_quot :
                                               'class_expr_quot Gram.t)
                                            and _ =
                                             (class_expr :
                                               'class_expr Gram.t)
                                            and _ =
                                             (class_description :
                                               'class_description Gram.t)
                                            and _ =
                                             (class_declaration :
                                               'class_declaration Gram.t)
                                            and _ =
                                             (binding_quot :
                                               'binding_quot Gram.t)
                                            and _ =
                                             (binding : 'binding Gram.t)
                                            and _ =
                                             (match_case_quot :
                                               'match_case_quot Gram.t)
                                            and _ =
                                             (match_case0 :
                                               'match_case0 Gram.t)
                                            and _ =
                                             (match_case :
                                               'match_case Gram.t)
                                            and _ =
                                             (and_ctyp :
                                               'and_ctyp Gram.t)
                                            and _ =
                                             (amp_ctyp :
                                               'amp_ctyp Gram.t)
                                            and _ =
                                             (a_ident : 'a_ident Gram.t)
                                            and _ =
                                             (a_UIDENT :
                                               'a_UIDENT Gram.t)
                                            and _ =
                                             (a_STRING :
                                               'a_STRING Gram.t)
                                            and _ =
                                             (a_OPTLABEL :
                                               'a_OPTLABEL Gram.t)
                                            and _ =
                                             (a_NATIVEINT :
                                               'a_NATIVEINT Gram.t)
                                            and _ =
                                             (rec_binding_quot :
                                               'rec_binding_quot Gram.t)
                                            and _ =
                                             (a_LIDENT :
                                               'a_LIDENT Gram.t)
                                            and _ =
                                             (a_LABEL : 'a_LABEL Gram.t)
                                            and _ =
                                             (a_INT64 : 'a_INT64 Gram.t)
                                            and _ =
                                             (a_INT32 : 'a_INT32 Gram.t)
                                            and _ =
                                             (a_INT : 'a_INT Gram.t)
                                            and _ =
                                             (a_FLOAT : 'a_FLOAT Gram.t) in
                                            let grammar_entry_create =
                                             Gram.mk in
                                            let infixop5 =
                                             ((grammar_entry_create
                                                "infixop5") :
                                               'infixop5 Gram.t)
                                            and string_list =
                                             ((grammar_entry_create
                                                "string_list") :
                                               'string_list Gram.t)
                                            and opt_override =
                                             ((grammar_entry_create
                                                "opt_override") :
                                               'opt_override Gram.t)
                                            and unquoted_typevars =
                                             ((grammar_entry_create
                                                "unquoted_typevars") :
                                               'unquoted_typevars Gram.t)
                                            and value_val_opt_override =
                                             ((grammar_entry_create
                                                "value_val_opt_override") :
                                               'value_val_opt_override Gram.t)
                                            and method_opt_override =
                                             ((grammar_entry_create
                                                "method_opt_override") :
                                               'method_opt_override Gram.t)
                                            and module_longident_dot_lparen =
                                             ((grammar_entry_create
                                                "module_longident_dot_lparen") :
                                               'module_longident_dot_lparen Gram.t)
                                            and optional_type_parameter =
                                             ((grammar_entry_create
                                                "optional_type_parameter") :
                                               'optional_type_parameter Gram.t)
                                            and fun_def_cont_no_when =
                                             ((grammar_entry_create
                                                "fun_def_cont_no_when") :
                                               'fun_def_cont_no_when Gram.t)
                                            and fun_def_cont =
                                             ((grammar_entry_create
                                                "fun_def_cont") :
                                               'fun_def_cont Gram.t)
                                            and sequence' =
                                             ((grammar_entry_create
                                                "sequence'") :
                                               'sequence' Gram.t)
                                            and infixop6 =
                                             ((grammar_entry_create
                                                "infixop6") :
                                               'infixop6 Gram.t) in
                                            (
                                            (Gram.extend (
                                              (module_expr :
                                                'module_expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("top")) ),
                                                    None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("struct")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (str_items :
                                                             'str_items Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (st :
                                                           'str_items) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MeStr
                                                               (_loc, st)) :
                                                              'module_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("functor")) );
                                                       (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) ); (
                                                       (Gram.Skeyword
                                                         ("->")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (t :
                                                             'module_type) ->
                                                            fun _ ->
                                                             fun (i :
                                                               'a_UIDENT) ->
                                                              fun _ ->
                                                               fun _ ->
                                                                fun (_loc :
                                                                  FanLoc.t) ->
                                                                 ((Ast.MeFun
                                                                    (_loc,
                                                                    i, t,
                                                                    me)) :
                                                                   'module_expr)
                                                        )) ))] ));
                                                   (( (Some ("apply")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (me2 :
                                                          'module_expr) ->
                                                         fun (me1 :
                                                           'module_expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.MeApp
                                                              (_loc, me1,
                                                               me2)) :
                                                             'module_expr)
                                                        )) ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("val")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (package_type :
                                                             'package_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'package_type) ->
                                                          fun _ ->
                                                           fun (e :
                                                             'expr) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.MePkg
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExTyc
                                                                    (_loc,
                                                                    e, (
                                                                    (Ast.TyPkg
                                                                    (_loc,
                                                                    p))
                                                                    )))
                                                                   ))) :
                                                                 'module_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("val")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.MePkg
                                                                (_loc, e)) :
                                                               'module_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (me :
                                                           'module_expr) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (me :
                                                              'module_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (mt :
                                                           'module_type) ->
                                                          fun _ ->
                                                           fun (me :
                                                             'module_expr) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.MeTyc
                                                                 (_loc,
                                                                  me, mt)) :
                                                                'module_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'module_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.MeId
                                                             (_loc, i)) :
                                                            'module_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.module_expr_tag) :
                                                                'module_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "mexp")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"mexp\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "mexp")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.MeAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_expr"
                                                                    n s)
                                                                  ))) :
                                                                'module_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (str_item :
                                                'str_item Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("top")) ),
                                                    None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.StExp
                                                             (_loc, e)) :
                                                            'str_item) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.str_item_tag) :
                                                                'str_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "stri")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"stri\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "stri")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.StAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"str_item"
                                                                    n s)
                                                                  ))) :
                                                                'str_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("class")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_declaration :
                                                             'class_type_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ctd :
                                                          'class_type_declaration) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.StClt
                                                               (_loc,
                                                                ctd)) :
                                                              'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("class")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_declaration :
                                                             'class_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (cd :
                                                          'class_declaration) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.StCls
                                                              (_loc, cd)) :
                                                             'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("open")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'module_longident) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.StExp
                                                                 (_loc, (
                                                                  (Ast.ExOpI
                                                                    (_loc,
                                                                    i, e))
                                                                  ))) :
                                                                'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_binding0 :
                                                             'module_binding0 Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (mb :
                                                            'module_binding0) ->
                                                           fun (m :
                                                             'a_UIDENT) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.StExp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExLmd
                                                                    (_loc,
                                                                    m,
                                                                    mb,
                                                                    e))
                                                                   ))) :
                                                                 'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (bi :
                                                          'binding) ->
                                                         fun (r :
                                                           'opt_rec) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((match
                                                                bi with
                                                              | Ast.BiEq
                                                                 (_,
                                                                  Ast.PaAny
                                                                   (_), e) ->
                                                                 (Ast.StExp
                                                                   (_loc,
                                                                    e))
                                                              | _ ->
                                                                 (Ast.StVal
                                                                   (_loc,
                                                                    r,
                                                                    bi))) :
                                                              'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (bi :
                                                            'binding) ->
                                                           fun (r :
                                                             'opt_rec) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.StExp
                                                                 (_loc, (
                                                                  (Ast.ExLet
                                                                    (_loc,
                                                                    r,
                                                                    bi,
                                                                    x))
                                                                  ))) :
                                                                'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_declaration :
                                                             'type_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (td :
                                                          'type_declaration) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.StTyp
                                                              (_loc, td)) :
                                                             'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("open")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'module_longident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.StOpn
                                                              (_loc, i)) :
                                                             'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_ident) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.StMty
                                                                 (_loc,
                                                                  i, mt)) :
                                                                'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Skeyword
                                                         ("rec")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_binding :
                                                             'module_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mb :
                                                          'module_binding) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.StRecMod
                                                               (_loc, mb)) :
                                                              'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_binding0 :
                                                             'module_binding0 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mb :
                                                          'module_binding0) ->
                                                         fun (i :
                                                           'a_UIDENT) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.StMod
                                                               (_loc, i,
                                                                mb)) :
                                                              'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("include")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.StInc
                                                              (_loc, me)) :
                                                             'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("external")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (string_list :
                                                             'string_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (sl :
                                                          'string_list) ->
                                                         fun _ ->
                                                          fun (t :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (i :
                                                              'a_LIDENT) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.StExt
                                                                  (_loc,
                                                                   i, t,
                                                                   sl)) :
                                                                 'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("exception"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_declaration :
                                                             'constructor_declaration Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_longident :
                                                             'type_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'type_longident) ->
                                                         fun _ ->
                                                          fun (t :
                                                            'constructor_declaration) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.StExc
                                                                (_loc, t,
                                                                 (
                                                                 (Ast.OSome
                                                                   (i))
                                                                 ))) :
                                                               'str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("exception"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_declaration :
                                                             'constructor_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'constructor_declaration) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.StExc
                                                              (_loc, t,
                                                               Ast.ONone
                                                               )) :
                                                             'str_item)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_binding0 :
                                                'module_binding0 Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`RA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (me :
                                                             'module_binding0)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.MeTyc
                                                                (_loc,
                                                                 me, mt)) :
                                                               'module_binding0)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (mb :
                                                          'module_binding0) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (m :
                                                              'a_UIDENT) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.MeFun
                                                                  (_loc,
                                                                   m, mt,
                                                                   mb)) :
                                                                 'module_binding0)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_binding :
                                                'module_binding Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (m :
                                                              'a_UIDENT) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.MbColEq
                                                                 (_loc,
                                                                  m, mt,
                                                                  me)) :
                                                                'module_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.module_binding_tag) :
                                                                'module_binding)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (__camlp4_0 :
                                                              Gram.token) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              (match
                                                                 __camlp4_0 with
                                                               | ANTIQUOT
                                                                  (("" as
                                                                    n), m) ->
                                                                  ((Ast.MbColEq
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n m)
                                                                    ),
                                                                    mt,
                                                                    me)) :
                                                                    'module_binding)
                                                               | _ ->
                                                                  assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("" as n),
                                                               s) ->
                                                              ((Ast.MbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_binding"
                                                                    n s)
                                                                  ))) :
                                                                'module_binding)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((("module_binding"
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"module_binding\" | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((("module_binding"
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.MbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_binding"
                                                                    n s)
                                                                  ))) :
                                                                'module_binding)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (b2 :
                                                          'module_binding) ->
                                                         fun _ ->
                                                          fun (b1 :
                                                            'module_binding) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MbAnd
                                                               (_loc, b1,
                                                                b2)) :
                                                              'module_binding)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_type :
                                                'module_type Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("top")) ),
                                                    None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("functor")) );
                                                       (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) ); (
                                                       (Gram.Skeyword
                                                         ("->")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (t :
                                                             'module_type) ->
                                                            fun _ ->
                                                             fun (i :
                                                               'a_UIDENT) ->
                                                              fun _ ->
                                                               fun _ ->
                                                                fun (_loc :
                                                                  FanLoc.t) ->
                                                                 ((Ast.MtFun
                                                                    (_loc,
                                                                    i, t,
                                                                    mt)) :
                                                                   'module_type)
                                                        )) ))] ));
                                                   (( (Some ("with")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("with")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (with_constr :
                                                             'with_constr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (wc :
                                                          'with_constr) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MtWit
                                                               (_loc, mt,
                                                                wc)) :
                                                              'module_type)
                                                        )) ))] ));
                                                   (( (Some ("apply")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ;
                                                       Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (dummy :
                                                             'dummy Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (mt2 :
                                                           'module_type) ->
                                                          fun (mt1 :
                                                            'module_type) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((ModuleType.app
                                                               mt1 mt2) :
                                                              'module_type)
                                                        )) ))] ));
                                                   (( (Some (".")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (mt2 :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (mt1 :
                                                            'module_type) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((ModuleType.acc
                                                               mt1 mt2) :
                                                              'module_type)
                                                        )) ))] ));
                                                   (( (Some ("sig")) ),
                                                    None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("sig")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sig_items :
                                                             'sig_items Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (sg :
                                                           'sig_items) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MtSig
                                                               (_loc, sg)) :
                                                              'module_type)
                                                        )) ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.MtOf
                                                                (_loc,
                                                                 me)) :
                                                               'module_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (mt :
                                                           'module_type) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (mt :
                                                              'module_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.MtQuo
                                                              (_loc, i)) :
                                                             'module_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident_with_app :
                                                             'module_longident_with_app Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'module_longident_with_app) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.MtId
                                                             (_loc, i)) :
                                                            'module_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.module_type_tag) :
                                                                'module_type)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "mtyp")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"mtyp\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "mtyp")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.MtAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_type"
                                                                    n s)
                                                                  ))) :
                                                                'module_type)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sig_item :
                                                'sig_item Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("top")) ),
                                                    None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("class")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_declaration :
                                                             'class_type_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ctd :
                                                          'class_type_declaration) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.SgClt
                                                               (_loc,
                                                                ctd)) :
                                                              'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("class")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_description :
                                                             'class_description Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (cd :
                                                          'class_description) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.SgCls
                                                              (_loc, cd)) :
                                                             'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("val")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.SgVal
                                                                (_loc, i,
                                                                 t)) :
                                                               'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_declaration :
                                                             'type_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'type_declaration) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.SgTyp
                                                              (_loc, t)) :
                                                             'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("open")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'module_longident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.SgOpn
                                                              (_loc, i)) :
                                                             'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.SgMty
                                                               (_loc, i,
                                                                (
                                                                (Ast.MtNil
                                                                  (_loc))
                                                                ))) :
                                                              'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_ident) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.SgMty
                                                                 (_loc,
                                                                  i, mt)) :
                                                                'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Skeyword
                                                         ("rec")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_rec_declaration :
                                                             'module_rec_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mb :
                                                          'module_rec_declaration) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.SgRecMod
                                                               (_loc, mb)) :
                                                              'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_declaration :
                                                             'module_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_declaration) ->
                                                         fun (i :
                                                           'a_UIDENT) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.SgMod
                                                               (_loc, i,
                                                                mt)) :
                                                              'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("include")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.SgInc
                                                              (_loc, mt)) :
                                                             'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("external")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (string_list :
                                                             'string_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (sl :
                                                          'string_list) ->
                                                         fun _ ->
                                                          fun (t :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (i :
                                                              'a_LIDENT) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.SgExt
                                                                  (_loc,
                                                                   i, t,
                                                                   sl)) :
                                                                 'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("exception"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_declaration :
                                                             'constructor_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'constructor_declaration) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.SgExc
                                                              (_loc, t)) :
                                                             'sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.sig_item_tag) :
                                                                'sig_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "sigi")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"sigi\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "sigi")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.SgAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"sig_item"
                                                                    n s)
                                                                  ))) :
                                                                'sig_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_declaration :
                                                'module_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`RA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_declaration) ->
                                                         fun _ ->
                                                          fun (t :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (i :
                                                              'a_UIDENT) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.MtFun
                                                                  (_loc,
                                                                   i, t,
                                                                   mt)) :
                                                                 'module_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (mt :
                                                             'module_declaration)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_rec_declaration :
                                                'module_rec_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MbCol
                                                               (_loc, m,
                                                                mt)) :
                                                              'module_rec_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.module_binding_tag) :
                                                                'module_rec_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "module_binding")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"module_binding\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "module_binding")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.MbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_binding"
                                                                    n s)
                                                                  ))) :
                                                                'module_rec_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (m2 :
                                                          'module_rec_declaration) ->
                                                         fun _ ->
                                                          fun (m1 :
                                                            'module_rec_declaration) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MbAnd
                                                               (_loc, m1,
                                                                m2)) :
                                                              'module_rec_declaration)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (with_constr :
                                                'with_constr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident_with_app :
                                                             'module_longident_with_app Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i2 :
                                                          'module_longident_with_app) ->
                                                         fun _ ->
                                                          fun (i1 :
                                                            'module_longident) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.WcMoS
                                                                (_loc,
                                                                 i1, i2)) :
                                                               'with_constr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_longident_and_parameters :
                                                             'type_longident_and_parameters Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'type_longident_and_parameters) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.WcTyS
                                                                (_loc,
                                                                 t1, t2)) :
                                                               'with_constr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "typ")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"typ\") | \"anti\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (match
                                                                __camlp4_0 with
                                                              | ANTIQUOT
                                                                 ((((""
                                                                    | "typ")
                                                                    | "anti") as
                                                                   n), s) ->
                                                                 ((Ast.WcTyS
                                                                    (_loc,
                                                                    (
                                                                    (Ast.TyAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                    )))
                                                                    ), t)) :
                                                                   'with_constr)
                                                              | _ ->
                                                                 assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident_with_app :
                                                             'module_longident_with_app Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i2 :
                                                          'module_longident_with_app) ->
                                                         fun _ ->
                                                          fun (i1 :
                                                            'module_longident) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.WcMod
                                                                (_loc,
                                                                 i1, i2)) :
                                                               'with_constr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_longident_and_parameters :
                                                             'type_longident_and_parameters Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'type_longident_and_parameters) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.WcTyp
                                                                (_loc,
                                                                 t1, t2)) :
                                                               'with_constr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "typ")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"typ\") | \"anti\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (match
                                                                __camlp4_0 with
                                                              | ANTIQUOT
                                                                 ((((""
                                                                    | "typ")
                                                                    | "anti") as
                                                                   n), s) ->
                                                                 ((Ast.WcTyp
                                                                    (_loc,
                                                                    (
                                                                    (Ast.TyAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                    )))
                                                                    ), t)) :
                                                                   'with_constr)
                                                              | _ ->
                                                                 assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.with_constr_tag) :
                                                                'with_constr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "with_constr")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"with_constr\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "with_constr")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.WcAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"with_constr"
                                                                    n s)
                                                                  ))) :
                                                                'with_constr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (wc2 :
                                                          'with_constr) ->
                                                         fun _ ->
                                                          fun (wc1 :
                                                            'with_constr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.WcAnd
                                                               (_loc,
                                                                wc1, wc2)) :
                                                              'with_constr)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (expr : 'expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("top")) ), (
                                                    (Some (`RA)) ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("object")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_class_self_patt :
                                                             'opt_class_self_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_structure :
                                                             'class_structure Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (cst :
                                                           'class_structure) ->
                                                          fun (csp :
                                                            'opt_class_self_patt) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExObj
                                                                (_loc,
                                                                 csp,
                                                                 cst)) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("while")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("do")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (do_sequence :
                                                             'do_sequence Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (seq :
                                                          'do_sequence) ->
                                                         fun _ ->
                                                          fun (e :
                                                            'sequence) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExWhi
                                                                (_loc, (
                                                                 (Expr.mksequence'
                                                                   _loc
                                                                   e) ),
                                                                 seq)) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("for")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (direction_flag :
                                                             'direction_flag Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("do")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (do_sequence :
                                                             'do_sequence Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (seq :
                                                          'do_sequence) ->
                                                         fun _ ->
                                                          fun (e2 :
                                                            'sequence) ->
                                                           fun (df :
                                                             'direction_flag) ->
                                                            fun (e1 :
                                                              'sequence) ->
                                                             fun _ ->
                                                              fun (i :
                                                                'a_LIDENT) ->
                                                               fun _ ->
                                                                fun (_loc :
                                                                  FanLoc.t) ->
                                                                 ((Ast.ExFor
                                                                    (_loc,
                                                                    i, (
                                                                    (Expr.mksequence'
                                                                    _loc
                                                                    e1)
                                                                    ), (
                                                                    (Expr.mksequence'
                                                                    _loc
                                                                    e2)
                                                                    ),
                                                                    df,
                                                                    seq)) :
                                                                   'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("do")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (do_sequence :
                                                             'do_sequence Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (seq :
                                                          'do_sequence) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Expr.mksequence
                                                              _loc seq) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("if")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("then")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("else")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e3 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e2 :
                                                            'expr) ->
                                                           fun _ ->
                                                            fun (e1 :
                                                              'expr) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.ExIfe
                                                                  (_loc,
                                                                   e1,
                                                                   e2,
                                                                   e3)) :
                                                                 'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("try")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("with")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (match_case :
                                                             'match_case Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (a :
                                                          'match_case) ->
                                                         fun _ ->
                                                          fun (e :
                                                            'sequence) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExTry
                                                                (_loc, (
                                                                 (Expr.mksequence'
                                                                   _loc
                                                                   e) ),
                                                                 a)) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("match")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("with")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (match_case :
                                                             'match_case Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (a :
                                                          'match_case) ->
                                                         fun _ ->
                                                          fun (e :
                                                            'sequence) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExMat
                                                                (_loc, (
                                                                 (Expr.mksequence'
                                                                   _loc
                                                                   e) ),
                                                                 a)) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("fun")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_def :
                                                             'fun_def Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_def) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (e : 'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("fun")) ); (
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Slist0sep
                                                         ((
                                                          (Gram.Snterm
                                                            (Gram.obj (
                                                              (match_case0 :
                                                                'match_case0 Gram.t)
                                                              ))) ), (
                                                          (Gram.Skeyword
                                                            ("|")) ))) );
                                                       (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (a :
                                                           'match_case0 list) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExFun
                                                                (_loc, (
                                                                 (Ast.mcOr_of_list
                                                                   a) ))) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("open")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'module_longident) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExOpI
                                                                 (_loc,
                                                                  i, e)) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_binding0 :
                                                             'module_binding0 Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (mb :
                                                            'module_binding0) ->
                                                           fun (m :
                                                             'a_UIDENT) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.ExLmd
                                                                  (_loc,
                                                                   m, mb,
                                                                   e)) :
                                                                 'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (bi :
                                                            'binding) ->
                                                           fun (r :
                                                             'opt_rec) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExLet
                                                                 (_loc,
                                                                  r, bi,
                                                                  x)) :
                                                                'expr) ))
                                                      ))] ));
                                                   (( (Some ("where")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("where")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (let_binding :
                                                             'let_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (lb :
                                                          'let_binding) ->
                                                         fun (rf :
                                                           'opt_rec) ->
                                                          fun _ ->
                                                           fun (e :
                                                             'expr) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExLet
                                                                (_loc,
                                                                 rf, lb,
                                                                 e)) :
                                                               'expr) ))
                                                      ))] ));
                                                   (( (Some (":=")) ), (
                                                    (Some (`NA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("<-")) );
                                                       Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (dummy :
                                                             'dummy Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e2 :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (e1 :
                                                             'expr) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((match
                                                                 (Expr.bigarray_set
                                                                   _loc
                                                                   e1 e2) with
                                                               | Some (e) ->
                                                                  e
                                                               | None ->
                                                                  (Ast.ExAss
                                                                    (_loc,
                                                                    e1,
                                                                    e2))) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":=")) );
                                                       Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (dummy :
                                                             'dummy Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e2 :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (e1 :
                                                             'expr) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExAss
                                                                (_loc, (
                                                                 (Ast.ExAcc
                                                                   (_loc,
                                                                    e1, (
                                                                    (
                                                                    Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "contents"))
                                                                    )))
                                                                    )))
                                                                 ), e2)) :
                                                               'expr) ))
                                                      ))] ));
                                                   (( (Some ("||")) ), (
                                                    (Some (`RA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop6 :
                                                             'infixop6 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop6) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   (( (Some ("&&")) ), (
                                                    (Some (`RA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop5 :
                                                             'infixop5 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop5) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   (( (Some ("<")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop0 :
                                                             'infixop0 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop0) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   (( (Some ("^")) ), (
                                                    (Some (`RA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop1 :
                                                             'infixop1 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop1) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   (( (Some ("+")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop2 :
                                                             'infixop2 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop2) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   (( (Some ("*")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop3 :
                                                             'infixop3 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop3) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("mod")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "mod"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("lxor")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "lxor"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("lor")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "lor"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("land")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "land"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   (( (Some ("**")) ), (
                                                    (Some (`RA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (infixop4 :
                                                             'infixop4 Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (op :
                                                           'infixop4) ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   op,
                                                                   e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("lsr")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "lsr"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("lsl")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "lsl"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("asr")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "asr"))
                                                                    )))
                                                                   ), e1))
                                                                ), e2)) :
                                                              'expr) ))
                                                      ))] ));
                                                   ((
                                                    (Some ("unary minus"))
                                                    ), ( (Some (`NA)) ),
                                                    (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-.")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Expr.mkumin
                                                              _loc "-."
                                                              e) : 'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Expr.mkumin
                                                              _loc "-" e) :
                                                             'expr) )) ))]
                                                    ));
                                                   (( (Some ("apply")) ),
                                                    ( (Some (`LA)) ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("lazy")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExLaz
                                                              (_loc, e)) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("new")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_longident :
                                                             'class_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'class_longident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExNew
                                                              (_loc, i)) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("assert")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Expr.mkassert
                                                              _loc e) :
                                                             'expr) )) ));
                                                     ((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun (e1 :
                                                           'expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExApp
                                                              (_loc, e1,
                                                               e2)) :
                                                             'expr) )) ))]
                                                    ));
                                                   (( (Some ("label")) ),
                                                    ( (Some (`NA)) ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExOlb
                                                              (_loc, i, (
                                                               (Ast.ExNil
                                                                 (_loc))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExOlb
                                                                (_loc, i,
                                                                 e)) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | OPTLABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "OPTLABEL (_)"))
                                                       ); Gram.Sself ] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | OPTLABEL
                                                               (i) ->
                                                               ((Ast.ExOlb
                                                                  (_loc,
                                                                   i, e)) :
                                                                 'expr)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ), "LABEL (_)"))
                                                       ); Gram.Sself ] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LABEL (i) ->
                                                               ((Ast.ExLab
                                                                  (_loc,
                                                                   i, e)) :
                                                                 'expr)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExLab
                                                              (_loc, i, (
                                                               (Ast.ExNil
                                                                 (_loc))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExLab
                                                                (_loc, i,
                                                                 e)) :
                                                               'expr) ))
                                                      ))] ));
                                                   (( (Some (".")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (lab :
                                                          'label) ->
                                                         fun _ ->
                                                          fun (e :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExSnd
                                                               (_loc, e,
                                                                lab)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExAcc
                                                               (_loc, e1,
                                                                e2)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) ); (
                                                       (Gram.Skeyword
                                                         ("{")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_expr :
                                                             'comma_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e2 :
                                                           'comma_expr) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (e1 :
                                                              'expr) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Expr.bigarray_get
                                                                 _loc e1
                                                                 e2) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) ); (
                                                       (Gram.Skeyword
                                                         ("[")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e2 :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (e1 :
                                                              'expr) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExSte
                                                                 (_loc,
                                                                  e1, e2)) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e2 :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (e1 :
                                                              'expr) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExAre
                                                                 (_loc,
                                                                  e1, e2)) :
                                                                'expr) ))
                                                      ))] ));
                                                   (( (Some ("~-")) ), (
                                                    (Some (`NA)) ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (prefixop :
                                                             'prefixop Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (f :
                                                           'prefixop) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExApp
                                                              (_loc, f,
                                                               e)) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("!")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExAcc
                                                              (_loc, e, (
                                                               (Ast.ExId
                                                                 (_loc, (
                                                                  (Ast.IdLid
                                                                    (_loc,
                                                                    "contents"))
                                                                  ))) ))) :
                                                             'expr) )) ))]
                                                    ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (package_type :
                                                             'package_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pt :
                                                           'package_type) ->
                                                          fun _ ->
                                                           fun (me :
                                                             'module_expr) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.ExPkg
                                                                  (_loc,
                                                                   (
                                                                   (Ast.MeTyc
                                                                    (_loc,
                                                                    me,
                                                                    pt))
                                                                   ))) :
                                                                 'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (me :
                                                           'module_expr) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExPkg
                                                                (_loc,
                                                                 me)) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("begin")) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExId
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "()"))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("begin")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (seq :
                                                           'sequence) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Expr.mksequence
                                                               _loc seq) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (e : 'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":>")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (e :
                                                             'expr) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExCoe
                                                                 (_loc,
                                                                  e, (
                                                                  (Ast.TyNil
                                                                    (_loc))
                                                                  ), t)) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":>")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t2 :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (t :
                                                             'ctyp) ->
                                                            fun _ ->
                                                             fun (e :
                                                               'expr) ->
                                                              fun _ ->
                                                               fun (_loc :
                                                                 FanLoc.t) ->
                                                                ((Ast.ExCoe
                                                                   (_loc,
                                                                    e, t,
                                                                    t2)) :
                                                                  'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (e :
                                                            'expr) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Expr.mksequence
                                                                _loc e) :
                                                               'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (seq :
                                                           'sequence) ->
                                                          fun _ ->
                                                           fun (e :
                                                             'expr) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Expr.mksequence
                                                                 _loc (
                                                                 (Ast.ExSem
                                                                   (_loc,
                                                                    e,
                                                                    seq))
                                                                 )) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_expr :
                                                             'comma_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (el :
                                                           'comma_expr) ->
                                                          fun _ ->
                                                           fun (e :
                                                             'expr) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExTup
                                                                 (_loc, (
                                                                  (Ast.ExCom
                                                                    (_loc,
                                                                    e,
                                                                    el))
                                                                  ))) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (e :
                                                             'expr) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExTyc
                                                                 (_loc,
                                                                  e, t)) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExId
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "()"))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{<")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (field_expr_list :
                                                             'field_expr_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (">}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (fel :
                                                           'field_expr_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExOvr
                                                               (_loc,
                                                                fel)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{<")) ); (
                                                       (Gram.Skeyword
                                                         (">}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExOvr
                                                              (_loc, (
                                                               (Ast.RbNil
                                                                 (_loc))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) ); (
                                                       (Gram.Skeyword
                                                         ("with")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_expr_list :
                                                             'label_expr_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (el :
                                                           'label_expr_list) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (e :
                                                              'expr) ->
                                                             fun _ ->
                                                              fun _ ->
                                                               fun (_loc :
                                                                 FanLoc.t) ->
                                                                ((Ast.ExRec
                                                                   (_loc,
                                                                    el,
                                                                    e)) :
                                                                  'expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_expr_list :
                                                             'label_expr_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (el :
                                                           'label_expr_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExRec
                                                               (_loc, el,
                                                                (
                                                                (Ast.ExNil
                                                                  (_loc))
                                                                ))) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[|")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_expr :
                                                             'sem_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("|]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (el :
                                                           'sem_expr) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExArr
                                                               (_loc, el)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[|")) ); (
                                                       (Gram.Skeyword
                                                         ("|]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExArr
                                                              (_loc, (
                                                               (Ast.ExNil
                                                                 (_loc))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_expr_for_list :
                                                             'sem_expr_for_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (mk_list :
                                                           'sem_expr_for_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((mk_list (
                                                               (Ast.ExId
                                                                 (_loc, (
                                                                  (Ast.IdUid
                                                                    (_loc,
                                                                    "[]"))
                                                                  ))) )) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_expr_for_list :
                                                             'sem_expr_for_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("::")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (last :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (mk_list :
                                                             'sem_expr_for_list) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((mk_list
                                                                 last) :
                                                                'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExId
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "[]"))
                                                               ))) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExVrn
                                                              (_loc, s)) :
                                                             'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (val_longident :
                                                                'val_longident Gram.t)
                                                              ))))) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'val_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExId
                                                             (_loc, i)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (module_longident_dot_lparen :
                                                                'module_longident_dot_lparen Gram.t)
                                                              ))))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e :
                                                           'sequence) ->
                                                          fun (i :
                                                            'module_longident_dot_lparen) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExOpI
                                                               (_loc, i,
                                                                e)) :
                                                              'expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_CHAR :
                                                             'a_CHAR Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_CHAR) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExChr
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_STRING :
                                                             'a_STRING Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_STRING) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExStr
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_FLOAT :
                                                             'a_FLOAT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_FLOAT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExFlo
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_NATIVEINT :
                                                             'a_NATIVEINT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_NATIVEINT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExNativeInt
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT64 :
                                                             'a_INT64 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT64) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExInt64
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT32 :
                                                             'a_INT32 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT32) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExInt32
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT :
                                                             'a_INT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExInt
                                                             (_loc, s)) :
                                                            'expr) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("seq", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"seq\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("seq" as
                                                                n), s) ->
                                                              ((Ast.ExSeq
                                                                 (_loc, (
                                                                  (Ast.ExAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"expr"
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("tup", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"tup\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("tup" as
                                                                n), s) ->
                                                              ((Ast.ExTup
                                                                 (_loc, (
                                                                  (Ast.ExAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"expr"
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("`bool", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"`bool\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("`bool" as
                                                                n), s) ->
                                                              ((Ast.ExId
                                                                 (_loc, (
                                                                  (Ast.IdAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((("exp"
                                                                | "")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"exp\" | \"\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((("exp"
                                                                  | "")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.ExAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"expr"
                                                                    n s)
                                                                  ))) :
                                                                'expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.expr_tag) :
                                                                'expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (do_sequence :
                                                'do_sequence Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("done")) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExId
                                                             (_loc, (
                                                              (Ast.IdUid
                                                                (_loc,
                                                                 "()"))
                                                              ))) :
                                                            'do_sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           do_sequence (
                                                           [((
                                                             [(
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (sequence :
                                                                    'sequence Gram.t)
                                                                  ))) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("done"))
                                                              )] ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun (seq :
                                                                  'sequence) ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (seq :
                                                                    'e__16)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (seq :
                                                          'e__16) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (seq :
                                                            'do_sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           do_sequence (
                                                           [((
                                                             [(
                                                              (Gram.Skeyword
                                                                ("{")) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("}")) )]
                                                             ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun _ ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (() :
                                                                    'e__15)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExId
                                                             (_loc, (
                                                              (Ast.IdUid
                                                                (_loc,
                                                                 "()"))
                                                              ))) :
                                                            'do_sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           do_sequence (
                                                           [((
                                                             [(
                                                              (Gram.Skeyword
                                                                ("{")) );
                                                              (
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (sequence :
                                                                    'sequence Gram.t)
                                                                  ))) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("}")) )]
                                                             ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun (seq :
                                                                  'sequence) ->
                                                                 fun _ ->
                                                                  fun (_loc :
                                                                    FanLoc.t) ->
                                                                   (seq :
                                                                    'e__14)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (seq :
                                                          'e__14) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (seq :
                                                            'do_sequence)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (infixop5 :
                                                'infixop5 Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.srules
                                                         infixop5 (
                                                         [((
                                                           [(
                                                            (Gram.Skeyword
                                                              ("&&")) )]
                                                           ), (
                                                           (Gram.mk_action
                                                             (
                                                             fun (x :
                                                               Gram.token) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Gram.string_of_token
                                                                  x) :
                                                                 'e__17)
                                                             )) ));
                                                          ((
                                                           [(
                                                            (Gram.Skeyword
                                                              ("&")) )]
                                                           ), (
                                                           (Gram.mk_action
                                                             (
                                                             fun (x :
                                                               Gram.token) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Gram.string_of_token
                                                                  x) :
                                                                 'e__17)
                                                             )) ))] )) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'e__17) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExId
                                                             (_loc, (
                                                              (Ast.IdLid
                                                                (_loc, x))
                                                              ))) :
                                                            'infixop5) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (infixop6 :
                                                'infixop6 Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.srules
                                                         infixop6 (
                                                         [((
                                                           [(
                                                            (Gram.Skeyword
                                                              ("||")) )]
                                                           ), (
                                                           (Gram.mk_action
                                                             (
                                                             fun (x :
                                                               Gram.token) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Gram.string_of_token
                                                                  x) :
                                                                 'e__18)
                                                             )) ));
                                                          ((
                                                           [(
                                                            (Gram.Skeyword
                                                              ("or")) )]
                                                           ), (
                                                           (Gram.mk_action
                                                             (
                                                             fun (x :
                                                               Gram.token) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Gram.string_of_token
                                                                  x) :
                                                                 'e__18)
                                                             )) ))] )) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'e__18) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ExId
                                                             (_loc, (
                                                              (Ast.IdLid
                                                                (_loc, x))
                                                              ))) :
                                                            'infixop6) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sem_expr_for_list :
                                                'sem_expr_for_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (fun acc ->
                                                            (Ast.ExApp
                                                              (_loc, (
                                                               (Ast.ExApp
                                                                 (_loc, (
                                                                  (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "::"))
                                                                    )))
                                                                  ), e))
                                                               ), acc)) :
                                                            'sem_expr_for_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (fun acc ->
                                                             (Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "::"))
                                                                    )))
                                                                   ), e))
                                                                ), acc)) :
                                                             'sem_expr_for_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (el :
                                                          'sem_expr_for_list) ->
                                                         fun _ ->
                                                          fun (e :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (fun acc ->
                                                              (Ast.ExApp
                                                                (_loc, (
                                                                 (Ast.ExApp
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "::"))
                                                                    )))
                                                                    ), e))
                                                                 ), (
                                                                 (el acc)
                                                                 ))) :
                                                              'sem_expr_for_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (comma_expr :
                                                'comma_expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterml
                                                         ((
                                                          (Gram.obj (
                                                            (expr :
                                                              'expr Gram.t)
                                                            )) ), "top"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (e :
                                                            'comma_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.ExAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"expr,"
                                                                    n s)
                                                                  ))) :
                                                                'comma_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'comma_expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'comma_expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExCom
                                                               (_loc, e1,
                                                                e2)) :
                                                              'comma_expr)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (dummy : 'dummy Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         (() : 'dummy) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sequence' :
                                                'sequence' Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence :
                                                             'sequence Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (el :
                                                          'sequence) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (fun e ->
                                                             (Ast.ExSem
                                                               (_loc, e,
                                                                el)) :
                                                             'sequence')
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (fun e -> e :
                                                            'sequence')
                                                        )) ));
                                                     ([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         (fun e -> e :
                                                           'sequence') ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sequence :
                                                'sequence Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence' :
                                                             'sequence' Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (k :
                                                          'sequence') ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((k e) :
                                                             'sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.ExAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"expr;"
                                                                    n s)
                                                                  ))) :
                                                                'sequence)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("open")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_longident :
                                                             'module_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'sequence) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'module_longident) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExOpI
                                                                 (_loc,
                                                                  i, e)) :
                                                                'sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_binding0 :
                                                             'module_binding0 Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (el :
                                                          'sequence) ->
                                                         fun _ ->
                                                          fun (mb :
                                                            'module_binding0) ->
                                                           fun (m :
                                                             'a_UIDENT) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.ExLmd
                                                                  (_loc,
                                                                   m, mb,
                                                                   (
                                                                   (Expr.mksequence
                                                                    _loc
                                                                    el)
                                                                   ))) :
                                                                 'sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_binding0 :
                                                             'module_binding0 Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence' :
                                                             'sequence' Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (k :
                                                          'sequence') ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (mb :
                                                             'module_binding0) ->
                                                            fun (m :
                                                              'a_UIDENT) ->
                                                             fun _ ->
                                                              fun _ ->
                                                               fun (_loc :
                                                                 FanLoc.t) ->
                                                                ((k (
                                                                   (Ast.ExLmd
                                                                    (_loc,
                                                                    m,
                                                                    mb,
                                                                    e))
                                                                   )) :
                                                                  'sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (el :
                                                          'sequence) ->
                                                         fun _ ->
                                                          fun (bi :
                                                            'binding) ->
                                                           fun (rf :
                                                             'opt_rec) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.ExLet
                                                                 (_loc,
                                                                  rf, bi,
                                                                  (
                                                                  (Expr.mksequence
                                                                    _loc
                                                                    el)
                                                                  ))) :
                                                                'sequence)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sequence' :
                                                             'sequence' Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (k :
                                                          'sequence') ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (bi :
                                                             'binding) ->
                                                            fun (rf :
                                                              'opt_rec) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((k (
                                                                  (Ast.ExLet
                                                                    (_loc,
                                                                    rf,
                                                                    bi,
                                                                    e))
                                                                  )) :
                                                                 'sequence)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (binding : 'binding Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (let_binding :
                                                             'let_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (b :
                                                          'let_binding) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (b : 'binding)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (b2 :
                                                          'binding) ->
                                                         fun _ ->
                                                          fun (b1 :
                                                            'binding) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.BiAnd
                                                               (_loc, b1,
                                                                b2)) :
                                                              'binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.BiAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"binding"
                                                                    n s)
                                                                  ))) :
                                                                'binding)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((""
                                                                   | "anti") as
                                                                  n), s) ->
                                                                ((Ast.BiEq
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.PaAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                    )))
                                                                    ), e)) :
                                                                  'binding)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("binding"
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"binding\" | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("binding"
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.BiAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"binding"
                                                                    n s)
                                                                  ))) :
                                                                'binding)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (let_binding :
                                                'let_binding Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_binding :
                                                             'fun_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_binding) ->
                                                         fun (p :
                                                           'ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.BiEq
                                                              (_loc, p,
                                                               e)) :
                                                             'let_binding)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (fun_binding :
                                                'fun_binding Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`RA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (cvalue_binding :
                                                             'cvalue_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (bi :
                                                          'cvalue_binding) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (bi :
                                                            'fun_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (labeled_ipatt :
                                                                'labeled_ipatt Gram.t)
                                                              ))))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_binding) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExFun
                                                              (_loc, (
                                                               (Ast.McArr
                                                                 (_loc,
                                                                  p, (
                                                                  (Ast.ExNil
                                                                    (_loc))
                                                                  ), e))
                                                               ))) :
                                                             'fun_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           fun_binding (
                                                           [((
                                                             [(
                                                              (Gram.Skeyword
                                                                ("(")) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("type"))
                                                              )] ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun _ ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (() :
                                                                    'e__19)
                                                               )) ))] )))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_binding) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExFUN
                                                                (_loc, i,
                                                                 e)) :
                                                               'fun_binding)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (match_case :
                                                'match_case Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (p :
                                                            'ipatt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.McArr
                                                               (_loc, p,
                                                                (
                                                                (Ast.ExNil
                                                                  (_loc))
                                                                ), e)) :
                                                              'match_case)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Slist0sep
                                                         ((
                                                          (Gram.Snterm
                                                            (Gram.obj (
                                                              (match_case0 :
                                                                'match_case0 Gram.t)
                                                              ))) ), (
                                                          (Gram.Skeyword
                                                            ("|")) ))) );
                                                       (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (l :
                                                           'match_case0 list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.mcOr_of_list
                                                               l) :
                                                              'match_case)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (match_case0 :
                                                'match_case0 Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt_as_patt_opt :
                                                             'patt_as_patt_opt Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_when_expr :
                                                             'opt_when_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (w :
                                                            'opt_when_expr) ->
                                                           fun (p :
                                                             'patt_as_patt_opt) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.McArr
                                                                (_loc, p,
                                                                 w, e)) :
                                                               'match_case0)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("when")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (w :
                                                            'expr) ->
                                                           fun _ ->
                                                            fun (__camlp4_0 :
                                                              Gram.token) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              (match
                                                                 __camlp4_0 with
                                                               | ANTIQUOT
                                                                  (((""
                                                                    | "anti") as
                                                                    n), s) ->
                                                                  ((Ast.McArr
                                                                    (_loc,
                                                                    (
                                                                    (Ast.PaAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                    )))
                                                                    ), w,
                                                                    e)) :
                                                                    'match_case0)
                                                               | _ ->
                                                                  assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((""
                                                                   | "anti") as
                                                                  n), s) ->
                                                                ((Ast.McArr
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.PaAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                    )))
                                                                    ), (
                                                                    (
                                                                    Ast.ExNil
                                                                    (_loc))
                                                                    ), e)) :
                                                                  'match_case0)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.McAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"match_case"
                                                                    n s)
                                                                  ))) :
                                                                'match_case0)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("match_case"
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"match_case\" | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("match_case"
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.McAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"match_case"
                                                                    n s)
                                                                  ))) :
                                                                'match_case0)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_when_expr :
                                                'opt_when_expr Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.ExNil
                                                            (_loc)) :
                                                           'opt_when_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("when")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (w :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (w :
                                                             'opt_when_expr)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (patt_as_patt_opt :
                                                'patt_as_patt_opt Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'patt_as_patt_opt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("as")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaAli
                                                               (_loc, p1,
                                                                p2)) :
                                                              'patt_as_patt_opt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_expr_list :
                                                'label_expr_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_expr :
                                                             'label_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (b1 :
                                                          'label_expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (b1 :
                                                            'label_expr_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_expr :
                                                             'label_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (b1 :
                                                           'label_expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (b1 :
                                                             'label_expr_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_expr :
                                                             'label_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (b2 :
                                                          'label_expr_list) ->
                                                         fun _ ->
                                                          fun (b1 :
                                                            'label_expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.RbSem
                                                               (_loc, b1,
                                                                b2)) :
                                                              'label_expr_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_expr :
                                                'label_expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_longident :
                                                             'label_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'label_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.RbEq
                                                             (_loc, i, (
                                                              (Ast.ExId
                                                                (_loc, (
                                                                 (Ast.IdLid
                                                                   (_loc,
                                                                    (
                                                                    (Ident.to_lid
                                                                    i) )))
                                                                 ))) ))) :
                                                            'label_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_longident :
                                                             'label_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_binding :
                                                             'fun_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_binding) ->
                                                         fun (i :
                                                           'label_longident) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.RbEq
                                                              (_loc, i,
                                                               e)) :
                                                             'label_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.RbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"rec_binding"
                                                                    n s)
                                                                  ))) :
                                                                'label_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((""
                                                                   | "anti") as
                                                                  n), s) ->
                                                                ((Ast.RbEq
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                    )))
                                                                    ), e)) :
                                                                  'label_expr)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.RbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"rec_binding"
                                                                    n s)
                                                                  ))) :
                                                                'label_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("rec_binding",
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"rec_binding\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("rec_binding" as
                                                                n), s) ->
                                                              ((Ast.RbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"rec_binding"
                                                                    n s)
                                                                  ))) :
                                                                'label_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (fun_def : 'fun_def Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stry
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (labeled_ipatt :
                                                                'labeled_ipatt Gram.t)
                                                              ))))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_def_cont :
                                                             'fun_def_cont Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((w, e) :
                                                          'fun_def_cont) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExFun
                                                              (_loc, (
                                                               (Ast.McArr
                                                                 (_loc,
                                                                  p, w,
                                                                  e)) ))) :
                                                             'fun_def) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           fun_def (
                                                           [((
                                                             [(
                                                              (Gram.Skeyword
                                                                ("(")) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("type"))
                                                              )] ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun _ ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (() :
                                                                    'e__20)
                                                               )) ))] )))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_def_cont_no_when :
                                                             'fun_def_cont_no_when Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_def_cont_no_when) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExFUN
                                                                (_loc, i,
                                                                 e)) :
                                                               'fun_def)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (fun_def_cont :
                                                'fun_def_cont Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`RA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (((
                                                             (Ast.ExNil
                                                               (_loc)) ),
                                                             e) :
                                                             'fun_def_cont)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("when")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (w :
                                                            'expr) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((w, e) :
                                                               'fun_def_cont)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (labeled_ipatt :
                                                                'labeled_ipatt Gram.t)
                                                              ))))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun ((w, e) :
                                                          'fun_def_cont) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (((
                                                             (Ast.ExNil
                                                               (_loc)) ),
                                                             (
                                                             (Ast.ExFun
                                                               (_loc, (
                                                                (Ast.McArr
                                                                  (_loc,
                                                                   p, w,
                                                                   e)) )))
                                                             )) :
                                                             'fun_def_cont)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           fun_def_cont (
                                                           [((
                                                             [(
                                                              (Gram.Skeyword
                                                                ("(")) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("type"))
                                                              )] ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun _ ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (() :
                                                                    'e__21)
                                                               )) ))] )))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_def_cont_no_when :
                                                             'fun_def_cont_no_when Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_def_cont_no_when) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (((
                                                               (Ast.ExNil
                                                                 (_loc))
                                                               ), (
                                                               (Ast.ExFUN
                                                                 (_loc,
                                                                  i, e))
                                                               )) :
                                                               'fun_def_cont)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (fun_def_cont_no_when :
                                                'fun_def_cont_no_when Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`RA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (e :
                                                             'fun_def_cont_no_when)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (labeled_ipatt :
                                                                'labeled_ipatt Gram.t)
                                                              ))))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_def_cont :
                                                             'fun_def_cont Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((w, e) :
                                                          'fun_def_cont) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.ExFun
                                                              (_loc, (
                                                               (Ast.McArr
                                                                 (_loc,
                                                                  p, w,
                                                                  e)) ))) :
                                                             'fun_def_cont_no_when)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stry
                                                         (Gram.srules
                                                           fun_def_cont_no_when
                                                           (
                                                           [((
                                                             [(
                                                              (Gram.Skeyword
                                                                ("(")) );
                                                              (
                                                              (Gram.Skeyword
                                                                ("type"))
                                                              )] ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun _ ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (() :
                                                                    'e__22)
                                                               )) ))] )))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_def_cont_no_when) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExFUN
                                                                (_loc, i,
                                                                 e)) :
                                                               'fun_def_cont_no_when)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (patt : 'patt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("|")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("|")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaOrp
                                                               (_loc, p1,
                                                                p2)) :
                                                              'patt) ))
                                                      ))] ));
                                                   (( (Some ("..")) ), (
                                                    (Some (`NA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("..")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaRng
                                                               (_loc, p1,
                                                                p2)) :
                                                              'patt) ))
                                                      ))] ));
                                                   (( (Some ("apply")) ),
                                                    ( (Some (`LA)) ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("lazy")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaLaz
                                                              (_loc, p)) :
                                                             'patt) )) ));
                                                     ((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'patt) ->
                                                         fun (p1 :
                                                           'patt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaApp
                                                              (_loc, p1,
                                                               p2)) :
                                                             'patt) )) ))]
                                                    ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt_tcon :
                                                             'patt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'patt_tcon) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.PaOlbi
                                                                  (_loc,
                                                                   "", p,
                                                                   e)) :
                                                                 'patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt_tcon :
                                                             'patt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'patt_tcon) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.PaOlb
                                                                (_loc,
                                                                 "", p)) :
                                                               'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | ANTIQUOT
                                                               (((""
                                                                  | "lid") as
                                                                 n), i) ->
                                                               ((Ast.PaOlb
                                                                  (_loc,
                                                                   (
                                                                   (mk_anti
                                                                    n i)
                                                                   ), (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'patt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LIDENT (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "LIDENT (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LIDENT (i) ->
                                                               ((Ast.PaOlb
                                                                  (_loc,
                                                                   i, (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'patt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt_tcon :
                                                             'patt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (eq_expr :
                                                             'eq_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (f :
                                                           'eq_expr) ->
                                                          fun (p :
                                                            'patt_tcon) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (__camlp4_0 :
                                                               Gram.token) ->
                                                              fun _ ->
                                                               fun (_loc :
                                                                 FanLoc.t) ->
                                                                (match
                                                                   __camlp4_0 with
                                                                 | ANTIQUOT
                                                                    (((""
                                                                    | "lid") as
                                                                    n), i) ->
                                                                    ((f (
                                                                    (mk_anti
                                                                    n i)
                                                                    ) p) :
                                                                    'patt)
                                                                 | _ ->
                                                                    assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | OPTLABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "OPTLABEL (_)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt_tcon :
                                                             'patt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (eq_expr :
                                                             'eq_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (f :
                                                           'eq_expr) ->
                                                          fun (p :
                                                            'patt_tcon) ->
                                                           fun _ ->
                                                            fun (__camlp4_0 :
                                                              Gram.token) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              (match
                                                                 __camlp4_0 with
                                                               | OPTLABEL
                                                                  (i) ->
                                                                  ((f i
                                                                    p) :
                                                                    'patt)
                                                               | _ ->
                                                                  assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LIDENT (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "LIDENT (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LIDENT (i) ->
                                                               ((Ast.PaLab
                                                                  (_loc,
                                                                   i, (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'patt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | ANTIQUOT
                                                               (((""
                                                                  | "lid") as
                                                                 n), i) ->
                                                               ((Ast.PaLab
                                                                  (_loc,
                                                                   (
                                                                   (mk_anti
                                                                    n i)
                                                                   ), (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'patt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (match
                                                                __camlp4_0 with
                                                              | ANTIQUOT
                                                                 (((""
                                                                    | "lid") as
                                                                   n), i) ->
                                                                 ((Ast.PaLab
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n i)
                                                                    ), p)) :
                                                                   'patt)
                                                              | _ ->
                                                                 assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ), "LABEL (_)"))
                                                       ); Gram.Sself ] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LABEL (i) ->
                                                               ((Ast.PaLab
                                                                  (_loc,
                                                                   i, p)) :
                                                                 'patt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_longident :
                                                             'type_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'type_longident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaTyp
                                                              (_loc, i)) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaVrn
                                                              (_loc, s)) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.patt_tag) :
                                                                'patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaAny
                                                             (_loc)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_patt :
                                                             'comma_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pl :
                                                           'comma_patt) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'patt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaTup
                                                                 (_loc, (
                                                                  (Ast.PaCom
                                                                    (_loc,
                                                                    p,
                                                                    pl))
                                                                  ))) :
                                                                'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("as")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p2 :
                                                           'patt) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'patt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaAli
                                                                 (_loc,
                                                                  p, p2)) :
                                                                'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'patt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaTyc
                                                                 (_loc,
                                                                  p, t)) :
                                                                'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'patt) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (p : 'patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (package_type :
                                                             'package_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pt :
                                                           'package_type) ->
                                                          fun _ ->
                                                           fun (m :
                                                             'a_UIDENT) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.PaTyc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaMod
                                                                    (_loc,
                                                                    m))
                                                                   ), (
                                                                   (Ast.TyPkg
                                                                    (_loc,
                                                                    pt))
                                                                   ))) :
                                                                 'patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (m :
                                                           'a_UIDENT) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.PaMod
                                                                (_loc, m)) :
                                                               'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaId
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "()"))
                                                               ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_patt_list :
                                                             'label_patt_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pl :
                                                           'label_patt_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaRec
                                                               (_loc, pl)) :
                                                              'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[|")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_patt :
                                                             'sem_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("|]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pl :
                                                           'sem_patt) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaArr
                                                               (_loc, pl)) :
                                                              'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[|")) ); (
                                                       (Gram.Skeyword
                                                         ("|]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaArr
                                                              (_loc, (
                                                               (Ast.PaNil
                                                                 (_loc))
                                                               ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_patt_for_list :
                                                             'sem_patt_for_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (mk_list :
                                                           'sem_patt_for_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((mk_list (
                                                               (Ast.PaId
                                                                 (_loc, (
                                                                  (Ast.IdUid
                                                                    (_loc,
                                                                    "[]"))
                                                                  ))) )) :
                                                              'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_patt_for_list :
                                                             'sem_patt_for_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("::")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (last :
                                                           'patt) ->
                                                          fun _ ->
                                                           fun (mk_list :
                                                             'sem_patt_for_list) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((mk_list
                                                                 last) :
                                                                'patt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaId
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "[]"))
                                                               ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_FLOAT :
                                                             'a_FLOAT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_FLOAT) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaFlo
                                                              (_loc, (
                                                               (neg_string
                                                                 s) ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_NATIVEINT :
                                                             'a_NATIVEINT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_NATIVEINT) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaNativeInt
                                                              (_loc, (
                                                               (neg_string
                                                                 s) ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT64 :
                                                             'a_INT64 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT64) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaInt64
                                                              (_loc, (
                                                               (neg_string
                                                                 s) ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT32 :
                                                             'a_INT32 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT32) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaInt32
                                                              (_loc, (
                                                               (neg_string
                                                                 s) ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT :
                                                             'a_INT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaInt
                                                              (_loc, (
                                                               (neg_string
                                                                 s) ))) :
                                                             'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_CHAR :
                                                             'a_CHAR Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_CHAR) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaChr
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_STRING :
                                                             'a_STRING Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_STRING) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaStr
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_FLOAT :
                                                             'a_FLOAT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_FLOAT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaFlo
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_NATIVEINT :
                                                             'a_NATIVEINT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_NATIVEINT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaNativeInt
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT64 :
                                                             'a_INT64 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT64) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaInt64
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT32 :
                                                             'a_INT32 Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT32) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaInt32
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_INT :
                                                             'a_INT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_INT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaInt
                                                             (_loc, s)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ident :
                                                             'ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'ident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaId
                                                             (_loc, i)) :
                                                            'patt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("`bool", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"`bool\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("`bool" as
                                                                n), s) ->
                                                              ((Ast.PaId
                                                                 (_loc, (
                                                                  (Ast.IdAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("tup", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"tup\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("tup" as
                                                                n), s) ->
                                                              ((Ast.PaTup
                                                                 (_loc, (
                                                                  (Ast.PaAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "pat")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"pat\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "pat")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                  ))) :
                                                                'patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (comma_patt :
                                                'comma_patt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'comma_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt,"
                                                                    n s)
                                                                  ))) :
                                                                'comma_patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'comma_patt) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'comma_patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaCom
                                                               (_loc, p1,
                                                                p2)) :
                                                              'comma_patt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sem_patt :
                                                'sem_patt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p : 'sem_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'patt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (p :
                                                             'sem_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt;"
                                                                    n s)
                                                                  ))) :
                                                                'sem_patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'sem_patt) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaSem
                                                               (_loc, p1,
                                                                p2)) :
                                                              'sem_patt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sem_patt_for_list :
                                                'sem_patt_for_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (fun acc ->
                                                            (Ast.PaApp
                                                              (_loc, (
                                                               (Ast.PaApp
                                                                 (_loc, (
                                                                  (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "::"))
                                                                    )))
                                                                  ), p))
                                                               ), acc)) :
                                                            'sem_patt_for_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'patt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (fun acc ->
                                                             (Ast.PaApp
                                                               (_loc, (
                                                                (Ast.PaApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "::"))
                                                                    )))
                                                                   ), p))
                                                                ), acc)) :
                                                             'sem_patt_for_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (pl :
                                                          'sem_patt_for_list) ->
                                                         fun _ ->
                                                          fun (p :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (fun acc ->
                                                              (Ast.PaApp
                                                                (_loc, (
                                                                 (Ast.PaApp
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "::"))
                                                                    )))
                                                                    ), p))
                                                                 ), (
                                                                 (pl acc)
                                                                 ))) :
                                                              'sem_patt_for_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_patt_list :
                                                'label_patt_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_patt :
                                                             'label_patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p1 :
                                                          'label_patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p1 :
                                                            'label_patt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_patt :
                                                             'label_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p1 :
                                                           'label_patt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (p1 :
                                                             'label_patt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_patt :
                                                             'label_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Skeyword
                                                         ("_")) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (p1 :
                                                             'label_patt) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.PaSem
                                                                (_loc,
                                                                 p1, (
                                                                 (Ast.PaAny
                                                                   (_loc))
                                                                 ))) :
                                                               'label_patt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_patt :
                                                             'label_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'label_patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaSem
                                                               (_loc, p1,
                                                                (
                                                                (Ast.PaAny
                                                                  (_loc))
                                                                ))) :
                                                              'label_patt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_patt :
                                                             'label_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'label_patt_list) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'label_patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaSem
                                                               (_loc, p1,
                                                                p2)) :
                                                              'label_patt_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_patt :
                                                'label_patt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_longident :
                                                             'label_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'label_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaEq
                                                             (_loc, i, (
                                                              (Ast.PaId
                                                                (_loc, (
                                                                 (Ast.IdLid
                                                                   (_loc,
                                                                    (
                                                                    (Ident.to_lid
                                                                    i) )))
                                                                 ))) ))) :
                                                            'label_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_longident :
                                                             'label_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'label_longident) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaEq
                                                               (_loc, i,
                                                                p)) :
                                                              'label_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt;"
                                                                    n s)
                                                                  ))) :
                                                                'label_patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.patt_tag) :
                                                                'label_patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "pat")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"pat\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "pat")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                  ))) :
                                                                'label_patt)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ipatt : 'ipatt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaAny
                                                             (_loc)) :
                                                            'ipatt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PaId
                                                             (_loc, (
                                                              (Ast.IdLid
                                                                (_loc, s))
                                                              ))) :
                                                            'ipatt) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_ipatt :
                                                             'comma_ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pl :
                                                           'comma_ipatt) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'ipatt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaTup
                                                                 (_loc, (
                                                                  (Ast.PaCom
                                                                    (_loc,
                                                                    p,
                                                                    pl))
                                                                  ))) :
                                                                'ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("as")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p2 :
                                                           'ipatt) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'ipatt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaAli
                                                                 (_loc,
                                                                  p, p2)) :
                                                                'ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'ipatt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaTyc
                                                                 (_loc,
                                                                  p, t)) :
                                                                'ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'ipatt) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (p : 'ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (package_type :
                                                             'package_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pt :
                                                           'package_type) ->
                                                          fun _ ->
                                                           fun (m :
                                                             'a_UIDENT) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.PaTyc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaMod
                                                                    (_loc,
                                                                    m))
                                                                   ), (
                                                                   (Ast.TyPkg
                                                                    (_loc,
                                                                    pt))
                                                                   ))) :
                                                                 'ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (m :
                                                           'a_UIDENT) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.PaMod
                                                                (_loc, m)) :
                                                               'ipatt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.PaId
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "()"))
                                                               ))) :
                                                             'ipatt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.patt_tag) :
                                                                'ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("tup", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"tup\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("tup" as
                                                                n), s) ->
                                                              ((Ast.PaTup
                                                                 (_loc, (
                                                                  (Ast.PaAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "pat")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"pat\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "pat")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                  ))) :
                                                                'ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_ipatt_list :
                                                             'label_ipatt_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (pl :
                                                           'label_ipatt_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaRec
                                                               (_loc, pl)) :
                                                              'ipatt) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (labeled_ipatt :
                                                'labeled_ipatt Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'ipatt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'labeled_ipatt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (comma_ipatt :
                                                'comma_ipatt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'ipatt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'comma_ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt,"
                                                                    n s)
                                                                  ))) :
                                                                'comma_ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'comma_ipatt) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'comma_ipatt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaCom
                                                               (_loc, p1,
                                                                p2)) :
                                                              'comma_ipatt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_ipatt_list :
                                                'label_ipatt_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_ipatt :
                                                             'label_ipatt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p1 :
                                                          'label_ipatt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p1 :
                                                            'label_ipatt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_ipatt :
                                                             'label_ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p1 :
                                                           'label_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (p1 :
                                                             'label_ipatt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_ipatt :
                                                             'label_ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Skeyword
                                                         ("_")) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (p1 :
                                                             'label_ipatt) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.PaSem
                                                                (_loc,
                                                                 p1, (
                                                                 (Ast.PaAny
                                                                   (_loc))
                                                                 ))) :
                                                               'label_ipatt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_ipatt :
                                                             'label_ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'label_ipatt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaSem
                                                               (_loc, p1,
                                                                (
                                                                (Ast.PaAny
                                                                  (_loc))
                                                                ))) :
                                                              'label_ipatt_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_ipatt :
                                                             'label_ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p2 :
                                                          'label_ipatt_list) ->
                                                         fun _ ->
                                                          fun (p1 :
                                                            'label_ipatt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaSem
                                                               (_loc, p1,
                                                                p2)) :
                                                              'label_ipatt_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_ipatt :
                                                'label_ipatt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_longident :
                                                             'label_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'ipatt) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'label_longident) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaEq
                                                               (_loc, i,
                                                                p)) :
                                                              'label_ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.patt_tag) :
                                                                'label_ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt;"
                                                                    n s)
                                                                  ))) :
                                                                'label_ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "pat")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"pat\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "pat")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.PaAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"patt"
                                                                    n s)
                                                                  ))) :
                                                                'label_ipatt)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_declaration :
                                                'type_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_ident_and_parameters :
                                                             'type_ident_and_parameters Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_eq_ctyp :
                                                             'opt_eq_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Slist0
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (constrain :
                                                                'constrain Gram.t)
                                                              ))))) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (cl :
                                                          'constrain list) ->
                                                         fun (tk :
                                                           'opt_eq_ctyp) ->
                                                          fun ((n, tpl) :
                                                            'type_ident_and_parameters) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyDcl
                                                               (_loc, n,
                                                                tpl, tk,
                                                                cl)) :
                                                              'type_declaration)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'type_declaration) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'type_declaration) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyAnd
                                                               (_loc, t1,
                                                                t2)) :
                                                              'type_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'type_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctypand"
                                                                    n s)
                                                                  ))) :
                                                                'type_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "typ")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"typ\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "typ")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'type_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (constrain :
                                                'constrain Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("constraint"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((t1, t2) :
                                                               'constrain)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_eq_ctyp :
                                                'opt_eq_ctyp Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.TyNil
                                                            (_loc)) :
                                                           'opt_eq_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_kind :
                                                             'type_kind Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (tk :
                                                          'type_kind) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (tk :
                                                             'opt_eq_ctyp)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_kind :
                                                'type_kind Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'type_kind)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_ident_and_parameters :
                                                'type_ident_and_parameters Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Slist0
                                                         ((Gram.Snterm
                                                            (Gram.obj (
                                                              (optional_type_parameter :
                                                                'optional_type_parameter Gram.t)
                                                              ))))) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (tpl :
                                                          'optional_type_parameter list) ->
                                                         fun (i :
                                                           'a_LIDENT) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((i, tpl) :
                                                             'type_ident_and_parameters)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_longident_and_parameters :
                                                'type_longident_and_parameters Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_longident :
                                                             'type_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_parameters :
                                                             'type_parameters Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (tpl :
                                                          'type_parameters) ->
                                                         fun (i :
                                                           'type_longident) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((tpl (
                                                              (Ast.TyId
                                                                (_loc, i))
                                                              )) :
                                                             'type_longident_and_parameters)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_parameters :
                                                'type_parameters Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         (fun t -> t :
                                                           'type_parameters)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_parameter :
                                                             'type_parameter Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'type_parameter) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (fun acc ->
                                                            (Ast.TyApp
                                                              (_loc, acc,
                                                               t)) :
                                                            'type_parameters)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_parameter :
                                                             'type_parameter Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'type_parameters) ->
                                                         fun (t1 :
                                                           'type_parameter) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (fun acc ->
                                                             (t2 (
                                                               (Ast.TyApp
                                                                 (_loc,
                                                                  acc,
                                                                  t1)) )) :
                                                             'type_parameters)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_parameter :
                                                'type_parameter Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyQuM
                                                               (_loc, i)) :
                                                              'type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("+")) ); (
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyQuP
                                                               (_loc, i)) :
                                                              'type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyQuo
                                                              (_loc, i)) :
                                                             'type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'type_parameter)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "typ")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"typ\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "typ")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    n s)
                                                                  ))) :
                                                                'type_parameter)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (optional_type_parameter :
                                                'optional_type_parameter Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyAny
                                                             (_loc)) :
                                                            'optional_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyAnM
                                                              (_loc)) :
                                                             'optional_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("+")) ); (
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyAnP
                                                              (_loc)) :
                                                             'optional_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("-")) ); (
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyQuM
                                                               (_loc, i)) :
                                                              'optional_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("+")) ); (
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyQuP
                                                               (_loc, i)) :
                                                              'optional_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyQuo
                                                              (_loc, i)) :
                                                             'optional_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'optional_type_parameter)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "typ")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"typ\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "typ")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    n s)
                                                                  ))) :
                                                                'optional_type_parameter)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ctyp : 'ctyp Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("==")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("==")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyMan
                                                               (_loc, t1,
                                                                t2)) :
                                                              'ctyp) ))
                                                      ))] ));
                                                   (( (Some ("private"))
                                                    ), ( (Some (`NA)) ),
                                                    (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("private")) );
                                                       (
                                                       (Gram.Snterml
                                                         ((
                                                          (Gram.obj (
                                                            (ctyp :
                                                              'ctyp Gram.t)
                                                            )) ),
                                                          "alias")) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyPrv
                                                              (_loc, t)) :
                                                             'ctyp) )) ))]
                                                    ));
                                                   (( (Some ("alias")) ),
                                                    ( (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("as")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyAli
                                                               (_loc, t1,
                                                                t2)) :
                                                              'ctyp) ))
                                                      ))] ));
                                                   (( (Some ("forall"))
                                                    ), ( (Some (`LA)) ),
                                                    (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("!")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (typevars :
                                                             'typevars Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'typevars) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyPol
                                                                (_loc,
                                                                 t1, t2)) :
                                                               'ctyp) ))
                                                      ))] ));
                                                   (( (Some ("arrow")) ),
                                                    ( (Some (`RA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("->")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyArr
                                                               (_loc, t1,
                                                                t2)) :
                                                              'ctyp) ))
                                                      ))] ));
                                                   (( (Some ("label")) ),
                                                    ( (Some (`NA)) ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_OPTLABEL :
                                                             'a_OPTLABEL Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (i :
                                                           'a_OPTLABEL) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyOlb
                                                              (_loc, i,
                                                               t)) :
                                                             'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyOlb
                                                                (_loc, i,
                                                                 t)) :
                                                               'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LABEL :
                                                             'a_LABEL Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (i :
                                                           'a_LABEL) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyLab
                                                              (_loc, i,
                                                               t)) :
                                                             'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyLab
                                                                (_loc, i,
                                                                 t)) :
                                                               'ctyp) ))
                                                      ))] ));
                                                   (( (Some ("apply")) ),
                                                    ( (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun (t1 :
                                                           'ctyp) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (let t =
                                                             (Ast.TyApp
                                                               (_loc, t1,
                                                                t2)) in
                                                            (try
                                                              (Ast.TyId
                                                                (_loc, (
                                                                 (Ast.ident_of_ctyp
                                                                   t) )))
                                                             with
                                                             Invalid_argument
                                                              (_) ->
                                                              t) : 'ctyp)
                                                        )) ))] ));
                                                   (( (Some (".")) ), (
                                                    (Some (`LA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((try
                                                               (Ast.TyId
                                                                 (_loc, (
                                                                  (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.ident_of_ctyp
                                                                    t1)
                                                                    ), (
                                                                    (Ast.ident_of_ctyp
                                                                    t2)
                                                                    )))
                                                                  )))
                                                              with
                                                              Invalid_argument
                                                               (s) ->
                                                               (raise (
                                                                 (Stream.Error
                                                                   (s))
                                                                 ))) :
                                                              'ctyp) ))
                                                      ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Skeyword
                                                         ("module")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (package_type :
                                                             'package_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'package_type) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyPkg
                                                                (_loc, p)) :
                                                               'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("<")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_meth_list :
                                                             'opt_meth_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (">")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'opt_meth_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (t : 'ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_longident :
                                                             'class_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'class_longident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyCls
                                                              (_loc, i)) :
                                                             'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("{")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_declaration_list :
                                                             'label_declaration_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("}")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'label_declaration_list) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyRec
                                                               (_loc, t)) :
                                                              'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[<")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (">")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (name_tags :
                                                             'name_tags Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (ntl :
                                                           'name_tags) ->
                                                          fun _ ->
                                                           fun (rfl :
                                                             'row_field) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.TyVrnInfSup
                                                                 (_loc,
                                                                  rfl,
                                                                  ntl)) :
                                                                'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[<")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (rfl :
                                                           'row_field) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyVrnInf
                                                               (_loc,
                                                                rfl)) :
                                                              'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         ("<")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (">")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (name_tags :
                                                             'name_tags Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (ntl :
                                                           'name_tags) ->
                                                          fun _ ->
                                                           fun (rfl :
                                                             'row_field) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.TyVrnInfSup
                                                                  (_loc,
                                                                   rfl,
                                                                   ntl)) :
                                                                 'ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         ("<")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (rfl :
                                                           'row_field) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyVrnInf
                                                                (_loc,
                                                                 rfl)) :
                                                               'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         (">")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (rfl :
                                                           'row_field) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyVrnSup
                                                                (_loc,
                                                                 rfl)) :
                                                               'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         (">")) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyVrnSup
                                                               (_loc, (
                                                                (Ast.TyNil
                                                                  (_loc))
                                                                ))) :
                                                              'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (rfl :
                                                           'row_field) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyVrnEq
                                                                (_loc,
                                                                 rfl)) :
                                                               'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_declarations :
                                                             'constructor_declarations Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'constructor_declarations) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TySum
                                                               (_loc, t)) :
                                                              'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TySum
                                                              (_loc, (
                                                               (Ast.TyNil
                                                                 (_loc))
                                                               ))) :
                                                             'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (t : 'ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("*")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (star_ctyp :
                                                             'star_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (tl :
                                                           'star_ctyp) ->
                                                          fun _ ->
                                                           fun (t :
                                                             'ctyp) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.TyTup
                                                                 (_loc, (
                                                                  (Ast.TySta
                                                                    (_loc,
                                                                    t,
                                                                    tl))
                                                                  ))) :
                                                                'ctyp) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyId
                                                             (_loc, (
                                                              (Ast.IdUid
                                                                (_loc, i))
                                                              ))) :
                                                            'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyId
                                                             (_loc, (
                                                              (Ast.IdLid
                                                                (_loc, i))
                                                              ))) :
                                                            'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("id", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"id\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("id" as
                                                                n), s) ->
                                                              ((Ast.TyId
                                                                 (_loc, (
                                                                  (Ast.IdAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("tup", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"tup\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("tup" as
                                                                n), s) ->
                                                              ((Ast.TyTup
                                                                 (_loc, (
                                                                  (Ast.TyAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                    )))
                                                                  ))) :
                                                                'ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "typ")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"typ\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "typ")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("_")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyAny
                                                             (_loc)) :
                                                            'ctyp) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyQuo
                                                              (_loc, i)) :
                                                             'ctyp) )) ))]
                                                    ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (star_ctyp :
                                                'star_ctyp Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'star_ctyp)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("*")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'star_ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'star_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TySta
                                                               (_loc, t1,
                                                                t2)) :
                                                              'star_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp*"
                                                                    n s)
                                                                  ))) :
                                                                'star_ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'star_ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (constructor_declarations :
                                                'constructor_declarations Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyId
                                                             (_loc, (
                                                              (Ast.IdUid
                                                                (_loc, s))
                                                              ))) :
                                                            'constructor_declarations)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (s :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (let (tl, rt) =
                                                              (Ctyp.to_generalized
                                                                t) in
                                                             (Ast.TyCol
                                                               (_loc, (
                                                                (Ast.TyId
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    s))
                                                                   ))) ),
                                                                (
                                                                (Ast.TyArr
                                                                  (_loc,
                                                                   (
                                                                   (Ast.tyAnd_of_list
                                                                    tl)
                                                                   ), rt))
                                                                ))) :
                                                              'constructor_declarations)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_arg_list :
                                                             'constructor_arg_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'constructor_arg_list) ->
                                                         fun _ ->
                                                          fun (s :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyOf
                                                               (_loc, (
                                                                (Ast.TyId
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    s))
                                                                   ))) ),
                                                                t)) :
                                                              'constructor_declarations)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("|")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'constructor_declarations) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'constructor_declarations) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyOr
                                                               (_loc, t1,
                                                                t2)) :
                                                              'constructor_declarations)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'constructor_declarations)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp|"
                                                                    n s)
                                                                  ))) :
                                                                'constructor_declarations)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'constructor_declarations)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (constructor_declaration :
                                                'constructor_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (s :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyId
                                                             (_loc, (
                                                              (Ast.IdUid
                                                                (_loc, s))
                                                              ))) :
                                                            'constructor_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_arg_list :
                                                             'constructor_arg_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'constructor_arg_list) ->
                                                         fun _ ->
                                                          fun (s :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyOf
                                                               (_loc, (
                                                                (Ast.TyId
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    s))
                                                                   ))) ),
                                                                t)) :
                                                              'constructor_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'constructor_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'constructor_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (constructor_arg_list :
                                                'constructor_arg_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'constructor_arg_list)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'constructor_arg_list) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'constructor_arg_list) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyAnd
                                                               (_loc, t1,
                                                                t2)) :
                                                              'constructor_arg_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctypand"
                                                                    n s)
                                                                  ))) :
                                                                'constructor_arg_list)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_declaration_list :
                                                'label_declaration_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_declaration :
                                                             'label_declaration Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t1 :
                                                          'label_declaration) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t1 :
                                                            'label_declaration_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_declaration :
                                                             'label_declaration Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t1 :
                                                           'label_declaration) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (t1 :
                                                             'label_declaration_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_declaration :
                                                             'label_declaration Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'label_declaration_list) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'label_declaration) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TySem
                                                               (_loc, t1,
                                                                t2)) :
                                                              'label_declaration_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_declaration :
                                                'label_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Skeyword
                                                         ("mutable")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (s :
                                                             'a_LIDENT) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyCol
                                                                (_loc, (
                                                                 (Ast.TyId
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdLid
                                                                    (_loc,
                                                                    s))
                                                                    )))
                                                                 ), (
                                                                 (Ast.TyMut
                                                                   (_loc,
                                                                    t))
                                                                 ))) :
                                                               'label_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (s :
                                                            'a_LIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyCol
                                                               (_loc, (
                                                                (Ast.TyId
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    s))
                                                                   ))) ),
                                                                t)) :
                                                              'label_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'label_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp;"
                                                                    n s)
                                                                  ))) :
                                                                'label_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'label_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_ident : 'a_ident Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (i : 'a_ident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (i : 'a_ident)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ident : 'ident Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'ident) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   i)) ),
                                                                j)) :
                                                              'ident) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'ident) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "id")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.IdAcc
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                    )))
                                                                    ), i)) :
                                                                  'ident)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdLid
                                                             (_loc, i)) :
                                                            'ident) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdUid
                                                             (_loc, i)) :
                                                            'ident) )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "id")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.IdAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                  ))) :
                                                                'ident)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_longident :
                                                'module_longident Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdUid
                                                             (_loc, i)) :
                                                            'module_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'module_longident) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   m)) ),
                                                                l)) :
                                                              'module_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "id")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.IdAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                  ))) :
                                                                'module_longident)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_longident_with_app :
                                                'module_longident_with_app Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("apply")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'module_longident_with_app) ->
                                                         fun (i :
                                                           'module_longident_with_app) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.IdApp
                                                              (_loc, i,
                                                               j)) :
                                                             'module_longident_with_app)
                                                        )) ))] ));
                                                   (( (Some (".")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'module_longident_with_app) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'module_longident_with_app) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, i,
                                                                j)) :
                                                              'module_longident_with_app)
                                                        )) ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (i :
                                                           'module_longident_with_app) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (i :
                                                              'module_longident_with_app)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdUid
                                                             (_loc, i)) :
                                                            'module_longident_with_app)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "id")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.IdAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                  ))) :
                                                                'module_longident_with_app)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_longident_dot_lparen :
                                                'module_longident_dot_lparen Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdUid
                                                               (_loc, i)) :
                                                              'module_longident_dot_lparen)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'module_longident_dot_lparen) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   m)) ),
                                                                l)) :
                                                              'module_longident_dot_lparen)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (".")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "id")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.IdAnt
                                                                   (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                    ))) :
                                                                  'module_longident_dot_lparen)
                                                             | _ ->
                                                                assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_longident :
                                                'type_longident Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("apply")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'type_longident) ->
                                                         fun (i :
                                                           'type_longident) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.IdApp
                                                              (_loc, i,
                                                               j)) :
                                                             'type_longident)
                                                        )) ))] ));
                                                   (( (Some (".")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'type_longident) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'type_longident) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, i,
                                                                j)) :
                                                              'type_longident)
                                                        )) ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (i :
                                                           'type_longident) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (i :
                                                              'type_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdUid
                                                             (_loc, i)) :
                                                            'type_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdLid
                                                             (_loc, i)) :
                                                            'type_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "id")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.IdAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                  ))) :
                                                                'type_longident)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label_longident :
                                                'label_longident Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdLid
                                                             (_loc, i)) :
                                                            'label_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'label_longident) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   m)) ),
                                                                l)) :
                                                              'label_longident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "id")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.IdAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                  ))) :
                                                                'label_longident)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_type_longident :
                                                'class_type_longident Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_longident :
                                                             'type_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'type_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'class_type_longident)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (val_longident :
                                                'val_longident Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ident :
                                                             'ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'ident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'val_longident)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_longident :
                                                'class_longident Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_longident :
                                                             'label_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'label_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'class_longident)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_declaration :
                                                'class_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_info_for_class_expr :
                                                             'class_info_for_class_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_fun_binding :
                                                             'class_fun_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_fun_binding) ->
                                                         fun (ci :
                                                           'class_info_for_class_expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CeEq
                                                              (_loc, ci,
                                                               ce)) :
                                                             'class_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_expr_tag) :
                                                                'class_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "cdcl")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"cdcl\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "cdcl")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CeAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_expr"
                                                                    n s)
                                                                  ))) :
                                                                'class_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (c2 :
                                                          'class_declaration) ->
                                                         fun _ ->
                                                          fun (c1 :
                                                            'class_declaration) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CeAnd
                                                               (_loc, c1,
                                                                c2)) :
                                                              'class_declaration)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_fun_binding :
                                                'class_fun_binding Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (labeled_ipatt :
                                                             'labeled_ipatt Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (cfb :
                                                          'class_fun_binding) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CeFun
                                                              (_loc, p,
                                                               cfb)) :
                                                             'class_fun_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_plus :
                                                             'class_type_plus Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_expr :
                                                             'class_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_expr) ->
                                                         fun _ ->
                                                          fun (ct :
                                                            'class_type_plus) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CeTyc
                                                                (_loc,
                                                                 ce, ct)) :
                                                               'class_fun_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_expr :
                                                             'class_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (ce :
                                                             'class_fun_binding)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_info_for_class_type :
                                                'class_info_for_class_type Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_virtual :
                                                             'opt_virtual Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_name_and_param :
                                                             'class_name_and_param Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((i, ot) :
                                                          'class_name_and_param) ->
                                                         fun (mv :
                                                           'opt_virtual) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CtCon
                                                              (_loc, mv,
                                                               (
                                                               (Ast.IdLid
                                                                 (_loc,
                                                                  i)) ),
                                                               ot)) :
                                                             'class_info_for_class_type)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_info_for_class_expr :
                                                'class_info_for_class_expr Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_virtual :
                                                             'opt_virtual Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_name_and_param :
                                                             'class_name_and_param Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((i, ot) :
                                                          'class_name_and_param) ->
                                                         fun (mv :
                                                           'opt_virtual) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CeCon
                                                              (_loc, mv,
                                                               (
                                                               (Ast.IdLid
                                                                 (_loc,
                                                                  i)) ),
                                                               ot)) :
                                                             'class_info_for_class_expr)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_name_and_param :
                                                'class_name_and_param Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((i, (
                                                            (Ast.TyNil
                                                              (_loc)) )) :
                                                            'class_name_and_param)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_type_parameter :
                                                             'comma_type_parameter Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (x :
                                                           'comma_type_parameter) ->
                                                          fun _ ->
                                                           fun (i :
                                                             'a_LIDENT) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((i, x) :
                                                               'class_name_and_param)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (comma_type_parameter :
                                                'comma_type_parameter Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_parameter :
                                                             'type_parameter Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'type_parameter) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'comma_type_parameter)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp,"
                                                                    n s)
                                                                  ))) :
                                                                'comma_type_parameter)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'comma_type_parameter) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'comma_type_parameter) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyCom
                                                               (_loc, t1,
                                                                t2)) :
                                                              'comma_type_parameter)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_comma_ctyp :
                                                'opt_comma_ctyp Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.TyNil
                                                            (_loc)) :
                                                           'opt_comma_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_ctyp :
                                                             'comma_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (x :
                                                           'comma_ctyp) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (x :
                                                              'opt_comma_ctyp)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (comma_ctyp :
                                                'comma_ctyp Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'comma_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp,"
                                                                    n s)
                                                                  ))) :
                                                                'comma_ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (",")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'comma_ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'comma_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyCom
                                                               (_loc, t1,
                                                                t2)) :
                                                              'comma_ctyp)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_fun_def :
                                                'class_fun_def Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("->")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_expr :
                                                             'class_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (ce :
                                                             'class_fun_def)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (labeled_ipatt :
                                                             'labeled_ipatt Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_fun_def) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CeFun
                                                              (_loc, p,
                                                               ce)) :
                                                             'class_fun_def)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_expr :
                                                'class_expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("top")) ),
                                                    None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("let")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("in")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_expr) ->
                                                         fun _ ->
                                                          fun (bi :
                                                            'binding) ->
                                                           fun (rf :
                                                             'opt_rec) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.CeLet
                                                                 (_loc,
                                                                  rf, bi,
                                                                  ce)) :
                                                                'class_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("fun")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (labeled_ipatt :
                                                             'labeled_ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_fun_def :
                                                             'class_fun_def Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_fun_def) ->
                                                         fun (p :
                                                           'labeled_ipatt) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CeFun
                                                               (_loc, p,
                                                                ce)) :
                                                              'class_expr)
                                                        )) ))] ));
                                                   (( (Some ("apply")) ),
                                                    ( (Some (`NA)) ), (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Snterml
                                                         ((
                                                          (Gram.obj (
                                                            (expr :
                                                              'expr Gram.t)
                                                            )) ),
                                                          "label")) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (ce :
                                                           'class_expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CeApp
                                                              (_loc, ce,
                                                               e)) :
                                                             'class_expr)
                                                        )) ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (ce :
                                                           'class_expr) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (ce :
                                                              'class_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type :
                                                             'class_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (ct :
                                                           'class_type) ->
                                                          fun _ ->
                                                           fun (ce :
                                                             'class_expr) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.CeTyc
                                                                 (_loc,
                                                                  ce, ct)) :
                                                                'class_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("object")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_class_self_patt :
                                                             'opt_class_self_patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_structure :
                                                             'class_structure Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (cst :
                                                           'class_structure) ->
                                                          fun (csp :
                                                            'opt_class_self_patt) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CeStr
                                                                (_loc,
                                                                 csp,
                                                                 cst)) :
                                                               'class_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_longident_and_param :
                                                             'class_longident_and_param Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ce :
                                                          'class_longident_and_param) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (ce :
                                                            'class_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_expr_tag) :
                                                                'class_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "cexp")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"cexp\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "cexp")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.CeAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_expr"
                                                                    n s)
                                                                  ))) :
                                                                'class_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_longident_and_param :
                                                'class_longident_and_param Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_longident :
                                                             'class_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ci :
                                                          'class_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.CeCon
                                                             (_loc,
                                                              Ast.ViNil ,
                                                              ci, (
                                                              (Ast.TyNil
                                                                (_loc))
                                                              ))) :
                                                            'class_longident_and_param)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_longident :
                                                             'class_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_ctyp :
                                                             'comma_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'comma_ctyp) ->
                                                          fun _ ->
                                                           fun (ci :
                                                             'class_longident) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CeCon
                                                                (_loc,
                                                                 Ast.ViNil
                                                                 , ci, t)) :
                                                               'class_longident_and_param)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_structure :
                                                'class_structure Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Slist0
                                                         (Gram.srules
                                                           class_structure
                                                           (
                                                           [((
                                                             [(
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (class_str_item :
                                                                    'class_str_item Gram.t)
                                                                  ))) );
                                                              (
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (semi :
                                                                    'semi Gram.t)
                                                                  ))) )]
                                                             ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun (cst :
                                                                  'class_str_item) ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (cst :
                                                                    'e__23)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'e__23 list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.crSem_of_list
                                                             l) :
                                                            'class_structure)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "cst")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"cst\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (cst :
                                                          'class_structure) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "cst")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.CrSem
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.CrAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"class_str_item"
                                                                    n s)
                                                                    )))
                                                                    ),
                                                                    cst)) :
                                                                  'class_structure)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "cst")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"cst\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "cst")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CrAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_str_item"
                                                                    n s)
                                                                  ))) :
                                                                'class_structure)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_class_self_patt :
                                                'opt_class_self_patt Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.PaNil
                                                            (_loc)) :
                                                           'opt_class_self_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'patt) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.PaTyc
                                                                 (_loc,
                                                                  p, t)) :
                                                                'opt_class_self_patt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'patt) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (p :
                                                              'opt_class_self_patt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_str_item :
                                                'class_str_item Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("initializer"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (se :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CrIni
                                                              (_loc, se)) :
                                                             'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_constraint :
                                                             'type_constraint Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CrCtr
                                                                (_loc,
                                                                 t1, t2)) :
                                                               'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (method_opt_override :
                                                             'method_opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun _ ->
                                                            fun (pf :
                                                              'opt_private) ->
                                                             fun (o :
                                                               'method_opt_override) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               (if (o <>
                                                                    Ast.OvNil
                                                                    ) then
                                                                 (
                                                                 (raise (
                                                                   (Stream.Error
                                                                    ("override (!) is incompatible with virtual"))
                                                                   ))
                                                                 )
                                                                else
                                                                 (Ast.CrVir
                                                                   (_loc,
                                                                    l,
                                                                    pf,
                                                                    t)) :
                                                                 'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (method_opt_override :
                                                             'method_opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_polyt :
                                                             'opt_polyt Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (fun_binding :
                                                             'fun_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'fun_binding) ->
                                                         fun (topt :
                                                           'opt_polyt) ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (pf :
                                                             'opt_private) ->
                                                            fun (o :
                                                              'method_opt_override) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.CrMth
                                                                 (_loc,
                                                                  l, o,
                                                                  pf, e,
                                                                  topt)) :
                                                                'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (method_opt_override :
                                                             'method_opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (pf :
                                                             'opt_private) ->
                                                            fun _ ->
                                                             fun (o :
                                                               'method_opt_override) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               (if (o <>
                                                                    Ast.OvNil
                                                                    ) then
                                                                 (
                                                                 (raise (
                                                                   (Stream.Error
                                                                    ("override (!) is incompatible with virtual"))
                                                                   ))
                                                                 )
                                                                else
                                                                 (Ast.CrVir
                                                                   (_loc,
                                                                    l,
                                                                    pf,
                                                                    t)) :
                                                                 'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (value_val_opt_override :
                                                             'value_val_opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_mutable :
                                                             'opt_mutable Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (mf :
                                                             'opt_mutable) ->
                                                            fun _ ->
                                                             fun (o :
                                                               'value_val_opt_override) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               (if (o <>
                                                                    Ast.OvNil
                                                                    ) then
                                                                 (
                                                                 (raise (
                                                                   (Stream.Error
                                                                    ("override (!) is incompatible with virtual"))
                                                                   ))
                                                                 )
                                                                else
                                                                 (Ast.CrVvr
                                                                   (_loc,
                                                                    l,
                                                                    mf,
                                                                    t)) :
                                                                 'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (value_val_opt_override :
                                                             'value_val_opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_mutable :
                                                             'opt_mutable Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun _ ->
                                                            fun (mf :
                                                              'opt_mutable) ->
                                                             fun (o :
                                                               'value_val_opt_override) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               (if (o <>
                                                                    Ast.OvNil
                                                                    ) then
                                                                 (
                                                                 (raise (
                                                                   (Stream.Error
                                                                    ("override (!) is incompatible with virtual"))
                                                                   ))
                                                                 )
                                                                else
                                                                 (Ast.CrVvr
                                                                   (_loc,
                                                                    l,
                                                                    mf,
                                                                    t)) :
                                                                 'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (value_val_opt_override :
                                                             'value_val_opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_mutable :
                                                             'opt_mutable Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (cvalue_binding :
                                                             'cvalue_binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'cvalue_binding) ->
                                                         fun (lab :
                                                           'label) ->
                                                          fun (mf :
                                                            'opt_mutable) ->
                                                           fun (o :
                                                             'value_val_opt_override) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CrVal
                                                                (_loc,
                                                                 lab, o,
                                                                 mf, e)) :
                                                               'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("inherit")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_override :
                                                             'opt_override Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_expr :
                                                             'class_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_as_lident :
                                                             'opt_as_lident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (pb :
                                                          'opt_as_lident) ->
                                                         fun (ce :
                                                           'class_expr) ->
                                                          fun (o :
                                                            'opt_override) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CrInh
                                                                (_loc, o,
                                                                 ce, pb)) :
                                                               'class_str_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_str_item_tag) :
                                                                'class_str_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "cst")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"cst\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "cst")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CrAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_str_item"
                                                                    n s)
                                                                  ))) :
                                                                'class_str_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (method_opt_override :
                                                'method_opt_override Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("method")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.OvNil) :
                                                            'method_opt_override)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("method")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((("!"
                                                                | "override")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"!\" | \"override\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | ANTIQUOT
                                                               (((("!"
                                                                   | "override")
                                                                  | "anti") as
                                                                 n), s) ->
                                                               ((Ast.OvAnt
                                                                  (mk_anti
                                                                    n s)) :
                                                                 'method_opt_override)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("method")) ); (
                                                       (Gram.Skeyword
                                                         ("!")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.OvOverride) :
                                                             'method_opt_override)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (value_val_opt_override :
                                                'value_val_opt_override Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("val")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.OvNil) :
                                                            'value_val_opt_override)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("val")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((("!"
                                                                | "override")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"!\" | \"override\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | ANTIQUOT
                                                               (((("!"
                                                                   | "override")
                                                                  | "anti") as
                                                                 n), s) ->
                                                               ((Ast.OvAnt
                                                                  (mk_anti
                                                                    n s)) :
                                                                 'value_val_opt_override)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("val")) ); (
                                                       (Gram.Skeyword
                                                         ("!")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.OvOverride) :
                                                             'value_val_opt_override)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_as_lident :
                                                'opt_as_lident Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ("" :
                                                           'opt_as_lident)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("as")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (i :
                                                             'opt_as_lident)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_polyt :
                                                'opt_polyt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.TyNil
                                                            (_loc)) :
                                                           'opt_polyt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (t :
                                                             'opt_polyt)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (cvalue_binding :
                                                'cvalue_binding Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":>")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (t :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExCoe
                                                                (_loc, e,
                                                                 (
                                                                 (Ast.TyNil
                                                                   (_loc))
                                                                 ), t)) :
                                                               'cvalue_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":>")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (t2 :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (t :
                                                              'poly_type) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((match
                                                                   t with
                                                                 | Ast.TyPol
                                                                    (_,
                                                                    _, _) ->
                                                                    (raise
                                                                    (
                                                                    (Stream.Error
                                                                    ("unexpected polytype here"))
                                                                    ))
                                                                 | _ ->
                                                                    (
                                                                    Ast.ExCoe
                                                                    (_loc,
                                                                    e, t,
                                                                    t2))) :
                                                                 'cvalue_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (t :
                                                            'poly_type) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.ExTyc
                                                                (_loc, e,
                                                                 t)) :
                                                               'cvalue_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Skeyword
                                                         ("type")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (unquoted_typevars :
                                                             'unquoted_typevars Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (".")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (t2 :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (t1 :
                                                              'unquoted_typevars) ->
                                                             fun _ ->
                                                              fun _ ->
                                                               fun (_loc :
                                                                 FanLoc.t) ->
                                                                (let u =
                                                                  (Ast.TyPol
                                                                    (_loc,
                                                                    t1,
                                                                    t2)) in
                                                                 (Ast.ExTyc
                                                                   (_loc,
                                                                    e, u)) :
                                                                  'cvalue_binding)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (e :
                                                             'cvalue_binding)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (label : 'label Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (i : 'label) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_type :
                                                'class_type Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("object")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_class_self_type :
                                                             'opt_class_self_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_signature :
                                                             'class_signature Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("end")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (csg :
                                                           'class_signature) ->
                                                          fun (cst :
                                                            'opt_class_self_type) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CtSig
                                                                (_loc,
                                                                 cst,
                                                                 csg)) :
                                                               'class_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_longident_and_param :
                                                             'class_type_longident_and_param Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ct :
                                                          'class_type_longident_and_param) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (ct :
                                                            'class_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_type_tag) :
                                                                'class_type)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "ctyp")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"ctyp\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "ctyp")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.CtAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_type"
                                                                    n s)
                                                                  ))) :
                                                                'class_type)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_type_longident_and_param :
                                                'class_type_longident_and_param Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_longident :
                                                             'class_type_longident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'class_type_longident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.CtCon
                                                             (_loc,
                                                              Ast.ViNil ,
                                                              i, (
                                                              (Ast.TyNil
                                                                (_loc))
                                                              ))) :
                                                            'class_type_longident_and_param)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_longident :
                                                             'class_type_longident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_ctyp :
                                                             'comma_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'comma_ctyp) ->
                                                          fun _ ->
                                                           fun (i :
                                                             'class_type_longident) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CtCon
                                                                (_loc,
                                                                 Ast.ViNil
                                                                 , i, t)) :
                                                               'class_type_longident_and_param)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_type_plus :
                                                'class_type_plus Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type :
                                                             'class_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ct :
                                                          'class_type) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (ct :
                                                            'class_type_plus)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("[")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("]")) ); (
                                                       (Gram.Skeyword
                                                         ("->")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ct :
                                                          'class_type_plus) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (t :
                                                             'ctyp) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.CtFun
                                                                 (_loc,
                                                                  t, ct)) :
                                                                'class_type_plus)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_class_self_type :
                                                'opt_class_self_type Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.TyNil
                                                            (_loc)) :
                                                           'opt_class_self_type)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (t :
                                                           'ctyp) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (t :
                                                              'opt_class_self_type)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_signature :
                                                'class_signature Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Slist0
                                                         (Gram.srules
                                                           class_signature
                                                           (
                                                           [((
                                                             [(
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (class_sig_item :
                                                                    'class_sig_item Gram.t)
                                                                  ))) );
                                                              (
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (semi :
                                                                    'semi Gram.t)
                                                                  ))) )]
                                                             ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun (csg :
                                                                  'class_sig_item) ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (csg :
                                                                    'e__24)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'e__24 list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.cgSem_of_list
                                                             l) :
                                                            'class_signature)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "csg")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"csg\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (csg :
                                                          'class_signature) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "csg")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.CgSem
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.CgAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"class_sig_item"
                                                                    n s)
                                                                    )))
                                                                    ),
                                                                    csg)) :
                                                                  'class_signature)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "csg")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"csg\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "csg")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CgAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_sig_item"
                                                                    n s)
                                                                  ))) :
                                                                'class_signature)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_sig_item :
                                                'class_sig_item Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_constraint :
                                                             'type_constraint Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'ctyp) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.CgCtr
                                                                (_loc,
                                                                 t1, t2)) :
                                                               'class_sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("method")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun _ ->
                                                            fun (pf :
                                                              'opt_private) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.CgVir
                                                                  (_loc,
                                                                   l, pf,
                                                                   t)) :
                                                                 'class_sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("method")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (pf :
                                                             'opt_private) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.CgMth
                                                                 (_loc,
                                                                  l, pf,
                                                                  t)) :
                                                                'class_sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("method")) ); (
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (pf :
                                                             'opt_private) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.CgVir
                                                                  (_loc,
                                                                   l, pf,
                                                                   t)) :
                                                                 'class_sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("val")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_mutable :
                                                             'opt_mutable Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_virtual :
                                                             'opt_virtual Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (mv :
                                                             'opt_virtual) ->
                                                            fun (mf :
                                                              'opt_mutable) ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.CgVal
                                                                  (_loc,
                                                                   l, mf,
                                                                   mv, t)) :
                                                                 'class_sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("inherit")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type :
                                                             'class_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (cs :
                                                          'class_type) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CgInh
                                                              (_loc, cs)) :
                                                             'class_sig_item)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_sig_item_tag) :
                                                                'class_sig_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "csg")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"csg\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "csg")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CgAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_sig_item"
                                                                    n s)
                                                                  ))) :
                                                                'class_sig_item)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (type_constraint :
                                                'type_constraint Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("constraint"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (() :
                                                            'type_constraint)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("type")) )] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (() :
                                                            'type_constraint)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_description :
                                                'class_description Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_info_for_class_type :
                                                             'class_info_for_class_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_plus :
                                                             'class_type_plus Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ct :
                                                          'class_type_plus) ->
                                                         fun _ ->
                                                          fun (ci :
                                                            'class_info_for_class_type) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtCol
                                                               (_loc, ci,
                                                                ct)) :
                                                              'class_description)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_type_tag) :
                                                                'class_description)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "typ")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"typ\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "typ")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CtAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_type"
                                                                    n s)
                                                                  ))) :
                                                                'class_description)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (cd2 :
                                                          'class_description) ->
                                                         fun _ ->
                                                          fun (cd1 :
                                                            'class_description) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtAnd
                                                               (_loc,
                                                                cd1, cd2)) :
                                                              'class_description)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_type_declaration :
                                                'class_type_declaration Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_info_for_class_type :
                                                             'class_info_for_class_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type :
                                                             'class_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ct :
                                                          'class_type) ->
                                                         fun _ ->
                                                          fun (ci :
                                                            'class_info_for_class_type) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtEq
                                                               (_loc, ci,
                                                                ct)) :
                                                              'class_type_declaration)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.class_type_tag) :
                                                                'class_type_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "typ")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"typ\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "typ")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.CtAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"class_type"
                                                                    n s)
                                                                  ))) :
                                                                'class_type_declaration)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (cd2 :
                                                          'class_type_declaration) ->
                                                         fun _ ->
                                                          fun (cd1 :
                                                            'class_type_declaration) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtAnd
                                                               (_loc,
                                                                cd1, cd2)) :
                                                              'class_type_declaration)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (field_expr_list :
                                                'field_expr_list Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (field_expr :
                                                             'field_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (b1 :
                                                          'field_expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (b1 :
                                                            'field_expr_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (field_expr :
                                                             'field_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (b1 :
                                                           'field_expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (b1 :
                                                             'field_expr_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (field_expr :
                                                             'field_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (b2 :
                                                          'field_expr_list) ->
                                                         fun _ ->
                                                          fun (b1 :
                                                            'field_expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.RbSem
                                                               (_loc, b1,
                                                                b2)) :
                                                              'field_expr_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (field_expr :
                                                'field_expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label :
                                                             'label Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterml
                                                         ((
                                                          (Gram.obj (
                                                            (expr :
                                                              'expr Gram.t)
                                                            )) ), "top"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (l :
                                                            'label) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.RbEq
                                                               (_loc, (
                                                                (Ast.IdLid
                                                                  (_loc,
                                                                   l)) ),
                                                                e)) :
                                                              'field_expr)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.RbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"rec_binding"
                                                                    n s)
                                                                  ))) :
                                                                'field_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "bi")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"bi\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "bi")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.RbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"rec_binding"
                                                                    n s)
                                                                  ))) :
                                                                'field_expr)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (meth_list :
                                                'meth_list Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (meth_decl :
                                                             'meth_decl Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_dot_dot :
                                                             'opt_dot_dot Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (v :
                                                          'opt_dot_dot) ->
                                                         fun (m :
                                                           'meth_decl) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((m, v) :
                                                             'meth_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (meth_decl :
                                                             'meth_decl Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_dot_dot :
                                                             'opt_dot_dot Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (v :
                                                          'opt_dot_dot) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'meth_decl) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((m, v) :
                                                              'meth_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (meth_decl :
                                                             'meth_decl Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun ((ml, v) :
                                                          'meth_list) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'meth_decl) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (((
                                                              (Ast.TySem
                                                                (_loc, m,
                                                                 ml)) ),
                                                              v) :
                                                              'meth_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (meth_decl :
                                                'meth_decl Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (poly_type :
                                                             'poly_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'poly_type) ->
                                                         fun _ ->
                                                          fun (lab :
                                                            'a_LIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyCol
                                                               (_loc, (
                                                                (Ast.TyId
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    lab))
                                                                   ))) ),
                                                                t)) :
                                                              'meth_decl)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'meth_decl)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp;"
                                                                    n s)
                                                                  ))) :
                                                                'meth_decl)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'meth_decl)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_meth_list :
                                                'opt_meth_list Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_dot_dot :
                                                             'opt_dot_dot Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (v :
                                                          'opt_dot_dot) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyObj
                                                             (_loc, (
                                                              (Ast.TyNil
                                                                (_loc))
                                                              ), v)) :
                                                            'opt_meth_list)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (meth_list :
                                                             'meth_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((ml, v) :
                                                          'meth_list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyObj
                                                             (_loc, ml,
                                                              v)) :
                                                            'opt_meth_list)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (poly_type :
                                                'poly_type Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'poly_type)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (package_type :
                                                'package_type Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'module_type) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'package_type)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (typevars :
                                                'typevars Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("'")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyQuo
                                                              (_loc, i)) :
                                                             'typevars)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'typevars)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'typevars)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'typevars) ->
                                                         fun (t1 :
                                                           'typevars) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyApp
                                                              (_loc, t1,
                                                               t2)) :
                                                             'typevars)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (unquoted_typevars :
                                                'unquoted_typevars Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , ( (Some (`LA))
                                                    ), (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.TyId
                                                             (_loc, (
                                                              (Ast.IdLid
                                                                (_loc, i))
                                                              ))) :
                                                            'unquoted_typevars)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | QUOTATION (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "QUOTATION (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | QUOTATION
                                                              (x) ->
                                                              ((Quotation.expand
                                                                 _loc x
                                                                 DynAst.ctyp_tag) :
                                                                'unquoted_typevars)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'unquoted_typevars)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'unquoted_typevars) ->
                                                         fun (t1 :
                                                           'unquoted_typevars) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyApp
                                                              (_loc, t1,
                                                               t2)) :
                                                             'unquoted_typevars)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (row_field :
                                                'row_field Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t :
                                                            'row_field)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (amp_ctyp :
                                                             'amp_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'amp_ctyp) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'a_ident) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyOf
                                                                (_loc, (
                                                                 (Ast.TyVrn
                                                                   (_loc,
                                                                    i))
                                                                 ), t)) :
                                                               'row_field)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Skeyword
                                                         ("&")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (amp_ctyp :
                                                             'amp_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'amp_ctyp) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (i :
                                                             'a_ident) ->
                                                            fun _ ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.TyOfAmp
                                                                 (_loc, (
                                                                  (Ast.TyVrn
                                                                    (_loc,
                                                                    i))
                                                                  ), t)) :
                                                                'row_field)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyVrn
                                                              (_loc, i)) :
                                                             'row_field)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("|")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'row_field) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'row_field) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyOr
                                                               (_loc, t1,
                                                                t2)) :
                                                              'row_field)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp|"
                                                                    n s)
                                                                  ))) :
                                                                'row_field)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'row_field)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (amp_ctyp :
                                                'amp_ctyp Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (t : 'amp_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("list", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"list\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("list" as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp&"
                                                                    n s)
                                                                  ))) :
                                                                'amp_ctyp)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("&")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'amp_ctyp) ->
                                                         fun _ ->
                                                          fun (t1 :
                                                            'amp_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyAmp
                                                               (_loc, t1,
                                                                t2)) :
                                                              'amp_ctyp)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (name_tags :
                                                'name_tags Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyVrn
                                                              (_loc, i)) :
                                                             'name_tags)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (t2 :
                                                          'name_tags) ->
                                                         fun (t1 :
                                                           'name_tags) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyApp
                                                              (_loc, t1,
                                                               t2)) :
                                                             'name_tags)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "typ"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"typ\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "typ") as
                                                                n), s) ->
                                                              ((Ast.TyAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ctyp"
                                                                    n s)
                                                                  ))) :
                                                                'name_tags)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (eq_expr : 'eq_expr Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         (fun i ->
                                                           fun p ->
                                                            (Ast.PaOlb
                                                              (_loc, i,
                                                               p)) :
                                                           'eq_expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (fun i ->
                                                             fun p ->
                                                              (Ast.PaOlbi
                                                                (_loc, i,
                                                                 p, e)) :
                                                             'eq_expr) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (patt_tcon :
                                                'patt_tcon Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'patt_tcon)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (p :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaTyc
                                                               (_loc, p,
                                                                t)) :
                                                              'patt_tcon)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ipatt : 'ipatt Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt_tcon :
                                                             'ipatt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (e :
                                                           'expr) ->
                                                          fun _ ->
                                                           fun (p :
                                                             'ipatt_tcon) ->
                                                            fun _ ->
                                                             fun _ ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.PaOlbi
                                                                  (_loc,
                                                                   "", p,
                                                                   e)) :
                                                                 'ipatt)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt_tcon :
                                                             'ipatt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (p :
                                                           'ipatt_tcon) ->
                                                          fun _ ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.PaOlb
                                                                (_loc,
                                                                 "", p)) :
                                                               'ipatt) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | ANTIQUOT
                                                               (((""
                                                                  | "lid") as
                                                                 n), i) ->
                                                               ((Ast.PaOlb
                                                                  (_loc,
                                                                   (
                                                                   (mk_anti
                                                                    n i)
                                                                   ), (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'ipatt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LIDENT (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "LIDENT (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LIDENT (i) ->
                                                               ((Ast.PaOlb
                                                                  (_loc,
                                                                   i, (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'ipatt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt_tcon :
                                                             'ipatt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (eq_expr :
                                                             'eq_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (f :
                                                           'eq_expr) ->
                                                          fun (p :
                                                            'ipatt_tcon) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (__camlp4_0 :
                                                               Gram.token) ->
                                                              fun _ ->
                                                               fun (_loc :
                                                                 FanLoc.t) ->
                                                                (match
                                                                   __camlp4_0 with
                                                                 | ANTIQUOT
                                                                    (((""
                                                                    | "lid") as
                                                                    n), i) ->
                                                                    ((f (
                                                                    (mk_anti
                                                                    n i)
                                                                    ) p) :
                                                                    'ipatt)
                                                                 | _ ->
                                                                    assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | OPTLABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "OPTLABEL (_)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         ("(")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt_tcon :
                                                             'ipatt_tcon Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (eq_expr :
                                                             'eq_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (f :
                                                           'eq_expr) ->
                                                          fun (p :
                                                            'ipatt_tcon) ->
                                                           fun _ ->
                                                            fun (__camlp4_0 :
                                                              Gram.token) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              (match
                                                                 __camlp4_0 with
                                                               | OPTLABEL
                                                                  (i) ->
                                                                  ((f i
                                                                    p) :
                                                                    'ipatt)
                                                               | _ ->
                                                                  assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LIDENT (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "LIDENT (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LIDENT (i) ->
                                                               ((Ast.PaLab
                                                                  (_loc,
                                                                   i, (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'ipatt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | ANTIQUOT
                                                               (((""
                                                                  | "lid") as
                                                                 n), i) ->
                                                               ((Ast.PaLab
                                                                  (_loc,
                                                                   (
                                                                   (mk_anti
                                                                    n i)
                                                                   ), (
                                                                   (Ast.PaNil
                                                                    (_loc))
                                                                   ))) :
                                                                 'ipatt)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'ipatt) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (match
                                                                __camlp4_0 with
                                                              | ANTIQUOT
                                                                 (((""
                                                                    | "lid") as
                                                                   n), i) ->
                                                                 ((Ast.PaLab
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n i)
                                                                    ), p)) :
                                                                   'ipatt)
                                                              | _ ->
                                                                 assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ), "LABEL (_)"))
                                                       ); Gram.Sself ] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'ipatt) ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | LABEL (i) ->
                                                               ((Ast.PaLab
                                                                  (_loc,
                                                                   i, p)) :
                                                                 'ipatt)
                                                            | _ ->
                                                               assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ipatt_tcon :
                                                'ipatt_tcon Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (p :
                                                          'ipatt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (p :
                                                            'ipatt_tcon)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ipatt :
                                                             'ipatt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (t :
                                                          'ctyp) ->
                                                         fun _ ->
                                                          fun (p :
                                                            'ipatt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaTyc
                                                               (_loc, p,
                                                                t)) :
                                                              'ipatt_tcon)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (direction_flag :
                                                'direction_flag Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("to"
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"to\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("to"
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.DiAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'direction_flag)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("downto")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.DiDownto) :
                                                            'direction_flag)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("to")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.DiTo) :
                                                            'direction_flag)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_private :
                                                'opt_private Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.PrNil) :
                                                           'opt_private)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("private"
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"private\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("private"
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.PrAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'opt_private)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("private")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.PrPrivate) :
                                                            'opt_private)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_mutable :
                                                'opt_mutable Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.MuNil) :
                                                           'opt_mutable)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("mutable"
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"mutable\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("mutable"
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.MuAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'opt_mutable)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("mutable")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.MuMutable) :
                                                            'opt_mutable)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_virtual :
                                                'opt_virtual Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.ViNil) :
                                                           'opt_virtual)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("virtual"
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"virtual\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("virtual"
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.ViAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'opt_virtual)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("virtual")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ViVirtual) :
                                                            'opt_virtual)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_dot_dot :
                                                'opt_dot_dot Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.RvNil) :
                                                           'opt_dot_dot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((".."
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"..\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((".."
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.RvAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'opt_dot_dot)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("..")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.RvRowVar) :
                                                            'opt_dot_dot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_rec : 'opt_rec Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.ReNil) :
                                                           'opt_rec) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("rec"
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"rec\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("rec"
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.ReAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'opt_rec)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("rec")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.ReRecursive) :
                                                            'opt_rec) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_override :
                                                'opt_override Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.OvNil) :
                                                           'opt_override)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((("!"
                                                                | "override")
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"!\" | \"override\") | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((("!"
                                                                  | "override")
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.OvAnt
                                                                 (mk_anti
                                                                   n s)) :
                                                                'opt_override)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("!")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.OvOverride) :
                                                            'opt_override)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (opt_expr :
                                                'opt_expr Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.ExNil
                                                            (_loc)) :
                                                           'opt_expr) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (e : 'opt_expr)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (interf : 'interf Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | EOI -> (true)
                                                          | _ -> (false)
                                                          ), "EOI")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | EOI ->
                                                              (([] , None
                                                                ) :
                                                                'interf)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sig_item :
                                                             'sig_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun ((sil,
                                                              stopped) :
                                                          'interf) ->
                                                         fun _ ->
                                                          fun (si :
                                                            'sig_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (((
                                                              ( si ) ::
                                                               sil  ),
                                                              stopped) :
                                                              'interf) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_expr :
                                                             'opt_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (dp :
                                                           'opt_expr) ->
                                                          fun (n :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (((
                                                               [(
                                                                (Ast.SgDir
                                                                  (_loc,
                                                                   n, dp))
                                                                )] ), (
                                                               (stopped_at
                                                                 _loc) )) :
                                                               'interf)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sig_items :
                                                'sig_items Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Slist0
                                                         (Gram.srules
                                                           sig_items (
                                                           [((
                                                             [(
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (sig_item :
                                                                    'sig_item Gram.t)
                                                                  ))) );
                                                              (
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (semi :
                                                                    'semi Gram.t)
                                                                  ))) )]
                                                             ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun (sg :
                                                                  'sig_item) ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (sg :
                                                                    'e__25)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'e__25 list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.sgSem_of_list
                                                             l) :
                                                            'sig_items)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "sigi")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"sigi\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (sg :
                                                          'sig_items) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "sigi")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.SgSem
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.SgAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n
                                                                    ~c:"sig_item"
                                                                    s) )))
                                                                    ),
                                                                    sg)) :
                                                                  'sig_items)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "sigi")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"sigi\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "sigi")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.SgAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    n
                                                                    ~c:"sig_item"
                                                                    s) ))) :
                                                                'sig_items)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (implem : 'implem Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | EOI -> (true)
                                                          | _ -> (false)
                                                          ), "EOI")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | EOI ->
                                                              (([] , None
                                                                ) :
                                                                'implem)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (str_item :
                                                             'str_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun ((sil,
                                                              stopped) :
                                                          'implem) ->
                                                         fun _ ->
                                                          fun (si :
                                                            'str_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (((
                                                              ( si ) ::
                                                               sil  ),
                                                              stopped) :
                                                              'implem) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_expr :
                                                             'opt_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (dp :
                                                           'opt_expr) ->
                                                          fun (n :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (((
                                                               [(
                                                                (Ast.StDir
                                                                  (_loc,
                                                                   n, dp))
                                                                )] ), (
                                                               (stopped_at
                                                                 _loc) )) :
                                                               'implem)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (str_items :
                                                'str_items Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Slist0
                                                         (Gram.srules
                                                           str_items (
                                                           [((
                                                             [(
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (str_item :
                                                                    'str_item Gram.t)
                                                                  ))) );
                                                              (
                                                              (Gram.Snterm
                                                                (Gram.obj
                                                                  (
                                                                  (semi :
                                                                    'semi Gram.t)
                                                                  ))) )]
                                                             ), (
                                                             (Gram.mk_action
                                                               (
                                                               fun _ ->
                                                                fun (st :
                                                                  'str_item) ->
                                                                 fun (_loc :
                                                                   FanLoc.t) ->
                                                                  (st :
                                                                    'e__26)
                                                               )) ))] )))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (l :
                                                          'e__26 list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.stSem_of_list
                                                             l) :
                                                            'str_items)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "stri")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"stri\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (st :
                                                          'str_items) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "stri")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.StSem
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.StAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n
                                                                    ~c:"str_item"
                                                                    s) )))
                                                                    ),
                                                                    st)) :
                                                                  'str_items)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "stri")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"stri\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "stri")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.StAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    n
                                                                    ~c:"str_item"
                                                                    s) ))) :
                                                                'str_items)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (top_phrase :
                                                'top_phrase Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | EOI -> (true)
                                                          | _ -> (false)
                                                          ), "EOI")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | EOI ->
                                                              ((None) :
                                                                'top_phrase)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (phrase :
                                                             'phrase Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ph :
                                                          'phrase) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Some (ph)) :
                                                            'top_phrase)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (use_file :
                                                'use_file Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | EOI -> (true)
                                                          | _ -> (false)
                                                          ), "EOI")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | EOI ->
                                                              (([] , None
                                                                ) :
                                                                'use_file)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (str_item :
                                                             'str_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun ((sil,
                                                              stopped) :
                                                          'use_file) ->
                                                         fun _ ->
                                                          fun (si :
                                                            'str_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (((
                                                              ( si ) ::
                                                               sil  ),
                                                              stopped) :
                                                              'use_file)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_expr :
                                                             'opt_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (dp :
                                                           'opt_expr) ->
                                                          fun (n :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             (((
                                                               [(
                                                                (Ast.StDir
                                                                  (_loc,
                                                                   n, dp))
                                                                )] ), (
                                                               (stopped_at
                                                                 _loc) )) :
                                                               'use_file)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (phrase : 'phrase Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (str_item :
                                                             'str_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (st :
                                                           'str_item) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (st : 'phrase)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_expr :
                                                             'opt_expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";;")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (dp :
                                                           'opt_expr) ->
                                                          fun (n :
                                                            'a_LIDENT) ->
                                                           fun _ ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.StDir
                                                                (_loc, n,
                                                                 dp)) :
                                                               'phrase)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_INT : 'a_INT Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | INT (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "INT (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | INT (_, s) ->
                                                              (s :
                                                                'a_INT)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "int")
                                                               | "`int"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"int\") | \"`int\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "int")
                                                                 | "`int") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_INT)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_INT32 : 'a_INT32 Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | INT32 (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "INT32 (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | INT32 (_, s) ->
                                                              (s :
                                                                'a_INT32)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "int32")
                                                               | "`int32"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"int32\") | \"`int32\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "int32")
                                                                 | "`int32") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_INT32)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_INT64 : 'a_INT64 Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | INT64 (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "INT64 (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | INT64 (_, s) ->
                                                              (s :
                                                                'a_INT64)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "int64")
                                                               | "`int64"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"int64\") | \"`int64\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "int64")
                                                                 | "`int64") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_INT64)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_NATIVEINT :
                                                'a_NATIVEINT Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | NATIVEINT
                                                             (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "NATIVEINT (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | NATIVEINT
                                                              (_, s) ->
                                                              (s :
                                                                'a_NATIVEINT)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "nativeint")
                                                               | "`nativeint"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"nativeint\") | \"`nativeint\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "nativeint")
                                                                 | "`nativeint") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_NATIVEINT)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_FLOAT : 'a_FLOAT Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | FLOAT (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "FLOAT (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | FLOAT (_, s) ->
                                                              (s :
                                                                'a_FLOAT)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "flo")
                                                               | "`flo"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"flo\") | \"`flo\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "flo")
                                                                 | "`flo") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_FLOAT)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_CHAR : 'a_CHAR Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | CHAR (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "CHAR (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | CHAR (_, s) ->
                                                              (s :
                                                                'a_CHAR)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "chr")
                                                               | "`chr"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"chr\") | \"`chr\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "chr")
                                                                 | "`chr") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_CHAR)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_UIDENT :
                                                'a_UIDENT Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | UIDENT (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "UIDENT (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | UIDENT (s) ->
                                                              (s :
                                                                'a_UIDENT)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "uid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"uid\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "uid") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_UIDENT)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_LIDENT :
                                                'a_LIDENT Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LIDENT (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "LIDENT (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | LIDENT (s) ->
                                                              (s :
                                                                'a_LIDENT)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "lid"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"lid\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((""
                                                                 | "lid") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_LIDENT)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_LABEL : 'a_LABEL Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | LABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ), "LABEL (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | LABEL (s) ->
                                                              (s :
                                                                'a_LABEL)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("~")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (("" as
                                                                  n), s) ->
                                                                ((mk_anti
                                                                   n s) :
                                                                  'a_LABEL)
                                                             | _ ->
                                                                assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_OPTLABEL :
                                                'a_OPTLABEL Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | OPTLABEL (_) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "OPTLABEL (_)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | OPTLABEL (s) ->
                                                              (s :
                                                                'a_OPTLABEL)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("?")) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (("" as
                                                                  n), s) ->
                                                                ((mk_anti
                                                                   n s) :
                                                                  'a_OPTLABEL)
                                                             | _ ->
                                                                assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (a_STRING :
                                                'a_STRING Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | STRING (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "STRING (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | STRING
                                                              (_, s) ->
                                                              (s :
                                                                'a_STRING)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (((""
                                                                | "str")
                                                               | "`str"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (((\"\" | \"str\") | \"`str\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((((""
                                                                  | "str")
                                                                 | "`str") as
                                                                n), s) ->
                                                              ((mk_anti n
                                                                 s) :
                                                                'a_STRING)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (string_list :
                                                'string_list Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | STRING (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "STRING (_, _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | STRING
                                                              (_, x) ->
                                                              ((Ast.LCons
                                                                 (x,
                                                                  Ast.LNil
                                                                  )) :
                                                                'string_list)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | STRING (_, _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "STRING (_, _)"))
                                                       ); Gram.Sself ] ),
                                                      (
                                                      (Gram.mk_action (
                                                        fun (xs :
                                                          'string_list) ->
                                                         fun (__camlp4_0 :
                                                           Gram.token) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | STRING
                                                               (_, x) ->
                                                               ((Ast.LCons
                                                                  (x, xs)) :
                                                                 'string_list)
                                                            | _ ->
                                                               assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((""
                                                               | "str_list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"\" | \"str_list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((""
                                                                | "str_list"),
                                                               s) ->
                                                              ((Ast.LAnt
                                                                 (mk_anti
                                                                   "str_list"
                                                                   s)) :
                                                                'string_list)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (semi : 'semi Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         (";")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (() : 'semi) ))
                                                      ))] ))] ))) () ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (expr_quot :
                                                'expr_quot Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.ExNil
                                                            (_loc)) :
                                                           'expr_quot) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e :
                                                          'expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (e :
                                                            'expr_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_expr :
                                                             'sem_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'sem_expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExSem
                                                               (_loc, e1,
                                                                e2)) :
                                                              'expr_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (",")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_expr :
                                                             'comma_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (e2 :
                                                          'comma_expr) ->
                                                         fun _ ->
                                                          fun (e1 :
                                                            'expr) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.ExCom
                                                               (_loc, e1,
                                                                e2)) :
                                                              'expr_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (patt_quot :
                                                'patt_quot Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.PaNil
                                                            (_loc)) :
                                                           'patt_quot) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'patt) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'patt_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'patt) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (let i =
                                                              (match
                                                                 x with
                                                               | Ast.PaAnt
                                                                  (loc, s) ->
                                                                  (Ast.IdAnt
                                                                    (loc,
                                                                    s))
                                                               | p ->
                                                                  (Ast.ident_of_patt
                                                                    p)) in
                                                             (Ast.PaEq
                                                               (_loc, i,
                                                                y)) :
                                                              'patt_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sem_patt :
                                                             'sem_patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'sem_patt) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaSem
                                                               (_loc, x,
                                                                y)) :
                                                              'patt_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (",")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_patt :
                                                             'comma_patt Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'comma_patt) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'patt) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.PaCom
                                                               (_loc, x,
                                                                y)) :
                                                              'patt_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ctyp_quot :
                                                'ctyp_quot Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.TyNil
                                                            (_loc)) :
                                                           'ctyp_quot) ))
                                                      ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'more_ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("and")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_arg_list :
                                                             'constructor_arg_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'constructor_arg_list) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyAnd
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("&")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (amp_ctyp :
                                                             'amp_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'amp_ctyp) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyAmp
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("*")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (star_ctyp :
                                                             'star_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'star_ctyp) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TySta
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_declaration_list :
                                                             'label_declaration_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (z :
                                                          'label_declaration_list) ->
                                                         fun _ ->
                                                          fun (y :
                                                            'more_ctyp) ->
                                                           fun _ ->
                                                            fun (x :
                                                              'more_ctyp) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.TySem
                                                                 (_loc, (
                                                                  (Ast.TyCol
                                                                    (_loc,
                                                                    x, y))
                                                                  ), z)) :
                                                                'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'more_ctyp) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyCol
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Skeyword
                                                         ("&")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (amp_ctyp :
                                                             'amp_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("|")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (row_field :
                                                             'row_field Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (z :
                                                          'row_field) ->
                                                         fun _ ->
                                                          fun (y :
                                                            'amp_ctyp) ->
                                                           fun _ ->
                                                            fun _ ->
                                                             fun (x :
                                                               'more_ctyp) ->
                                                              fun (_loc :
                                                                FanLoc.t) ->
                                                               ((Ast.TyOr
                                                                  (_loc,
                                                                   (
                                                                   (Ast.TyOfAmp
                                                                    (_loc,
                                                                    x, y))
                                                                   ), z)) :
                                                                 'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Skeyword
                                                         ("&")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (amp_ctyp :
                                                             'amp_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'amp_ctyp) ->
                                                         fun _ ->
                                                          fun _ ->
                                                           fun (x :
                                                             'more_ctyp) ->
                                                            fun (_loc :
                                                              FanLoc.t) ->
                                                             ((Ast.TyOfAmp
                                                                (_loc, x,
                                                                 y)) :
                                                               'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_arg_list :
                                                             'constructor_arg_list Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("|")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_declarations :
                                                             'constructor_declarations Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (z :
                                                          'constructor_declarations) ->
                                                         fun _ ->
                                                          fun (y :
                                                            'constructor_arg_list) ->
                                                           fun _ ->
                                                            fun (x :
                                                              'more_ctyp) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.TyOr
                                                                 (_loc, (
                                                                  (Ast.TyOf
                                                                    (_loc,
                                                                    x, y))
                                                                  ), z)) :
                                                                'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("of")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_arg_list :
                                                             'constructor_arg_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'constructor_arg_list) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyOf
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("|")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (constructor_declarations :
                                                             'constructor_declarations Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'constructor_declarations) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyOr
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (";")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_declaration_list :
                                                             'label_declaration_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'label_declaration_list) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TySem
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (more_ctyp :
                                                             'more_ctyp Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (",")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (comma_ctyp :
                                                             'comma_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (y :
                                                          'comma_ctyp) ->
                                                         fun _ ->
                                                          fun (x :
                                                            'more_ctyp) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.TyCom
                                                               (_loc, x,
                                                                y)) :
                                                              'ctyp_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (more_ctyp :
                                                'more_ctyp Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (type_parameter :
                                                             'type_parameter Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'type_parameter) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'more_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ctyp :
                                                             'ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'ctyp) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'more_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("`")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_ident :
                                                             'a_ident Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'a_ident) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyVrn
                                                              (_loc, x)) :
                                                             'more_ctyp)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("mutable")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'more_ctyp) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.TyMut
                                                              (_loc, x)) :
                                                             'more_ctyp)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (str_item_quot :
                                                'str_item_quot Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.StNil
                                                            (_loc)) :
                                                           'str_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (str_item :
                                                             'str_item Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (st :
                                                          'str_item) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (st :
                                                            'str_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (str_item :
                                                             'str_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (st2 :
                                                          'str_item_quot) ->
                                                         fun _ ->
                                                          fun (st1 :
                                                            'str_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((match
                                                                st2 with
                                                              | Ast.StNil
                                                                 (_) ->
                                                                 st1
                                                              | _ ->
                                                                 (Ast.StSem
                                                                   (_loc,
                                                                    st1,
                                                                    st2))) :
                                                              'str_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_expr :
                                                             'opt_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (dp :
                                                          'opt_expr) ->
                                                         fun (n :
                                                           'a_LIDENT) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.StDir
                                                               (_loc, n,
                                                                dp)) :
                                                              'str_item_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (sig_item_quot :
                                                'sig_item_quot Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.SgNil
                                                            (_loc)) :
                                                           'sig_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sig_item :
                                                             'sig_item Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (sg :
                                                          'sig_item) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (sg :
                                                            'sig_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (sig_item :
                                                             'sig_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (sg2 :
                                                          'sig_item_quot) ->
                                                         fun _ ->
                                                          fun (sg1 :
                                                            'sig_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((match
                                                                sg2 with
                                                              | Ast.SgNil
                                                                 (_) ->
                                                                 sg1
                                                              | _ ->
                                                                 (Ast.SgSem
                                                                   (_loc,
                                                                    sg1,
                                                                    sg2))) :
                                                              'sig_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("#")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_expr :
                                                             'opt_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (dp :
                                                          'opt_expr) ->
                                                         fun (n :
                                                           'a_LIDENT) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.SgDir
                                                               (_loc, n,
                                                                dp)) :
                                                              'sig_item_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_type_quot :
                                                'module_type_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.MtNil
                                                            (_loc)) :
                                                           'module_type_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'module_type) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'module_type_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_expr_quot :
                                                'module_expr_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.MeNil
                                                            (_loc)) :
                                                           'module_expr_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'module_expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'module_expr_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (match_case_quot :
                                                'match_case_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.McNil
                                                            (_loc)) :
                                                           'match_case_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Slist0sep
                                                         ((
                                                          (Gram.Snterm
                                                            (Gram.obj (
                                                              (match_case0 :
                                                                'match_case0 Gram.t)
                                                              ))) ), (
                                                          (Gram.Skeyword
                                                            ("|")) ))) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'match_case0 list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.mcOr_of_list
                                                             x) :
                                                            'match_case_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (binding_quot :
                                                'binding_quot Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.BiNil
                                                            (_loc)) :
                                                           'binding_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (binding :
                                                             'binding Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'binding) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'binding_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (rec_binding_quot :
                                                'rec_binding_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.RbNil
                                                            (_loc)) :
                                                           'rec_binding_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (label_expr_list :
                                                             'label_expr_list Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'label_expr_list) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'rec_binding_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (module_binding_quot :
                                                'module_binding_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.MbNil
                                                            (_loc)) :
                                                           'module_binding_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (m :
                                                              'a_UIDENT) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              ((Ast.MbColEq
                                                                 (_loc,
                                                                  m, mt,
                                                                  me)) :
                                                                'module_binding_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (m :
                                                            'a_UIDENT) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MbCol
                                                               (_loc, m,
                                                                mt)) :
                                                              'module_binding_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) ); (
                                                       (Gram.Skeyword
                                                         ("=")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_expr :
                                                             'module_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (me :
                                                          'module_expr) ->
                                                         fun _ ->
                                                          fun (mt :
                                                            'module_type) ->
                                                           fun _ ->
                                                            fun (__camlp4_0 :
                                                              Gram.token) ->
                                                             fun (_loc :
                                                               FanLoc.t) ->
                                                              (match
                                                                 __camlp4_0 with
                                                               | ANTIQUOT
                                                                  (("" as
                                                                    n), m) ->
                                                                  ((Ast.MbColEq
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n m)
                                                                    ),
                                                                    mt,
                                                                    me)) :
                                                                    'module_binding_quot)
                                                               | _ ->
                                                                  assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (":")) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (module_type :
                                                             'module_type Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (mt :
                                                          'module_type) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (("" as
                                                                  n), m) ->
                                                                ((Ast.MbCol
                                                                   (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    n m)
                                                                    ),
                                                                    mt)) :
                                                                  'module_binding_quot)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("", _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"\", _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (("" as n),
                                                               s) ->
                                                              ((Ast.MbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_binding"
                                                                    n s)
                                                                  ))) :
                                                                'module_binding_quot)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             (("module_binding"
                                                               | "anti"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((\"module_binding\" | \"anti\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              ((("module_binding"
                                                                 | "anti") as
                                                                n), s) ->
                                                              ((Ast.MbAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"module_binding"
                                                                    n s)
                                                                  ))) :
                                                                'module_binding_quot)
                                                           | _ ->
                                                              assert false)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (b2 :
                                                          'module_binding_quot) ->
                                                         fun _ ->
                                                          fun (b1 :
                                                            'module_binding_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.MbAnd
                                                               (_loc, b1,
                                                                b2)) :
                                                              'module_binding_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (ident_quot :
                                                'ident_quot Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(( (Some ("apply")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ;
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'ident_quot) ->
                                                         fun (i :
                                                           'ident_quot) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.IdApp
                                                              (_loc, i,
                                                               j)) :
                                                             'ident_quot)
                                                        )) ))] ));
                                                   (( (Some (".")) ),
                                                    None , (
                                                    [((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (j :
                                                          'ident_quot) ->
                                                         fun _ ->
                                                          fun (i :
                                                            'ident_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.IdAcc
                                                               (_loc, i,
                                                                j)) :
                                                              'ident_quot)
                                                        )) ))] ));
                                                   (( (Some ("simple"))
                                                    ), None , (
                                                    [((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("(")) );
                                                       Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (")")) )] ), (
                                                      (Gram.mk_action (
                                                        fun _ ->
                                                         fun (i :
                                                           'ident_quot) ->
                                                          fun _ ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (i :
                                                              'ident_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       ); (
                                                       (Gram.Skeyword
                                                         (".")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'ident_quot) ->
                                                         fun _ ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (((((""
                                                                    | "id")
                                                                    | "anti")
                                                                   | "list") as
                                                                  n), s) ->
                                                                ((Ast.IdAcc
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdAnt
                                                                    (_loc,
                                                                    (
                                                                    (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                    )))
                                                                    ), i)) :
                                                                  'ident_quot)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_LIDENT :
                                                             'a_LIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_LIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdLid
                                                             (_loc, i)) :
                                                            'ident_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (a_UIDENT :
                                                             'a_UIDENT Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (i :
                                                          'a_UIDENT) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          ((Ast.IdUid
                                                             (_loc, i)) :
                                                            'ident_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ((((""
                                                                 | "id")
                                                                | "anti")
                                                               | "list"),
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT ((((\"\" | \"id\") | \"anti\") | \"list\"), _)"))
                                                       )] ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (match
                                                             __camlp4_0 with
                                                           | ANTIQUOT
                                                              (((((""
                                                                   | "id")
                                                                  | "anti")
                                                                 | "list") as
                                                                n), s) ->
                                                              ((Ast.IdAnt
                                                                 (_loc, (
                                                                  (mk_anti
                                                                    ~c:"ident"
                                                                    n s)
                                                                  ))) :
                                                                'ident_quot)
                                                           | _ ->
                                                              assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_expr_quot :
                                                'class_expr_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.CeNil
                                                            (_loc)) :
                                                           'class_expr_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_expr :
                                                             'class_expr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'class_expr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'class_expr_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("virtual",
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"virtual\", _)"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ident :
                                                             'ident Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_comma_ctyp :
                                                             'opt_comma_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ot :
                                                          'opt_comma_ctyp) ->
                                                         fun (i :
                                                           'ident) ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (("virtual" as
                                                                  n), s) ->
                                                                (let anti =
                                                                  (Ast.ViAnt
                                                                    (mk_anti
                                                                    ~c:"class_expr"
                                                                    n s)) in
                                                                 (Ast.CeCon
                                                                   (_loc,
                                                                    anti,
                                                                    i,
                                                                    ot)) :
                                                                  'class_expr_quot)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_name_and_param :
                                                             'class_name_and_param Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((i, ot) :
                                                          'class_name_and_param) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CeCon
                                                              (_loc,
                                                               Ast.ViVirtual
                                                               , (
                                                               (Ast.IdLid
                                                                 (_loc,
                                                                  i)) ),
                                                               ot)) :
                                                             'class_expr_quot)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("=")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ce2 :
                                                          'class_expr_quot) ->
                                                         fun _ ->
                                                          fun (ce1 :
                                                            'class_expr_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CeEq
                                                               (_loc,
                                                                ce1, ce2)) :
                                                              'class_expr_quot)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ce2 :
                                                          'class_expr_quot) ->
                                                         fun _ ->
                                                          fun (ce1 :
                                                            'class_expr_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CeAnd
                                                               (_loc,
                                                                ce1, ce2)) :
                                                              'class_expr_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_type_quot :
                                                'class_type_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.CtNil
                                                            (_loc)) :
                                                           'class_type_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_type_plus :
                                                             'class_type_plus Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'class_type_plus) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'class_type_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | ANTIQUOT
                                                             ("virtual",
                                                              _) ->
                                                             (true)
                                                          | _ -> (false)
                                                          ),
                                                          "ANTIQUOT (\"virtual\", _)"))
                                                       ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (ident :
                                                             'ident Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_comma_ctyp :
                                                             'opt_comma_ctyp Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (ot :
                                                          'opt_comma_ctyp) ->
                                                         fun (i :
                                                           'ident) ->
                                                          fun (__camlp4_0 :
                                                            Gram.token) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            (match
                                                               __camlp4_0 with
                                                             | ANTIQUOT
                                                                (("virtual" as
                                                                  n), s) ->
                                                                (let anti =
                                                                  (Ast.ViAnt
                                                                    (mk_anti
                                                                    ~c:"class_type"
                                                                    n s)) in
                                                                 (Ast.CtCon
                                                                   (_loc,
                                                                    anti,
                                                                    i,
                                                                    ot)) :
                                                                  'class_type_quot)
                                                             | _ ->
                                                                assert false)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Skeyword
                                                         ("virtual")) );
                                                       (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_name_and_param :
                                                             'class_name_and_param Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun ((i, ot) :
                                                          'class_name_and_param) ->
                                                         fun _ ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           ((Ast.CtCon
                                                              (_loc,
                                                               Ast.ViVirtual
                                                               , (
                                                               (Ast.IdLid
                                                                 (_loc,
                                                                  i)) ),
                                                               ot)) :
                                                             'class_type_quot)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         (":")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ct2 :
                                                          'class_type_quot) ->
                                                         fun _ ->
                                                          fun (ct1 :
                                                            'class_type_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtCol
                                                               (_loc,
                                                                ct1, ct2)) :
                                                              'class_type_quot)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("=")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ct2 :
                                                          'class_type_quot) ->
                                                         fun _ ->
                                                          fun (ct1 :
                                                            'class_type_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtEq
                                                               (_loc,
                                                                ct1, ct2)) :
                                                              'class_type_quot)
                                                        )) ));
                                                     ((
                                                      [Gram.Sself ; (
                                                       (Gram.Skeyword
                                                         ("and")) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (ct2 :
                                                          'class_type_quot) ->
                                                         fun _ ->
                                                          fun (ct1 :
                                                            'class_type_quot) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((Ast.CtAnd
                                                               (_loc,
                                                                ct1, ct2)) :
                                                              'class_type_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_str_item_quot :
                                                'class_str_item_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.CrNil
                                                            (_loc)) :
                                                           'class_str_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_str_item :
                                                             'class_str_item Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'class_str_item) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'class_str_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_str_item :
                                                             'class_str_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (x2 :
                                                          'class_str_item_quot) ->
                                                         fun _ ->
                                                          fun (x1 :
                                                            'class_str_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((match
                                                                x2 with
                                                              | Ast.CrNil
                                                                 (_) ->
                                                                 x1
                                                              | _ ->
                                                                 (Ast.CrSem
                                                                   (_loc,
                                                                    x1,
                                                                    x2))) :
                                                              'class_str_item_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (class_sig_item_quot :
                                                'class_sig_item_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.CgNil
                                                            (_loc)) :
                                                           'class_sig_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_sig_item :
                                                             'class_sig_item Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'class_sig_item) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'class_sig_item_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (class_sig_item :
                                                             'class_sig_item Gram.t)
                                                           ))) ); (
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (semi :
                                                             'semi Gram.t)
                                                           ))) );
                                                       Gram.Sself ] ), (
                                                      (Gram.mk_action (
                                                        fun (x2 :
                                                          'class_sig_item_quot) ->
                                                         fun _ ->
                                                          fun (x1 :
                                                            'class_sig_item) ->
                                                           fun (_loc :
                                                             FanLoc.t) ->
                                                            ((match
                                                                x2 with
                                                              | Ast.CgNil
                                                                 (_) ->
                                                                 x1
                                                              | _ ->
                                                                 (Ast.CgSem
                                                                   (_loc,
                                                                    x1,
                                                                    x2))) :
                                                              'class_sig_item_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (with_constr_quot :
                                                'with_constr_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [([] , (
                                                      (Gram.mk_action (
                                                        fun (_loc :
                                                          FanLoc.t) ->
                                                         ((Ast.WcNil
                                                            (_loc)) :
                                                           'with_constr_quot)
                                                        )) ));
                                                     ((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (with_constr :
                                                             'with_constr Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'with_constr) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'with_constr_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (rec_flag_quot :
                                                'rec_flag_quot Gram.t) )
                                              (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_rec :
                                                             'opt_rec Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'opt_rec) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'rec_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (direction_flag_quot :
                                                'direction_flag_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (direction_flag :
                                                             'direction_flag Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'direction_flag) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'direction_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (mutable_flag_quot :
                                                'mutable_flag_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_mutable :
                                                             'opt_mutable Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'opt_mutable) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'mutable_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (private_flag_quot :
                                                'private_flag_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_private :
                                                             'opt_private Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'opt_private) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'private_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (virtual_flag_quot :
                                                'virtual_flag_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_virtual :
                                                             'opt_virtual Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'opt_virtual) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'virtual_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (row_var_flag_quot :
                                                'row_var_flag_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_dot_dot :
                                                             'opt_dot_dot Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'opt_dot_dot) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'row_var_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (override_flag_quot :
                                                'override_flag_quot Gram.t)
                                              ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (opt_override :
                                                             'opt_override Gram.t)
                                                           ))) )] ), (
                                                      (Gram.mk_action (
                                                        fun (x :
                                                          'opt_override) ->
                                                         fun (_loc :
                                                           FanLoc.t) ->
                                                          (x :
                                                            'override_flag_quot)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (
                                            (Gram.extend (
                                              (patt_eoi :
                                                'patt_eoi Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (patt :
                                                             'patt Gram.t)
                                                           ))) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | EOI -> (true)
                                                          | _ -> (false)
                                                          ), "EOI")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (x :
                                                           'patt) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | EOI ->
                                                               (x :
                                                                 'patt_eoi)
                                                            | _ ->
                                                               assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))
                                            );
                                            (Gram.extend (
                                              (expr_eoi :
                                                'expr_eoi Gram.t) ) (
                                              ((fun ()
                                                  ->
                                                 (None , (
                                                  [(None , None , (
                                                    [((
                                                      [(
                                                       (Gram.Snterm
                                                         (Gram.obj (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ))) ); (
                                                       (Gram.Stoken
                                                         ((
                                                          function
                                                          | EOI -> (true)
                                                          | _ -> (false)
                                                          ), "EOI")) )]
                                                      ), (
                                                      (Gram.mk_action (
                                                        fun (__camlp4_0 :
                                                          Gram.token) ->
                                                         fun (x :
                                                           'expr) ->
                                                          fun (_loc :
                                                            FanLoc.t) ->
                                                           (match
                                                              __camlp4_0 with
                                                            | EOI ->
                                                               (x :
                                                                 'expr_eoi)
                                                            | _ ->
                                                               assert false)
                                                        )) ))] ))] ))) ()
                                                ) ))

                                   end

module IdRevisedParserParser :
                                         Sig.Id =
                                         struct
                                          let name =
                                           "Camlp4OCamlRevisedParserParser"

                                          let version = Sys.ocaml_version

                                         end

module MakeRevisedParserParser =
                                               functor (Syntax : Sig.Camlp4Syntax) ->
                                                struct
                                                 include Syntax

                                                 module Ast = Camlp4Ast

                                                 type spat_comp =
                                                    SpTrm of FanLoc.t *
                                                     Ast.patt *
                                                     Ast.expr option
                                                  | SpNtr of FanLoc.t *
                                                     Ast.patt * Ast.expr
                                                  | SpStr of FanLoc.t *
                                                     Ast.patt

                                                 type sexp_comp =
                                                    SeTrm of FanLoc.t *
                                                     Ast.expr
                                                  | SeNtr of FanLoc.t *
                                                     Ast.expr

                                                 let stream_expr =
                                                  (Gram.mk "stream_expr")

                                                 let stream_begin =
                                                  (Gram.mk
                                                    "stream_begin")

                                                 let stream_end =
                                                  (Gram.mk "stream_end")

                                                 let stream_quot =
                                                  (Gram.mk "stream_quot")

                                                 let parser_case =
                                                  (Gram.mk "parser_case")

                                                 let parser_case_list =
                                                  (Gram.mk
                                                    "parser_case_list")

                                                 let strm_n = "__strm"

                                                 let peek_fun =
                                                  fun _loc ->
                                                   (Ast.ExId
                                                     (_loc, (
                                                      (Ast.IdAcc
                                                        (_loc, (
                                                         (Ast.IdUid
                                                           (_loc,
                                                            "Stream")) ),
                                                         (
                                                         (Ast.IdLid
                                                           (_loc, "peek"))
                                                         ))) )))

                                                 let junk_fun =
                                                  fun _loc ->
                                                   (Ast.ExId
                                                     (_loc, (
                                                      (Ast.IdAcc
                                                        (_loc, (
                                                         (Ast.IdUid
                                                           (_loc,
                                                            "Stream")) ),
                                                         (
                                                         (Ast.IdLid
                                                           (_loc, "junk"))
                                                         ))) )))

                                                 let rec pattern_eq_expression =
                                                  fun p ->
                                                   fun e ->
                                                    (match (p, e) with
                                                     | (Ast.PaId
                                                         (_,
                                                          Ast.IdLid
                                                           (_, a)),
                                                        Ast.ExId
                                                         (_,
                                                          Ast.IdLid
                                                           (_, b))) ->
                                                        (a = b)
                                                     | (Ast.PaId
                                                         (_,
                                                          Ast.IdUid
                                                           (_, a)),
                                                        Ast.ExId
                                                         (_,
                                                          Ast.IdUid
                                                           (_, b))) ->
                                                        (a = b)
                                                     | (Ast.PaApp
                                                         (_, p1, p2),
                                                        Ast.ExApp
                                                         (_, e1, e2)) ->
                                                        ((
                                                          (pattern_eq_expression
                                                            p1 e1) ) && (
                                                          (pattern_eq_expression
                                                            p2 e2) ))
                                                     | _ -> (false))

                                                 let is_raise =
                                                  fun e ->
                                                   (match e with
                                                    | Ast.ExApp
                                                       (_,
                                                        Ast.ExId
                                                         (_,
                                                          Ast.IdLid
                                                           (_, "raise")),
                                                        _) ->
                                                       (true)
                                                    | _ -> (false))

                                                 let is_raise_failure =
                                                  fun e ->
                                                   (match e with
                                                    | Ast.ExApp
                                                       (_,
                                                        Ast.ExId
                                                         (_,
                                                          Ast.IdLid
                                                           (_, "raise")),
                                                        Ast.ExId
                                                         (_,
                                                          Ast.IdAcc
                                                           (_,
                                                            Ast.IdUid
                                                             (_, "Stream"),
                                                            Ast.IdUid
                                                             (_,
                                                              "Failure")))) ->
                                                       (true)
                                                    | _ -> (false))

                                                 let rec handle_failure =
                                                  fun e ->
                                                   (match e with
                                                    | Ast.ExTry
                                                       (_, _,
                                                        Ast.McArr
                                                         (_,
                                                          Ast.PaId
                                                           (_,
                                                            Ast.IdAcc
                                                             (_,
                                                              Ast.IdUid
                                                               (_,
                                                                "Stream"),
                                                              Ast.IdUid
                                                               (_,
                                                                "Failure"))),
                                                          Ast.ExNil (_),
                                                          e)) ->
                                                       (handle_failure e)
                                                    | Ast.ExMat
                                                       (_, me, a) ->
                                                       let rec match_case_handle_failure =
                                                        function
                                                        | Ast.McOr
                                                           (_, a1, a2) ->
                                                           ((
                                                             (match_case_handle_failure
                                                               a1) ) && (
                                                             (match_case_handle_failure
                                                               a2) ))
                                                        | Ast.McArr
                                                           (_, _,
                                                            Ast.ExNil (_),
                                                            e) ->
                                                           (handle_failure
                                                             e)
                                                        | _ -> (false) in
                                                       ((
                                                         (handle_failure
                                                           me) ) && (
                                                         (match_case_handle_failure
                                                           a) ))
                                                    | Ast.ExLet
                                                       (_, Ast.ReNil, bi,
                                                        e) ->
                                                       let rec binding_handle_failure =
                                                        function
                                                        | Ast.BiAnd
                                                           (_, b1, b2) ->
                                                           ((
                                                             (binding_handle_failure
                                                               b1) ) && (
                                                             (binding_handle_failure
                                                               b2) ))
                                                        | Ast.BiEq
                                                           (_, _, e) ->
                                                           (handle_failure
                                                             e)
                                                        | _ -> (false) in
                                                       ((
                                                         (binding_handle_failure
                                                           bi) ) && (
                                                         (handle_failure
                                                           e) ))
                                                    | (((((Ast.ExId
                                                            (_,
                                                             Ast.IdLid
                                                              (_, _))
                                                           | Ast.ExInt
                                                              (_, _))
                                                          | Ast.ExStr
                                                             (_, _))
                                                         | Ast.ExChr
                                                            (_, _))
                                                        | Ast.ExFun
                                                           (_, _))
                                                       | Ast.ExId
                                                          (_,
                                                           Ast.IdUid
                                                            (_, _))) ->
                                                       (true)
                                                    | Ast.ExApp
                                                       (_,
                                                        Ast.ExId
                                                         (_,
                                                          Ast.IdLid
                                                           (_, "raise")),
                                                        e) ->
                                                       (match e with
                                                        | Ast.ExId
                                                           (_,
                                                            Ast.IdAcc
                                                             (_,
                                                              Ast.IdUid
                                                               (_,
                                                                "Stream"),
                                                              Ast.IdUid
                                                               (_,
                                                                "Failure"))) ->
                                                           (false)
                                                        | _ -> (true))
                                                    | Ast.ExApp (_, f, x) ->
                                                       ((
                                                         (is_constr_apply
                                                           f) ) && (
                                                         ((
                                                           (handle_failure
                                                             f) ) && (
                                                           (handle_failure
                                                             x) )) ))
                                                    | _ -> (false))
                                                 and is_constr_apply =
                                                  function
                                                  | Ast.ExId
                                                     (_, Ast.IdUid (_, _)) ->
                                                     (true)
                                                  | Ast.ExId
                                                     (_, Ast.IdLid (_, _)) ->
                                                     (false)
                                                  | Ast.ExApp (_, x, _) ->
                                                     (is_constr_apply x)
                                                  | _ -> (false)

                                                 let rec subst =
                                                  fun v ->
                                                   fun e ->
                                                    let _loc =
                                                     (Ast.loc_of_expr e) in
                                                    (match e with
                                                     | Ast.ExId
                                                        (_,
                                                         Ast.IdLid (_, x)) ->
                                                        let x =
                                                         if (x = v) then
                                                          strm_n
                                                         else x in
                                                        (Ast.ExId
                                                          (_loc, (
                                                           (Ast.IdLid
                                                             (_loc, x))
                                                           )))
                                                     | Ast.ExId
                                                        (_,
                                                         Ast.IdUid (_, _)) ->
                                                        e
                                                     | Ast.ExInt (_, _) ->
                                                        e
                                                     | Ast.ExChr (_, _) ->
                                                        e
                                                     | Ast.ExStr (_, _) ->
                                                        e
                                                     | Ast.ExAcc
                                                        (_, _, _) ->
                                                        e
                                                     | Ast.ExLet
                                                        (_, rf, bi, e) ->
                                                        (Ast.ExLet
                                                          (_loc, rf, (
                                                           (subst_binding
                                                             v bi) ), (
                                                           (subst v e) )))
                                                     | Ast.ExApp
                                                        (_, e1, e2) ->
                                                        (Ast.ExApp
                                                          (_loc, (
                                                           (subst v e1)
                                                           ), (
                                                           (subst v e2)
                                                           )))
                                                     | Ast.ExTup (_, e) ->
                                                        (Ast.ExTup
                                                          (_loc, (
                                                           (subst v e) )))
                                                     | Ast.ExCom
                                                        (_, e1, e2) ->
                                                        (Ast.ExCom
                                                          (_loc, (
                                                           (subst v e1)
                                                           ), (
                                                           (subst v e2)
                                                           )))
                                                     | _ ->
                                                        (raise Not_found
                                                          ))
                                                 and subst_binding =
                                                  fun v ->
                                                   function
                                                   | Ast.BiAnd
                                                      (_loc, b1, b2) ->
                                                      (Ast.BiAnd
                                                        (_loc, (
                                                         (subst_binding v
                                                           b1) ), (
                                                         (subst_binding v
                                                           b2) )))
                                                   | Ast.BiEq
                                                      (_loc,
                                                       Ast.PaId
                                                        (_,
                                                         Ast.IdLid
                                                          (_, v')), e) ->
                                                      (Ast.BiEq
                                                        (_loc, (
                                                         (Ast.PaId
                                                           (_loc, (
                                                            (Ast.IdLid
                                                              (_loc, v'))
                                                            ))) ), (
                                                         if (v = v') then
                                                          e
                                                         else (subst v e)
                                                         )))
                                                   | _ ->
                                                      (raise Not_found )

                                                 let stream_pattern_component =
                                                  fun skont ->
                                                   fun ckont ->
                                                    function
                                                    | SpTrm
                                                       (_loc, p, None) ->
                                                       (Ast.ExMat
                                                         (_loc, (
                                                          (Ast.ExApp
                                                            (_loc, (
                                                             (peek_fun
                                                               _loc) ), (
                                                             (Ast.ExId
                                                               (_loc, (
                                                                (Ast.IdLid
                                                                  (_loc,
                                                                   strm_n))
                                                                ))) )))
                                                          ), (
                                                          (Ast.McOr
                                                            (_loc, (
                                                             (Ast.McArr
                                                               (_loc, (
                                                                (Ast.PaApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Some"))
                                                                    )))
                                                                   ), p))
                                                                ), (
                                                                (Ast.ExNil
                                                                  (_loc))
                                                                ), (
                                                                (Ast.ExSeq
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExSem
                                                                    (_loc,
                                                                    (
                                                                    (Ast.ExApp
                                                                    (_loc,
                                                                    (
                                                                    (junk_fun
                                                                    _loc)
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                    )))
                                                                    ),
                                                                    skont))
                                                                   ))) )))
                                                             ), (
                                                             (Ast.McArr
                                                               (_loc, (
                                                                (Ast.PaAny
                                                                  (_loc))
                                                                ), (
                                                                (Ast.ExNil
                                                                  (_loc))
                                                                ), ckont))
                                                             ))) )))
                                                    | SpTrm
                                                       (_loc, p, Some (w)) ->
                                                       (Ast.ExMat
                                                         (_loc, (
                                                          (Ast.ExApp
                                                            (_loc, (
                                                             (peek_fun
                                                               _loc) ), (
                                                             (Ast.ExId
                                                               (_loc, (
                                                                (Ast.IdLid
                                                                  (_loc,
                                                                   strm_n))
                                                                ))) )))
                                                          ), (
                                                          (Ast.McOr
                                                            (_loc, (
                                                             (Ast.McArr
                                                               (_loc, (
                                                                (Ast.PaApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Some"))
                                                                    )))
                                                                   ), p))
                                                                ), w, (
                                                                (Ast.ExSeq
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExSem
                                                                    (_loc,
                                                                    (
                                                                    (Ast.ExApp
                                                                    (_loc,
                                                                    (
                                                                    (junk_fun
                                                                    _loc)
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                    )))
                                                                    ),
                                                                    skont))
                                                                   ))) )))
                                                             ), (
                                                             (Ast.McArr
                                                               (_loc, (
                                                                (Ast.PaAny
                                                                  (_loc))
                                                                ), (
                                                                (Ast.ExNil
                                                                  (_loc))
                                                                ), ckont))
                                                             ))) )))
                                                    | SpNtr (_loc, p, e) ->
                                                       let e =
                                                        (match e with
                                                         | Ast.ExFun
                                                            (_,
                                                             Ast.McArr
                                                              (_,
                                                               Ast.PaTyc
                                                                (_,
                                                                 Ast.PaId
                                                                  (_,
                                                                   Ast.IdLid
                                                                    (_, v)),
                                                                 Ast.TyApp
                                                                  (_,
                                                                   Ast.TyId
                                                                    (_,
                                                                    Ast.IdAcc
                                                                    (_,
                                                                    Ast.IdUid
                                                                    (_,
                                                                    "Stream"),
                                                                    Ast.IdLid
                                                                    (_,
                                                                    "t"))),
                                                                   Ast.TyAny
                                                                    (_))),
                                                               Ast.ExNil
                                                                (_), e))
                                                            when
                                                            (v = strm_n) ->
                                                            e
                                                         | _ ->
                                                            (Ast.ExApp
                                                              (_loc, e, (
                                                               (Ast.ExId
                                                                 (_loc, (
                                                                  (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                  ))) )))) in
                                                       if (pattern_eq_expression
                                                            p skont) then
                                                        (
                                                        if (is_raise_failure
                                                             ckont) then
                                                         e
                                                        else if (handle_failure
                                                                  e) then
                                                              e
                                                        else
                                                         (Ast.ExTry
                                                           (_loc, e, (
                                                            (Ast.McArr
                                                              (_loc, (
                                                               (Ast.PaId
                                                                 (_loc, (
                                                                  (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Failure"))
                                                                    )))
                                                                  ))) ),
                                                               (
                                                               (Ast.ExNil
                                                                 (_loc))
                                                               ), ckont))
                                                            )))
                                                        )
                                                       else if (is_raise_failure
                                                                 ckont) then
                                                             (
                                                             (Ast.ExLet
                                                               (_loc,
                                                                Ast.ReNil
                                                                , (
                                                                (Ast.BiEq
                                                                  (_loc,
                                                                   p, e))
                                                                ), skont))
                                                             )
                                                       else if (pattern_eq_expression
                                                                 (
                                                                 (Ast.PaApp
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Some"))
                                                                    )))
                                                                    ), p))
                                                                 ) skont) then
                                                             (
                                                             (Ast.ExTry
                                                               (_loc, (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Some"))
                                                                    )))
                                                                   ), e))
                                                                ), (
                                                                (Ast.McArr
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Failure"))
                                                                    )))
                                                                    )))
                                                                   ), (
                                                                   (Ast.ExNil
                                                                    (_loc))
                                                                   ),
                                                                   ckont))
                                                                )))
                                                             )
                                                       else if (is_raise
                                                                 ckont) then
                                                             (
                                                             let tst =
                                                              if (handle_failure
                                                                   e) then
                                                               e
                                                              else
                                                               (Ast.ExTry
                                                                 (_loc,
                                                                  e, (
                                                                  (Ast.McArr
                                                                    (_loc,
                                                                    (
                                                                    (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Failure"))
                                                                    )))
                                                                    )))
                                                                    ), (
                                                                    (Ast.ExNil
                                                                    (_loc))
                                                                    ),
                                                                    ckont))
                                                                  ))) in
                                                             (Ast.ExLet
                                                               (_loc,
                                                                Ast.ReNil
                                                                , (
                                                                (Ast.BiEq
                                                                  (_loc,
                                                                   p,
                                                                   tst))
                                                                ), skont))
                                                             )
                                                       else
                                                        (Ast.ExMat
                                                          (_loc, (
                                                           (Ast.ExTry
                                                             (_loc, (
                                                              (Ast.ExApp
                                                                (_loc, (
                                                                 (Ast.ExId
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdUid
                                                                    (_loc,
                                                                    "Some"))
                                                                    )))
                                                                 ), e))
                                                              ), (
                                                              (Ast.McArr
                                                                (_loc, (
                                                                 (Ast.PaId
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Failure"))
                                                                    )))
                                                                    )))
                                                                 ), (
                                                                 (Ast.ExNil
                                                                   (_loc))
                                                                 ), (
                                                                 (Ast.ExId
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.IdUid
                                                                    (_loc,
                                                                    "None"))
                                                                    )))
                                                                 ))) )))
                                                           ), (
                                                           (Ast.McOr
                                                             (_loc, (
                                                              (Ast.McArr
                                                                (_loc, (
                                                                 (Ast.PaApp
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Some"))
                                                                    )))
                                                                    ), p))
                                                                 ), (
                                                                 (Ast.ExNil
                                                                   (_loc))
                                                                 ),
                                                                 skont))
                                                              ), (
                                                              (Ast.McArr
                                                                (_loc, (
                                                                 (Ast.PaAny
                                                                   (_loc))
                                                                 ), (
                                                                 (Ast.ExNil
                                                                   (_loc))
                                                                 ),
                                                                 ckont))
                                                              ))) )))
                                                    | SpStr (_loc, p) ->
                                                       (try
                                                         (match p with
                                                          | Ast.PaId
                                                             (_,
                                                              Ast.IdLid
                                                               (_, v)) ->
                                                             (subst v
                                                               skont)
                                                          | _ ->
                                                             (raise
                                                               Not_found
                                                               ))
                                                        with
                                                        Not_found ->
                                                         (Ast.ExLet
                                                           (_loc,
                                                            Ast.ReNil , (
                                                            (Ast.BiEq
                                                              (_loc, p, (
                                                               (Ast.ExId
                                                                 (_loc, (
                                                                  (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                  ))) )))
                                                            ), skont)))

                                                 let rec stream_pattern =
                                                  fun _loc ->
                                                   fun epo ->
                                                    fun e ->
                                                     fun ekont ->
                                                      function
                                                      | [] ->
                                                         (match epo with
                                                          | Some (ep) ->
                                                             (Ast.ExLet
                                                               (_loc,
                                                                Ast.ReNil
                                                                , (
                                                                (Ast.BiEq
                                                                  (_loc,
                                                                   ep, (
                                                                   (Ast.ExApp
                                                                    (_loc,
                                                                    (
                                                                    (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "count"))
                                                                    )))
                                                                    )))
                                                                    ), (
                                                                    (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                    )))
                                                                   ))) ),
                                                                e))
                                                          | _ -> e)
                                                      | ((spc, err) ::
                                                         spcl) ->
                                                         let skont =
                                                          let ekont =
                                                           fun err ->
                                                            let str =
                                                             (match
                                                                err with
                                                              | Some
                                                                 (estr) ->
                                                                 estr
                                                              | _ ->
                                                                 (Ast.ExStr
                                                                   (_loc,
                                                                    ""))) in
                                                            (Ast.ExApp
                                                              (_loc, (
                                                               (Ast.ExId
                                                                 (_loc, (
                                                                  (Ast.IdLid
                                                                    (_loc,
                                                                    "raise"))
                                                                  ))) ),
                                                               (
                                                               (Ast.ExApp
                                                                 (_loc, (
                                                                  (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Error"))
                                                                    )))
                                                                    )))
                                                                  ), str))
                                                               ))) in
                                                          (stream_pattern
                                                            _loc epo e
                                                            ekont spcl) in
                                                         let ckont =
                                                          (ekont err) in
                                                         (stream_pattern_component
                                                           skont ckont
                                                           spc)

                                                 let stream_patterns_term =
                                                  fun _loc ->
                                                   fun ekont ->
                                                    fun tspel ->
                                                     let pel =
                                                      (List.fold_right (
                                                        fun (p, w, _loc,
                                                             spcl, epo, e) ->
                                                         fun acc ->
                                                          let p =
                                                           (Ast.PaApp
                                                             (_loc, (
                                                              (Ast.PaId
                                                                (_loc, (
                                                                 (Ast.IdUid
                                                                   (_loc,
                                                                    "Some"))
                                                                 ))) ),
                                                              p)) in
                                                          let e =
                                                           let ekont =
                                                            fun err ->
                                                             let str =
                                                              (match
                                                                 err with
                                                               | Some
                                                                  (estr) ->
                                                                  estr
                                                               | _ ->
                                                                  (Ast.ExStr
                                                                    (_loc,
                                                                    ""))) in
                                                             (Ast.ExApp
                                                               (_loc, (
                                                                (Ast.ExId
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    "raise"))
                                                                   ))) ),
                                                                (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Error"))
                                                                    )))
                                                                    )))
                                                                   ),
                                                                   str))
                                                                ))) in
                                                           let skont =
                                                            (stream_pattern
                                                              _loc epo e
                                                              ekont spcl) in
                                                           (Ast.ExSeq
                                                             (_loc, (
                                                              (Ast.ExSem
                                                                (_loc, (
                                                                 (Ast.ExApp
                                                                   (_loc,
                                                                    (
                                                                    (junk_fun
                                                                    _loc)
                                                                    ), (
                                                                    (
                                                                    Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                    )))
                                                                 ),
                                                                 skont))
                                                              ))) in
                                                          (match w with
                                                           | Some (w) ->
                                                              (Ast.McOr
                                                                (_loc, (
                                                                 (Ast.McArr
                                                                   (_loc,
                                                                    p, w,
                                                                    e))
                                                                 ), acc))
                                                           | None ->
                                                              (Ast.McOr
                                                                (_loc, (
                                                                 (Ast.McArr
                                                                   (_loc,
                                                                    p, (
                                                                    (
                                                                    Ast.ExNil
                                                                    (_loc))
                                                                    ), e))
                                                                 ), acc)))
                                                        ) tspel (
                                                        (Ast.McNil (_loc))
                                                        )) in
                                                     (Ast.ExMat
                                                       (_loc, (
                                                        (Ast.ExApp
                                                          (_loc, (
                                                           (peek_fun
                                                             _loc) ), (
                                                           (Ast.ExId
                                                             (_loc, (
                                                              (Ast.IdLid
                                                                (_loc,
                                                                 strm_n))
                                                              ))) ))) ),
                                                        (
                                                        (Ast.McOr
                                                          (_loc, pel, (
                                                           (Ast.McArr
                                                             (_loc, (
                                                              (Ast.PaAny
                                                                (_loc))
                                                              ), (
                                                              (Ast.ExNil
                                                                (_loc))
                                                              ), (
                                                              (ekont () )
                                                              ))) ))) )))

                                                 let rec group_terms =
                                                  function
                                                  | ((((SpTrm
                                                         (_loc, p, w),
                                                        None) :: spcl),
                                                      epo, e) :: spel) ->
                                                     let (tspel, spel) =
                                                      (group_terms spel) in
                                                     ((
                                                      (
                                                       (p, w, _loc, spcl,
                                                        epo, e) ) ::
                                                       tspel  ), spel)
                                                  | spel -> ([] , spel)

                                                 let rec parser_cases =
                                                  fun _loc ->
                                                   function
                                                   | [] ->
                                                      (Ast.ExApp
                                                        (_loc, (
                                                         (Ast.ExId
                                                           (_loc, (
                                                            (Ast.IdLid
                                                              (_loc,
                                                               "raise"))
                                                            ))) ), (
                                                         (Ast.ExId
                                                           (_loc, (
                                                            (Ast.IdAcc
                                                              (_loc, (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "Stream"))
                                                               ), (
                                                               (Ast.IdUid
                                                                 (_loc,
                                                                  "Failure"))
                                                               ))) ))) )))
                                                   | spel ->
                                                      (match
                                                         (group_terms
                                                           spel) with
                                                       | ([],
                                                          ((spcl, epo, e)
                                                           :: spel)) ->
                                                          (stream_pattern
                                                            _loc epo e (
                                                            fun _ ->
                                                             (parser_cases
                                                               _loc spel)
                                                            ) spcl)
                                                       | (tspel, spel) ->
                                                          (stream_patterns_term
                                                            _loc (
                                                            fun _ ->
                                                             (parser_cases
                                                               _loc spel)
                                                            ) tspel))

                                                 let cparser =
                                                  fun _loc ->
                                                   fun bpo ->
                                                    fun pc ->
                                                     let e =
                                                      (parser_cases _loc
                                                        pc) in
                                                     let e =
                                                      (match bpo with
                                                       | Some (bp) ->
                                                          (Ast.ExLet
                                                            (_loc,
                                                             Ast.ReNil ,
                                                             (
                                                             (Ast.BiEq
                                                               (_loc, bp,
                                                                (
                                                                (Ast.ExApp
                                                                  (_loc,
                                                                   (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "count"))
                                                                    )))
                                                                    )))
                                                                   ), (
                                                                   (Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                   ))) )))
                                                             ), e))
                                                       | None -> e) in
                                                     let p =
                                                      (Ast.PaTyc
                                                        (_loc, (
                                                         (Ast.PaId
                                                           (_loc, (
                                                            (Ast.IdLid
                                                              (_loc,
                                                               strm_n))
                                                            ))) ), (
                                                         (Ast.TyApp
                                                           (_loc, (
                                                            (Ast.TyId
                                                              (_loc, (
                                                               (Ast.IdAcc
                                                                 (_loc, (
                                                                  (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                  ), (
                                                                  (Ast.IdLid
                                                                    (_loc,
                                                                    "t"))
                                                                  ))) )))
                                                            ), (
                                                            (Ast.TyAny
                                                              (_loc)) )))
                                                         ))) in
                                                     (Ast.ExFun
                                                       (_loc, (
                                                        (Ast.McArr
                                                          (_loc, p, (
                                                           (Ast.ExNil
                                                             (_loc)) ),
                                                           e)) )))

                                                 let cparser_match =
                                                  fun _loc ->
                                                   fun me ->
                                                    fun bpo ->
                                                     fun pc ->
                                                      let pc =
                                                       (parser_cases _loc
                                                         pc) in
                                                      let e =
                                                       (match bpo with
                                                        | Some (bp) ->
                                                           (Ast.ExLet
                                                             (_loc,
                                                              Ast.ReNil ,
                                                              (
                                                              (Ast.BiEq
                                                                (_loc,
                                                                 bp, (
                                                                 (Ast.ExApp
                                                                   (_loc,
                                                                    (
                                                                    (
                                                                    Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "count"))
                                                                    )))
                                                                    )))
                                                                    ), (
                                                                    (
                                                                    Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                    )))
                                                                 ))) ),
                                                              pc))
                                                        | None -> pc) in
                                                      let me =
                                                       (match me with
                                                        | (Ast.ExSem
                                                            (_loc, _, _) as
                                                           e) ->
                                                           (Ast.ExSeq
                                                             (_loc, e))
                                                        | e -> e) in
                                                      (match me with
                                                       | Ast.ExId
                                                          (_,
                                                           Ast.IdLid
                                                            (_, x)) when
                                                          (x = strm_n) ->
                                                          e
                                                       | _ ->
                                                          (Ast.ExLet
                                                            (_loc,
                                                             Ast.ReNil ,
                                                             (
                                                             (Ast.BiEq
                                                               (_loc, (
                                                                (Ast.PaTyc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    strm_n))
                                                                    )))
                                                                   ), (
                                                                   (Ast.TyApp
                                                                    (_loc,
                                                                    (
                                                                    (Ast.TyId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "t"))
                                                                    )))
                                                                    )))
                                                                    ), (
                                                                    (Ast.TyAny
                                                                    (_loc))
                                                                    )))
                                                                   ))) ),
                                                                me)) ),
                                                             e)))

                                                 let rec not_computing =
                                                  function
                                                  | (((((Ast.ExId
                                                          (_,
                                                           Ast.IdLid
                                                            (_, _))
                                                         | Ast.ExId
                                                            (_,
                                                             Ast.IdUid
                                                              (_, _)))
                                                        | Ast.ExInt
                                                           (_, _))
                                                       | Ast.ExFlo (_, _))
                                                      | Ast.ExChr (_, _))
                                                     | Ast.ExStr (_, _)) ->
                                                     (true)
                                                  | Ast.ExApp (_, x, y) ->
                                                     ((
                                                       (is_cons_apply_not_computing
                                                         x) ) && (
                                                       (not_computing y)
                                                       ))
                                                  | _ -> (false)
                                                 and is_cons_apply_not_computing =
                                                  function
                                                  | Ast.ExId
                                                     (_, Ast.IdUid (_, _)) ->
                                                     (true)
                                                  | Ast.ExId
                                                     (_, Ast.IdLid (_, _)) ->
                                                     (false)
                                                  | Ast.ExApp (_, x, y) ->
                                                     ((
                                                       (is_cons_apply_not_computing
                                                         x) ) && (
                                                       (not_computing y)
                                                       ))
                                                  | _ -> (false)

                                                 let slazy =
                                                  fun _loc ->
                                                   fun e ->
                                                    (match e with
                                                     | Ast.ExApp
                                                        (_, f,
                                                         Ast.ExId
                                                          (_,
                                                           Ast.IdUid
                                                            (_, "()"))) ->
                                                        (match f with
                                                         | Ast.ExId
                                                            (_,
                                                             Ast.IdLid
                                                              (_, _)) ->
                                                            f
                                                         | _ ->
                                                            (Ast.ExFun
                                                              (_loc, (
                                                               (Ast.McArr
                                                                 (_loc, (
                                                                  (Ast.PaAny
                                                                    (_loc))
                                                                  ), (
                                                                  (Ast.ExNil
                                                                    (_loc))
                                                                  ), e))
                                                               ))))
                                                     | _ ->
                                                        (Ast.ExFun
                                                          (_loc, (
                                                           (Ast.McArr
                                                             (_loc, (
                                                              (Ast.PaAny
                                                                (_loc))
                                                              ), (
                                                              (Ast.ExNil
                                                                (_loc))
                                                              ), e)) ))))

                                                 let rec cstream =
                                                  fun gloc ->
                                                   function
                                                   | [] ->
                                                      let _loc = gloc in
                                                      (Ast.ExId
                                                        (_loc, (
                                                         (Ast.IdAcc
                                                           (_loc, (
                                                            (Ast.IdUid
                                                              (_loc,
                                                               "Stream"))
                                                            ), (
                                                            (Ast.IdLid
                                                              (_loc,
                                                               "sempty"))
                                                            ))) )))
                                                   | (SeTrm (_loc, e) ::
                                                      []) ->
                                                      if (not_computing
                                                           e) then
                                                       (
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExId
                                                            (_loc, (
                                                             (Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   "Stream"))
                                                                ), (
                                                                (Ast.IdLid
                                                                  (_loc,
                                                                   "ising"))
                                                                ))) )))
                                                          ), e))
                                                       )
                                                      else
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExId
                                                            (_loc, (
                                                             (Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   "Stream"))
                                                                ), (
                                                                (Ast.IdLid
                                                                  (_loc,
                                                                   "lsing"))
                                                                ))) )))
                                                          ), (
                                                          (slazy _loc e)
                                                          )))
                                                   | (SeTrm (_loc, e) ::
                                                      secl) ->
                                                      if (not_computing
                                                           e) then
                                                       (
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExApp
                                                            (_loc, (
                                                             (Ast.ExId
                                                               (_loc, (
                                                                (Ast.IdAcc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                   ), (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    "icons"))
                                                                   ))) )))
                                                             ), e)) ), (
                                                          (cstream gloc
                                                            secl) )))
                                                       )
                                                      else
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExApp
                                                            (_loc, (
                                                             (Ast.ExId
                                                               (_loc, (
                                                                (Ast.IdAcc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                   ), (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    "lcons"))
                                                                   ))) )))
                                                             ), (
                                                             (slazy _loc
                                                               e) ))) ),
                                                          (
                                                          (cstream gloc
                                                            secl) )))
                                                   | (SeNtr (_loc, e) ::
                                                      []) ->
                                                      if (not_computing
                                                           e) then
                                                       e
                                                      else
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExId
                                                            (_loc, (
                                                             (Ast.IdAcc
                                                               (_loc, (
                                                                (Ast.IdUid
                                                                  (_loc,
                                                                   "Stream"))
                                                                ), (
                                                                (Ast.IdLid
                                                                  (_loc,
                                                                   "slazy"))
                                                                ))) )))
                                                          ), (
                                                          (slazy _loc e)
                                                          )))
                                                   | (SeNtr (_loc, e) ::
                                                      secl) ->
                                                      if (not_computing
                                                           e) then
                                                       (
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExApp
                                                            (_loc, (
                                                             (Ast.ExId
                                                               (_loc, (
                                                                (Ast.IdAcc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                   ), (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    "iapp"))
                                                                   ))) )))
                                                             ), e)) ), (
                                                          (cstream gloc
                                                            secl) )))
                                                       )
                                                      else
                                                       (Ast.ExApp
                                                         (_loc, (
                                                          (Ast.ExApp
                                                            (_loc, (
                                                             (Ast.ExId
                                                               (_loc, (
                                                                (Ast.IdAcc
                                                                  (_loc,
                                                                   (
                                                                   (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                   ), (
                                                                   (Ast.IdLid
                                                                    (_loc,
                                                                    "lapp"))
                                                                   ))) )))
                                                             ), (
                                                             (slazy _loc
                                                               e) ))) ),
                                                          (
                                                          (cstream gloc
                                                            secl) )))

                                                 let _ = let _ =
                                                          (expr :
                                                            'expr Gram.t)
                                                         and _ =
                                                          (parser_case_list :
                                                            'parser_case_list Gram.t)
                                                         and _ =
                                                          (parser_case :
                                                            'parser_case Gram.t)
                                                         and _ =
                                                          (stream_quot :
                                                            'stream_quot Gram.t)
                                                         and _ =
                                                          (stream_end :
                                                            'stream_end Gram.t)
                                                         and _ =
                                                          (stream_begin :
                                                            'stream_begin Gram.t)
                                                         and _ =
                                                          (stream_expr :
                                                            'stream_expr Gram.t) in
                                                         let grammar_entry_create =
                                                          Gram.mk in
                                                         let parser_ipatt =
                                                          ((grammar_entry_create
                                                             "parser_ipatt") :
                                                            'parser_ipatt Gram.t)
                                                         and stream_expr_comp =
                                                          ((grammar_entry_create
                                                             "stream_expr_comp") :
                                                            'stream_expr_comp Gram.t)
                                                         and stream_expr_comp_list =
                                                          ((grammar_entry_create
                                                             "stream_expr_comp_list") :
                                                            'stream_expr_comp_list Gram.t)
                                                         and stream_patt_comp_err_list =
                                                          ((grammar_entry_create
                                                             "stream_patt_comp_err_list") :
                                                            'stream_patt_comp_err_list Gram.t)
                                                         and stream_patt_comp_err =
                                                          ((grammar_entry_create
                                                             "stream_patt_comp_err") :
                                                            'stream_patt_comp_err Gram.t)
                                                         and stream_patt_comp =
                                                          ((grammar_entry_create
                                                             "stream_patt_comp") :
                                                            'stream_patt_comp Gram.t)
                                                         and stream_patt =
                                                          ((grammar_entry_create
                                                             "stream_patt") :
                                                            'stream_patt Gram.t) in
                                                         (
                                                         (Gram.extend (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              ((
                                                               (Some
                                                                 (`Level
                                                                   "top"))
                                                               ), (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("match"))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (sequence :
                                                                    'sequence Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("with"))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("parser"))
                                                                    ); (
                                                                    (
                                                                    Gram.Sopt
                                                                    ((
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_ipatt :
                                                                    'parser_ipatt Gram.t)
                                                                    )))))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_case_list :
                                                                    'parser_case_list Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (pcl :
                                                                    'parser_case_list) ->
                                                                    fun (po :
                                                                    'parser_ipatt option) ->
                                                                    fun _ ->
                                                                    fun _ ->
                                                                    fun (e :
                                                                    'sequence) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((cparser_match
                                                                    _loc
                                                                    e po
                                                                    pcl) :
                                                                    'expr)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("parser"))
                                                                    ); (
                                                                    (
                                                                    Gram.Sopt
                                                                    ((
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_ipatt :
                                                                    'parser_ipatt Gram.t)
                                                                    )))))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_case_list :
                                                                    'parser_case_list Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (pcl :
                                                                    'parser_case_list) ->
                                                                    fun (po :
                                                                    'parser_ipatt option) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((cparser
                                                                    _loc
                                                                    po
                                                                    pcl) :
                                                                    'expr)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (parser_ipatt :
                                                             'parser_ipatt Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("_"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.PaAny
                                                                    (_loc)) :
                                                                    'parser_ipatt)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (a_LIDENT :
                                                                    'a_LIDENT Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (i :
                                                                    'a_LIDENT) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    i))
                                                                    ))) :
                                                                    'parser_ipatt)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (parser_case_list :
                                                             'parser_case_list Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_case :
                                                                    'parser_case Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (pc :
                                                                    'parser_case) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ([pc] :
                                                                    'parser_case_list)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("["))
                                                                    ); (
                                                                    (
                                                                    Gram.Slist0sep
                                                                    ((
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_case :
                                                                    'parser_case Gram.t)
                                                                    )))
                                                                    ), (
                                                                    (Gram.Skeyword
                                                                    ("|"))
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("]"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (pcl :
                                                                    'parser_case list) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (pcl :
                                                                    'parser_case_list)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (parser_case :
                                                             'parser_case Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_begin :
                                                                    'stream_begin Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt :
                                                                    'stream_patt Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_end :
                                                                    'stream_end Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Sopt
                                                                    ((
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (parser_ipatt :
                                                                    'parser_ipatt Gram.t)
                                                                    )))))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("->"))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'expr) ->
                                                                    fun _ ->
                                                                    fun (po :
                                                                    'parser_ipatt option) ->
                                                                    fun _ ->
                                                                    fun (sp :
                                                                    'stream_patt) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((sp,
                                                                    po,
                                                                    e) :
                                                                    'parser_case)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_begin :
                                                             'stream_begin Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("[<"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (() :
                                                                    'stream_begin)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_end :
                                                             'stream_end Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    (">]"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (() :
                                                                    'stream_end)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_quot :
                                                             'stream_quot Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("'"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (() :
                                                                    'stream_quot)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_expr :
                                                             'stream_expr Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (expr :
                                                                    'expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'expr) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'stream_expr)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_patt :
                                                             'stream_patt Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [([] , (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (([]) :
                                                                    'stream_patt)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp :
                                                                    'stream_patt_comp Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    (";"))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp_err_list :
                                                                    'stream_patt_comp_err_list Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (sp :
                                                                    'stream_patt_comp_err_list) ->
                                                                    fun _ ->
                                                                    fun (spc :
                                                                    'stream_patt_comp) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((
                                                                    (spc,
                                                                    None
                                                                    ) ) ::
                                                                    sp  :
                                                                    'stream_patt)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp :
                                                                    'stream_patt_comp Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (spc :
                                                                    'stream_patt_comp) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ([(spc,
                                                                    None
                                                                    )] :
                                                                    'stream_patt)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_patt_comp :
                                                             'stream_patt_comp Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_quot :
                                                                    'stream_quot Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (patt :
                                                                    'patt Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (p :
                                                                    'patt) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((SpStr
                                                                    (_loc,
                                                                    p)) :
                                                                    'stream_patt_comp)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (patt :
                                                                    'patt Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    ("="))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr :
                                                                    'stream_expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'stream_expr) ->
                                                                    fun _ ->
                                                                    fun (p :
                                                                    'patt) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((SpNtr
                                                                    (_loc,
                                                                    p, e)) :
                                                                    'stream_patt_comp)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (patt :
                                                                    'patt Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Sopt
                                                                    (Gram.srules
                                                                    stream_patt_comp
                                                                    (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("when"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr :
                                                                    'stream_expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'stream_expr) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'e__27)
                                                                    )) ))]
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (eo :
                                                                    'e__27 option) ->
                                                                    fun (p :
                                                                    'patt) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((SpTrm
                                                                    (_loc,
                                                                    p,
                                                                    eo)) :
                                                                    'stream_patt_comp)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_patt_comp_err :
                                                             'stream_patt_comp_err Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp :
                                                                    'stream_patt_comp Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Sopt
                                                                    (Gram.srules
                                                                    stream_patt_comp_err
                                                                    (
                                                                    [((
                                                                    [(
                                                                    (Gram.Skeyword
                                                                    ("??"))
                                                                    ); (
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr :
                                                                    'stream_expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'stream_expr) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (e :
                                                                    'e__28)
                                                                    )) ))]
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (eo :
                                                                    'e__28 option) ->
                                                                    fun (spc :
                                                                    'stream_patt_comp) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((spc,
                                                                    eo) :
                                                                    'stream_patt_comp_err)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_patt_comp_err_list :
                                                             'stream_patt_comp_err_list Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp_err :
                                                                    'stream_patt_comp_err Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    (";"))
                                                                    );
                                                                    Gram.Sself
                                                                    ] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (sp :
                                                                    'stream_patt_comp_err_list) ->
                                                                    fun _ ->
                                                                    fun (spc :
                                                                    'stream_patt_comp_err) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((
                                                                    spc ) ::
                                                                    sp  :
                                                                    'stream_patt_comp_err_list)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp_err :
                                                                    'stream_patt_comp_err Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    (";"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (spc :
                                                                    'stream_patt_comp_err) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ([spc] :
                                                                    'stream_patt_comp_err_list)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_patt_comp_err :
                                                                    'stream_patt_comp_err Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (spc :
                                                                    'stream_patt_comp_err) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ([spc] :
                                                                    'stream_patt_comp_err_list)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (expr :
                                                             'expr Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              ((
                                                               (Some
                                                                 (`Level
                                                                   "simple"))
                                                               ), (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_begin :
                                                                    'stream_begin Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr_comp_list :
                                                                    'stream_expr_comp_list Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_end :
                                                                    'stream_end Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (sel :
                                                                    'stream_expr_comp_list) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((cstream
                                                                    _loc
                                                                    sel) :
                                                                    'expr)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_begin :
                                                                    'stream_begin Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_end :
                                                                    'stream_end Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((Ast.ExId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Stream"))
                                                                    ), (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    "sempty"))
                                                                    )))
                                                                    ))) :
                                                                    'expr)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (
                                                         (Gram.extend (
                                                           (stream_expr_comp_list :
                                                             'stream_expr_comp_list Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr_comp :
                                                                    'stream_expr_comp Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (se :
                                                                    'stream_expr_comp) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ([se] :
                                                                    'stream_expr_comp_list)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr_comp :
                                                                    'stream_expr_comp Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    (";"))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun _ ->
                                                                    fun (se :
                                                                    'stream_expr_comp) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ([se] :
                                                                    'stream_expr_comp_list)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr_comp :
                                                                    'stream_expr_comp Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Skeyword
                                                                    (";"))
                                                                    );
                                                                    Gram.Sself
                                                                    ] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (sel :
                                                                    'stream_expr_comp_list) ->
                                                                    fun _ ->
                                                                    fun (se :
                                                                    'stream_expr_comp) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((
                                                                    se ) ::
                                                                    sel  :
                                                                    'stream_expr_comp_list)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))
                                                         );
                                                         (Gram.extend (
                                                           (stream_expr_comp :
                                                             'stream_expr_comp Gram.t)
                                                           ) (
                                                           ((fun ()
                                                               ->
                                                              (None , (
                                                               [(None ,
                                                                 None , (
                                                                 [((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_quot :
                                                                    'stream_quot Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr :
                                                                    'stream_expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'stream_expr) ->
                                                                    fun _ ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((SeNtr
                                                                    (_loc,
                                                                    e)) :
                                                                    'stream_expr_comp)
                                                                    )) ));
                                                                  ((
                                                                   [(
                                                                    (
                                                                    Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (stream_expr :
                                                                    'stream_expr Gram.t)
                                                                    )))
                                                                    )] ),
                                                                   (
                                                                   (Gram.mk_action
                                                                    (
                                                                    fun (e :
                                                                    'stream_expr) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    ((SeTrm
                                                                    (_loc,
                                                                    e)) :
                                                                    'stream_expr_comp)
                                                                    )) ))]
                                                                 ))] )))
                                                             () ) ))

                                                end

module IdQuotationCommon =
                                                      struct
                                                       let name =
                                                        "Camlp4QuotationCommon"

                                                       let version =
                                                        Sys.ocaml_version

                                                      end

module MakeQuotationCommon =
                                                            functor (Syntax : Sig.Camlp4Syntax) ->
                                                             functor (TheAntiquotSyntax : Sig.ParserExpr) ->
                                                              struct
                                                               open FanSig

                                                               include Syntax

                                                               module Ast =
                                                                Camlp4Ast

                                                               module MetaAst =
                                                                (Ast.Meta.Make)
                                                                 (Lib.Meta.MetaLocQuotation)

                                                               module ME =
                                                                MetaAst.Expr

                                                               module MP =
                                                                MetaAst.Patt

                                                               let anti_obj =
                                                                (Expr.antiquot_expander
                                                                  ~parse_expr:TheAntiquotSyntax.parse_expr
                                                                  ~parse_patt:TheAntiquotSyntax.parse_patt)

                                                               let add_quotation =
                                                                fun name ->
                                                                 fun entry ->
                                                                  fun mexpr ->
                                                                   fun mpatt ->
                                                                    let entry_eoi =
                                                                    (Gram.mk
                                                                    (
                                                                    (Gram.name
                                                                    entry)
                                                                    )) in
                                                                    let parse_quot_string =
                                                                    fun entry ->
                                                                    fun loc ->
                                                                    fun s ->
                                                                    let q =
                                                                    FanConfig.antiquotations.contents in
                                                                    let 
                                                                    () =
                                                                    (FanConfig.antiquotations
                                                                    :=
                                                                    true
                                                                    ) in
                                                                    let res =
                                                                    (Gram.parse_string
                                                                    entry
                                                                    loc
                                                                    s) in
                                                                    let 
                                                                    () =
                                                                    (FanConfig.antiquotations
                                                                    := q) in
                                                                    res in
                                                                    let expand_expr =
                                                                    fun loc ->
                                                                    fun loc_name_opt ->
                                                                    fun s ->
                                                                    let ast =
                                                                    (parse_quot_string
                                                                    entry_eoi
                                                                    loc
                                                                    s) in
                                                                    let 
                                                                    () =
                                                                    (Lib.Meta.MetaLocQuotation.loc_name
                                                                    :=
                                                                    loc_name_opt) in
                                                                    let meta_ast =
                                                                    (mexpr
                                                                    loc
                                                                    ast) in
                                                                    let exp_ast =
                                                                    (anti_obj#expr
                                                                    meta_ast) in
                                                                    exp_ast in
                                                                    let expand_str_item =
                                                                    fun loc ->
                                                                    fun loc_name_opt ->
                                                                    fun s ->
                                                                    let exp_ast =
                                                                    (expand_expr
                                                                    loc
                                                                    loc_name_opt
                                                                    s) in
                                                                    (
                                                                    Ast.StExp
                                                                    (loc,
                                                                    exp_ast)) in
                                                                    let expand_patt =
                                                                    fun _loc ->
                                                                    fun loc_name_opt ->
                                                                    fun s ->
                                                                    let ast =
                                                                    (parse_quot_string
                                                                    entry_eoi
                                                                    _loc
                                                                    s) in
                                                                    let meta_ast =
                                                                    (mpatt
                                                                    _loc
                                                                    ast) in
                                                                    let exp_ast =
                                                                    (anti_obj#patt
                                                                    meta_ast) in
                                                                    (
                                                                    match
                                                                    loc_name_opt with
                                                                    | None ->
                                                                    exp_ast
                                                                    | 
                                                                    Some
                                                                    (name) ->
                                                                    let rec subst_first_loc =
                                                                    function
                                                                    | Ast.PaApp
                                                                    (_loc,
                                                                    Ast.PaId
                                                                    (_,
                                                                    Ast.IdAcc
                                                                    (_,
                                                                    Ast.IdUid
                                                                    (_,
                                                                    "Ast"),
                                                                    Ast.IdUid
                                                                    (_, u))),
                                                                    _) ->
                                                                    (
                                                                    Ast.PaApp
                                                                    (_loc,
                                                                    (
                                                                    (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdAcc
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    "Ast"))
                                                                    ), (
                                                                    (Ast.IdUid
                                                                    (_loc,
                                                                    u))
                                                                    )))
                                                                    )))
                                                                    ), (
                                                                    (Ast.PaId
                                                                    (_loc,
                                                                    (
                                                                    (Ast.IdLid
                                                                    (_loc,
                                                                    name))
                                                                    )))
                                                                    )))
                                                                    | Ast.PaApp
                                                                    (_loc,
                                                                    a, b) ->
                                                                    (
                                                                    Ast.PaApp
                                                                    (_loc,
                                                                    (
                                                                    (subst_first_loc
                                                                    a) ),
                                                                    b))
                                                                    | 
                                                                    p ->
                                                                    p in
                                                                    (subst_first_loc
                                                                    exp_ast)) in
                                                                    (
                                                                    (Gram.extend
                                                                    (
                                                                    (entry_eoi :
                                                                    'entry_eoi Gram.t)
                                                                    ) (
                                                                    ((fun ()
                                                                     ->
                                                                    (None
                                                                    , (
                                                                    [(None
                                                                    ,
                                                                    None
                                                                    , (
                                                                    [((
                                                                    [(
                                                                    (Gram.Snterm
                                                                    (Gram.obj
                                                                    (
                                                                    (entry :
                                                                    'entry Gram.t)
                                                                    )))
                                                                    ); (
                                                                    (Gram.Stoken
                                                                    ((
                                                                    function
                                                                    | EOI ->
                                                                    (
                                                                    true)
                                                                    | 
                                                                    _ ->
                                                                    (
                                                                    false)
                                                                    ),
                                                                    "EOI"))
                                                                    )] ),
                                                                    (
                                                                    (Gram.mk_action
                                                                    (
                                                                    fun (__camlp4_0 :
                                                                    Gram.token) ->
                                                                    fun (x :
                                                                    'entry) ->
                                                                    fun (_loc :
                                                                    FanLoc.t) ->
                                                                    (
                                                                    match
                                                                    __camlp4_0 with
                                                                    | EOI ->
                                                                    (x :
                                                                    'entry_eoi)
                                                                    | 
                                                                    _ ->
                                                                    assert false)
                                                                    )) ))]
                                                                    ))]
                                                                    )))
                                                                    () )
                                                                    ))
                                                                    );
                                                                    (
                                                                    (Quotation.add
                                                                    name
                                                                    DynAst.expr_tag
                                                                    expand_expr)
                                                                    );
                                                                    (
                                                                    (Quotation.add
                                                                    name
                                                                    DynAst.patt_tag
                                                                    expand_patt)
                                                                    );
                                                                    (Quotation.add
                                                                    name
                                                                    DynAst.str_item_tag
                                                                    expand_str_item)

                                                               let _ = 
                                                               (add_quotation
                                                                 "sig_item"
                                                                 sig_item_quot
                                                                 ME.meta_sig_item
                                                                 MP.meta_sig_item)

                                                               let _ = 
                                                               (add_quotation
                                                                 "str_item"
                                                                 str_item_quot
                                                                 ME.meta_str_item
                                                                 MP.meta_str_item)

                                                               let _ = 
                                                               (add_quotation
                                                                 "ctyp"
                                                                 ctyp_quot
                                                                 ME.meta_ctyp
                                                                 MP.meta_ctyp)

                                                               let _ = 
                                                               (add_quotation
                                                                 "patt"
                                                                 patt_quot
                                                                 ME.meta_patt
                                                                 MP.meta_patt)

                                                               let _ = 
                                                               (add_quotation
                                                                 "expr"
                                                                 expr_quot
                                                                 ME.meta_expr
                                                                 MP.meta_expr)

                                                               let _ = 
                                                               (add_quotation
                                                                 "module_type"
                                                                 module_type_quot
                                                                 ME.meta_module_type
                                                                 MP.meta_module_type)

                                                               let _ = 
                                                               (add_quotation
                                                                 "module_expr"
                                                                 module_expr_quot
                                                                 ME.meta_module_expr
                                                                 MP.meta_module_expr)

                                                               let _ = 
                                                               (add_quotation
                                                                 "class_type"
                                                                 class_type_quot
                                                                 ME.meta_class_type
                                                                 MP.meta_class_type)

                                                               let _ = 
                                                               (add_quotation
                                                                 "class_expr"
                                                                 class_expr_quot
                                                                 ME.meta_class_expr
                                                                 MP.meta_class_expr)

                                                               let _ = 
                                                               (add_quotation
                                                                 "class_sig_item"
                                                                 class_sig_item_quot
                                                                 ME.meta_class_sig_item
                                                                 MP.meta_class_sig_item)

                                                               let _ = 
                                                               (add_quotation
                                                                 "class_str_item"
                                                                 class_str_item_quot
                                                                 ME.meta_class_str_item
                                                                 MP.meta_class_str_item)

                                                               let _ = 
                                                               (add_quotation
                                                                 "with_constr"
                                                                 with_constr_quot
                                                                 ME.meta_with_constr
                                                                 MP.meta_with_constr)

                                                               let _ = 
                                                               (add_quotation
                                                                 "binding"
                                                                 binding_quot
                                                                 ME.meta_binding
                                                                 MP.meta_binding)

                                                               let _ = 
                                                               (add_quotation
                                                                 "rec_binding"
                                                                 rec_binding_quot
                                                                 ME.meta_rec_binding
                                                                 MP.meta_rec_binding)

                                                               let _ = 
                                                               (add_quotation
                                                                 "match_case"
                                                                 match_case_quot
                                                                 ME.meta_match_case
                                                                 MP.meta_match_case)

                                                               let _ = 
                                                               (add_quotation
                                                                 "module_binding"
                                                                 module_binding_quot
                                                                 ME.meta_module_binding
                                                                 MP.meta_module_binding)

                                                               let _ = 
                                                               (add_quotation
                                                                 "ident"
                                                                 ident_quot
                                                                 ME.meta_ident
                                                                 MP.meta_ident)

                                                               let _ = 
                                                               (add_quotation
                                                                 "rec_flag"
                                                                 rec_flag_quot
                                                                 ME.meta_rec_flag
                                                                 MP.meta_rec_flag)

                                                               let _ = 
                                                               (add_quotation
                                                                 "private_flag"
                                                                 private_flag_quot
                                                                 ME.meta_private_flag
                                                                 MP.meta_private_flag)

                                                               let _ = 
                                                               (add_quotation
                                                                 "row_var_flag"
                                                                 row_var_flag_quot
                                                                 ME.meta_row_var_flag
                                                                 MP.meta_row_var_flag)

                                                               let _ = 
                                                               (add_quotation
                                                                 "mutable_flag"
                                                                 mutable_flag_quot
                                                                 ME.meta_mutable_flag
                                                                 MP.meta_mutable_flag)

                                                               let _ = 
                                                               (add_quotation
                                                                 "virtual_flag"
                                                                 virtual_flag_quot
                                                                 ME.meta_virtual_flag
                                                                 MP.meta_virtual_flag)

                                                               let _ = 
                                                               (add_quotation
                                                                 "override_flag"
                                                                 override_flag_quot
                                                                 ME.meta_override_flag
                                                                 MP.meta_override_flag)

                                                               let _ = 
                                                               (add_quotation
                                                                 "direction_flag"
                                                                 direction_flag_quot
                                                                 ME.meta_direction_flag
                                                                 MP.meta_direction_flag)

                                                              end

module IdQuotationExpander =
                                                                    struct
                                                                    let name =
                                                                    "Camlp4QuotationExpander"

                                                                    let version =
                                                                    Sys.ocaml_version

                                                                    end


module MakeQuotationExpander =
 functor (Syntax : Sig.Camlp4Syntax) ->
  struct
   module M = ((MakeQuotationCommon)(Syntax))(Syntax.AntiquotSyntax)

   include M

  end

let pa_r =
        fun ((module
         P)
          :
          (module Sig.PRECAST
         )) ->
         (P.syntax_extension (module IdRevisedParser) (module
           MakeRevisedParser))

let pa_rp =
                                 fun ((module
                                  P)
                                   :
                                   (module Sig.PRECAST
                                  )) ->
                                  (P.syntax_extension (module
                                    IdRevisedParserParser) (module
                                    MakeRevisedParserParser))

let pa_g =
                                                                fun ((module
                                                                 P)
                                                                  :
                                                                  (module Sig.PRECAST
                                                                 )) ->
                                                                 (P.syntax_extension
                                                                   (module
                                                                   IdGrammarParser)
                                                                   (module
                                                                   MakeGrammarParser))


let pa_m =
 fun ((module
  P)
   :
   (module Sig.PRECAST
  )) ->
  let () =
   (P.syntax_extension (module IdMacroParser) (module MakeMacroParser)) in
  (P.syntax_plugin (module IdMacroParser) (module MakeNothing))

let pa_q =
                                                                  fun ((module
                                                                   P)
                                                                    :
                                                                    (module Sig.PRECAST
                                                                   )) ->
                                                                   (P.syntax_extension
                                                                    (module
                                                                    IdQuotationExpander)
                                                                    (module
                                                                    MakeQuotationExpander))


let pa_rq =
 fun ((module
  P)
   :
   (module Sig.PRECAST
  )) ->
  let module Gram = (Grammar.Static.Make)(P.Lexer) in
  let module M1 = (OCamlInitSyntax.Make)(P.Gram) in
  let module M2 = (MakeRevisedParser)(M1) in
  let module M3 = ((MakeQuotationCommon)(M2))(P.Syntax.AntiquotSyntax) in
  ()

let pa_l =
       fun ((module
        P)
         :
         (module Sig.PRECAST
        )) ->
        (P.syntax_extension (module IdListComprehension) (module
          MakeListComprehension))

let pa_debug =
                                    fun ((module
                                     P)
                                      :
                                      (module Sig.PRECAST
                                     )) ->
                                     (P.syntax_extension (module
                                       IdDebugParser) (module
                                       MakeDebugParser))
