

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>+OPTIONS: toc:nil html-postamble:nil html-preamble:nil &mdash; Fan 0.2 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Fan 0.2 documentation" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Fan
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">+OPTIONS: toc:nil html-postamble:nil html-preamble:nil</a></li>
<li><a class="reference internal" href="#html-head">+HTML_HEAD:</a></li>
<li><a class="reference internal" href="#title-fan-s-syntax">+TITLE: Fan&#8217;s syntax</a></li>
<li><a class="reference internal" href="#options">+OPTIONS: ^:</a></li>
<li><a class="reference internal" href="#options-toc-nil">+OPTIONS: toc:nil</a></li>
</ul>
</div>
          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Fan</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>+OPTIONS: toc:nil html-postamble:nil html-preamble:nil</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/syntax.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="options-toc-nil-html-postamble-nil-html-preamble-nil">
<h1>+OPTIONS: toc:nil html-postamble:nil html-preamble:nil<a class="headerlink" href="#options-toc-nil-html-postamble-nil-html-preamble-nil" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="html-head">
<h1>+HTML_HEAD:<a class="headerlink" href="#html-head" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="title-fan-s-syntax">
<h1>+TITLE: Fan&#8217;s syntax<a class="headerlink" href="#title-fan-s-syntax" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="options">
<h1>+OPTIONS: ^:<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="options-toc-nil">
<h1>+OPTIONS: toc:nil<a class="headerlink" href="#options-toc-nil" title="Permalink to this headline">¶</a></h1>
<p>Fan speaks OCaml natively, plus a few addons.</p>
<p>There are some minor differences between Fan&#8217;s concrete syntax and OCaml
though, the major differences is that Fan is more strict than OCaml.</p>
<ul class="simple">
<li>Difference from Caml syntax Three particular points to be noticed:</li>
</ul>
<ol class="arabic">
<li><p class="first">Parens are necessary for tuples #+BEGIN_SRC ocaml (** illegal *)
a,b let a,b = f in body #+END_SRC</p>
<p>#+BEGIN_SRC ocaml (** correct syntax *) (a,b) let (a,b) = f in
body #+END_SRC</p>
</li>
<li><p class="first">Parens or &#8220;begin&#8221; &#8220;end&#8221; necessary for semis #+BEGIN_SRC ocaml (*
illegal *) print_endline &#8220;a&#8221;; print_endline &#8220;b&#8221; #+END_SRC
#+BEGIN_SRC ocaml (** correct *) (print_endline &#8220;a&#8221;;
print_endline &#8220;b&#8221;) begin print_endline &#8220;a&#8221;; print_endline &#8220;b&#8221; end
#+END_SRC</p>
</li>
<li><p class="first">First vertical bar is necessary for algebraic data type, pattern
match. #+BEGIN_SRC ocaml (** illegal *) type u = A | B let f =
function A -&gt; &#8220;a&#8221; | B -&gt; &#8220;b&#8221; let f = match c with A -&gt; &#8220;a&#8221; | B -&gt;
&#8220;b&#8221; #+END_SRC</p>
<p>#+BEGIN_SRC ocaml (** correct *) type u = | A | B</p>
<p>let f = function | A -&gt; &#8220;a&#8221; | B -&gt; &#8220;b&#8221;</p>
<p>let f = match c with | A -&gt; &#8220;a&#8221; | B -&gt; &#8220;b&#8221;</p>
<p>#+END_SRC</p>
</li>
<li><p class="first">$ is a reserved operator, please don&#8217;t take it as a function.</p>
</li>
</ol>
<ul class="simple">
<li>Introduced syntax</li>
</ul>
<p>It mainly introduce two syntaxes, we call them delimited domain specific
languages(DDSL).</p>
<ol class="arabic">
<li><p class="first">compile time quotation</p>
<div class="line-block">
<div class="line">#+BEGIN_SRC ocaml #{:quot| |}</div>
<div class="line-block">
<div class="line">#+END_SRC</div>
</div>
</div>
<p>Such quotation is purely compile time control language, it&#8217;s a
general view of such directives:</p>
<p>#+BEGIN_SRC ocaml #load &#8220;xx.cmo&#8221;;; #use &#8220;xx.ml&#8221; ;; #+END_SRC</p>
<p>It can be used to interact with the Fan compiler, the user can
register different compile time quotation language to make the whole
file self-explainable, this helps simplify the build system a lot.</p>
<p>For example, there is a built-in control language</p>
<div class="line-block">
<div class="line">#+BEGIN_SRC ocaml #{:control| default &#8220;exp&#8221;; (* set the default</div>
</div>
<p>quotation <em>) require &#8220;ulex&#8221;; (</em> require the feature<em>) import
&#8220;Tutorial&#8221;; (</em> import the language namespace<em>) filter &#8220;serialize&#8221;;
(</em> apply the filter serialize to the whole file *) |}
|  #+END_SRC</p>
<p>Another language eval, could eval all legal ocaml code at
compile-time.</p>
<div class="line-block">
<div class="line">#+BEGIN_SRC ocaml #{:eval| let v = 3 let b = 3 |}</div>
<div class="line-block">
<div class="line">#+END_SRC</div>
</div>
</div>
<p>This would help test the syntax extension on-the-fly.</p>
<p><em>Note</em>: all the compile time DDSL should be put in the beginning,
this is intentional, to work better with IDE.</p>
</li>
<li><p class="first">Rewrite DDSL.</p>
<p>The syntax is the same with compile-time DDSL except without hash
sign, one sample is as follows:</p>
<p>#+BEGIN_SRC ocaml {:exp| 3 |} #+END_SRC</p>
<p>It can appear in most places (detail later)</p>
</li>
</ol>
</div>


          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Hongbo Zhang.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>